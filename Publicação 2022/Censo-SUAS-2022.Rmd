---
title: CENSO SUAS 2022
subtitle: ANÁLISE DOS COMPONENTES DA POLÍTICA NACIONAL DE ASSISTÊNCIA SOCIAL
date:
author:
  - Secretaria de Avaliação, Gestão da Informação e Cadastro Único
  - Secretaria Nacional de Assistência Social
  - Ministério do Desenvolvimento e Assistência Social, Família e Combate à Fome
documentclass: report
classoption: brazilian
header-includes:
  - \usepackage[brazil]{babel}
  - \usepackage[utf8]{inputenc}
  - \usepackage{booktabs}
  - \usepackage{graphicx}
  - \usepackage{tabulary}
  - \usepackage{hyperref}
  - \usepackage{multirow}
  - \usepackage{chngcntr}
  - \usepackage{caption}
  - \usepackage{floatrow}
  - \floatsetup[figure]{capposition=top}
  - \floatsetup[table]{capposition=top}
  - \usepackage{titling}
  - \usepackage{cleveref}
output:
  pdf_document:
    number_sections: true
    keep_tex: true
  html_document:
    number_sections: true
editor_options:
  markdown:
    wrap: none
---

```{=tex}
\addto\captionsbrazilian{\renewcommand{\figurename}{Gráfico}}
\crefname{figure}{gráfico}{gráficos}
```
<!-- \newcommand{\subtitle}[1]{% -->

<!-- \posttitle{% --> <!-- \par\end{center} -->
<!-- \begin{center}\large#1\end{center} --> <!-- \vskip0.5em}% -->
<!-- } -->

```{r setup, include=FALSE}
Sys.setlocale("LC_ALL","Portuguese_Brazil.utf8")

knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE)

gera.graficos.office = FALSE;

lista.de.pacotes = c("tinytex","tidyr", "purrr", "dplyr",
                     "lubridate","janitor","readxl","stringr",
                     "repmis",
#                     "survey","srvyr",
                     "scales",
                     "ggrepel","renv","forcats") # escreva a lista de pacotes
if(gera.graficos.office) lista.de.pacotes <- append(lista.de.pacotes, "export")

novos.pacotes <- lista.de.pacotes[!(lista.de.pacotes %in%
                                      installed.packages()[,"Package"])]

if(length(novos.pacotes) > 0) {install.packages(novos.pacotes, repos = "http://cran.us.r-project.org")}
lapply(lista.de.pacotes, require, character.only=T)
rm(lista.de.pacotes,novos.pacotes)
gc()

hook_plot_tex_footer <- function(x, options) {
  x_out <- knitr:::hook_plot_tex(x, options)
  if(!is.null(options$fig.footer)) {
    inter <- sprintf("\\floatfoot{%s}\n\\end{figure}", options$fig.footer[1])
    x_out <- gsub(x=x_out, pattern="\n\\end{figure}", replacement=inter, fixed=TRUE)
  }
  x_out
}

knitr::knit_hooks$set(plot=hook_plot_tex_footer)

```

```{=tex}
\counterwithout{figure}{chapter}
\counterwithout{table}{chapter}
\counterwithout{footnote}{chapter}
\captionsetup[figure]{labelfont=bf,textfont=bf}
\captionsetup[table]{labelfont=bf,textfont=bf}
\newcommand\fnote[1]{\captionsetup{font=small, textfont=normalfont}\caption*{#1}}
\captionsetup{justification=raggedright,singlelinecheck=false}
```
<!-- \maketitle -->

# Prefácio {.unnumbered}

A gestão de informação contribui para mostrar resultados, tornar mais transparente a evolução da política, bem como subsidiar no planejamento e aprimoramento da política pública. Eis uns dos objetivos a série histórica do Censo SUAS: uma análise dos componentes da política de Assistência social.

A publicação do Censo SUAS teve sua primeira edição em 2010. Caderno publicado nos anos subsequentes que tem como objetivo apurar e evidenciar uma série de dados e de informações sobre Gestão e financiamento, Cadastro Único, aspectos de infraestrutura, Gestçao do trabalho e educação permanente, serviços, benefícios, gestão e participação social no âmbito da assistência social. Esses dados e informações subsidiam gestores, técnicos e pesquisadores envolvidos no SUAS, a aprimorar ações, identificar êxitos e reestruturar pontos que não tenham atingido os resultados planejados.

A partir do ano de 2018 esta publicação foi interrompida. E, após 5 anos a SAGICAD retorna o caderno do Censo SUAS, na qual resgata as informações anteriores e garante continuidade as informações do SUAS. Reforça-se com isso o papel estratégico da produção de dados, monitoramento e analise de políticas, superando a perda na qualidade da informação, apagão dos dados, falta de transparência e o negacionismo.

Estes dados são coletados através do formulário do Censo do Sistema Único de Assistência Social (Censo SUAS), realizado anualmente desde 2007, coleta informações sobre serviços, programas e projetos de assistência social realizados pelas unidades públicas e pela Rede Socioassistencial Privada do SUAS.

Esta publicação apresenta os principais resultados do Censo SUAS 2022, organizados de forma a facilitar a leitura e a utilização do amplo conjunto de dados levantados. As informações estão organizadas segundo as temáticas: Gestão e Financiamento, Cadastro Único, Unidades, Serviços e Benefícios, Gestçao do Trabalho e educação Permanente, Participação Social e Indicadores de Desenvolvimento (IDs).

Esta edição teve o olhar a luz do II Plano Decenal, na qual deu continuidade a maior parte dos conteúdos históricos, com acréscimos de temas como atenção a situação de migrantes, serviço de situação de emergência e calamidade pública, regionalização, bem como oferta de serviços a exemplo do serviço de proteção social no domicílio, família acolhedora entre outros e relação do SUAS com cadastro único para programas sociais.

A consolidação das análises disponibilizadas nessa publicação reflete o esforço contínuo de aperfeiçoamento da cobertura do levantamento das informações, realizado conjuntamente pela Secretaria de Avaliação e Gestão da Informação (SAGI) e Secretaria Nacional de Assistência Social (SNAS). Esperamos que os resultados apresentados possam continuar contribuindo para subsidiar o debate qualificado e construtivo a respeito do SUAS e resulte em seu aprimoramento.

Letícia Bartholo

Secretária de Avaliação, Gestão da Informação e Cadastro Único

André Quintão

Secretária Nacional de Assistência Social

\tableofcontents

# Apresentação {.unnumbered}

## A Assistência Social no Brasil {.unnumbered}

É muito real a presença do SUAS na vida do povo brasileiro. Conquistamos um Sistema Único que tem vinculação com XX % da população inserida no Cadastro Único. A política de Assistência Social nas últimas décadas carrega uma conquistas da sociedade brasileira através de um projeto de seguranças sociais afiançadas por meio da proteção, vigilância e defesa de direitos. Parte deste projeto já foi colocado em prática, com decisões construídas junto com controle social. Hoje temos xxx ofertas de equipamentos sociais que visa potencializar a proteção social a população através dos serviços, programas, projetos e benefícios desta política. AS conquistas convivem com problemas e contradições, assim identificar e contruir alternativas para esses desafios também faz parte da contrução continua deste política pública.

O início da estruturação da Assistência Social nos moldes atuais se deu a partir da promulgação da Constituição Federal de 1988, quando a assistência social passou a ser compreendida como direito do cidadão brasileiro e, portanto, como uma política pública de responsabilidade do Estado. É uma política de Seguridade Social não contributiva, que visa, em conjunto com outras políticas setoriais, a universalização dos direitos sociais.

Atualmente as ações da Assistência Social são organizadas sob a forma do Sistema Único de Assistência Social (SUAS), que está fundado na gestão descentralizada e participativa, com gestão compartilhada, cofinanciamento e cooperação técnica entre os três entes federados. Além da União, estados e municípios, o SUAS é integrado pelos Conselhos de Assistência Social e pelas entidades e organizações de assistência social. A organização da Assistência Social está disposta na Lei Orgânica da Assistência Social (LOAS), de 7 de dezembro de 1993, em conformidade com a Política Nacional de Assistência Social (PNAS).

No SUAS estão previstos dois tipos de proteção social: a básica e a especial, para prevenção de situações de vulnerabilidade e enfrentamento de situações de violações de direitos, respectivamente. Também no âmbito do SUAS são ofertados os benefícios assistenciais. As ações são empreendidas tanto pelas unidades públicas quanto pela rede socioassistencial privada do SUAS.

Até atingir a forma atual de organização, a Assistência Social passou por mudanças significativas, consequência de inúmeros esforços que possibilitaram a ampliação de recursos, programas, benefícios e serviços voltados à população em situação de vulnerabilidade e risco social e/ou violação de direitos.

Ao longo do século XXI, ainda que tenham sido instituídos alguns programas e elaboradas leis voltadas à proteção social, o acesso a direitos sociais era baseado na capacidade contributiva do trabalhador, excluindo uma grande parcela da população, incluindo a parcela que trabalhava no mercado informal.

A partir de 1988, a Constituição Brasileira trouxe uma nova perspectiva para a proteção social, apresentando, pela primeira vez no Brasil, um modelo amplo de Seguridade Social, composto por Saúde, Previdência e Assistência Social, que prevê atendimento e cobertura universais. O modelo estipula ainda que os benefícios e serviços devem ser uniformes e equivalentes para a população rural e urbana. Prevê a integração entre governos, com participação dos três entes, e sociedade para a consecução dos objetivos estipulados.

A assistência social foi reconhecida, portanto, como um direito da pessoa que dela precisar, sem necessidade de contribuição prévia à Seguridade Social. Tem por objetivos, de acordo com a Constituição Federal, "a proteção à família, à maternidade, à infância, à adolescência e à velhice; o amparo às crianças e adolescentes carentes; a promoção da integração ao mercado de trabalho; a habilitação e reabilitação das pessoas portadoras de deficiência e a promoção de sua integração à vida comunitária; e a garantia de um salário mínimo de benefício mensal à pessoa portadora de deficiência e ao idoso que comprovem não possuir meios de prover à própria manutenção ou de tê-la provida por sua família"\footnote{BRASIL. Constituição da República Federativa do Brasil de 1988. Disponível em: \url{http://www.planalto.gov.br/ccivil_03/constituicao/constituicao.htm}. Acesso em 09/08/2018.}.

Considerando a nova configuração da Assistência Social definida pela Constituição, foi sancionada em 7 de dezembro de 1993 a Lei nº 8.742, a Lei Orgânica da Assistência Social (LOAS). A LOAS estabelece para a Assistência Social os princípios de universalização dos direitos sociais, com igualdade de direitos de acesso no atendimento e respeito à dignidade do cidadão. A lei, que dispõe sobre a nova organização da Assistência Social, trouxe inovações importantes, como a participação social por meio de instâncias de controle social e a descentralização político-administrativa com primazia da responsabilidade do Estado, nas três esferas de governo, na condução da política. As competências da União, dos estados, do Distrito Federal e dos municípios estão definidas na LOAS, bem como o cofinanciamento dos benefícios, serviços, programas e projetos da Assistência Social. Nesse sentido, mostra-se fundamental a articulação e a coordenação entre os três entes da federação, que se dá por meio das Comissões Intergestores Tripartite (CIT) e Bipartite (CIB), que são instâncias de pactuação interfederativa para a operacionalização da gestão do SUAS.

A partir da LOAS, uma série de ferramentas de institucionalização foram organizadas a fim de nortear a nova configuração da Assistência Social, como visto na \Cref{tab:marcos}.

```{=tex}
\begin{table}[h]
\caption{Marcos legais da Assistência Social no Brasil.}
\label{tab:marcos}
\resizebox{\textwidth}{!}{%
\begin{tabulary}{17cm}{@{}CCCCCCCCC@{}}
\toprule
1993 & 1998 & 2004 & 2005      & 2006    & 2009                     & 2010                     & 2011            & 2012     \\ \midrule
LOAS & PNAS & PNAS & NOB/ SUAS & NOB/ RH & Tipificação dos Serviços & Decreto 7.334 Censo SUAS & Lei 12.435 SUAS & NOB/ SUAS \\ \bottomrule
\end{tabulary}%
}
\end{table}
```
A primeira Política Nacional de Assistência Social (PNAS), prevista na LOAS, foi criada em 1998 e instituiu diretrizes para as ações da Assistência Social, representando uma base orientadora para procedimentos a serem adotados pelos gestores da política de assistência social em todo o país\footnote{Boscheti (2001)}.

Em 2003\footnote{As Conferências de Assistência Social deliberam as diretrizes para o aperfeiçoamento da Política de Assistência Social em cada uma das esferas governamentais (BRASIL, 2012).},a IV Conferência Nacional de Assistência Social teve como deliberação a construção e implementação do Sistema Único de Assistência Social (SUAS).

Em 15 de outubro de 2004 foi aprovada pela Resolução nº 145 do Conselho Nacional de Assistência Social (CNAS) a PNAS, que trouxe alterações e definiu alguns elementos importantes para as políticas sociais. Dentre as novidades propostas, destacam-se o aperfeiçoamento da descentralização, a estruturação da participação da população, a fundamentação na centralidade na família para concepção e a implementação dos benefícios, programas e projetos (BRASIL, 2004).

Em conjunto com a PNAS 2004, a Norma Operacional Básica NOB/SUAS 2005 representou importante avanço no sentido de consolidar e implementar as diretrizes previstas na LOAS. A NOB/SUAS 2005 disciplina a gestão da política de assistência social a partir das definições constates na Constituição Federal, na LOAS e na PNAS, e normatiza a operacionalização do Sistema Único de Assistência Social (SUAS). A NOB/SUAS 2005 avança na integração, pactuação e coordenação entre as diversas esferas de governo, na organização das instâncias de gestão, articulação e controle da política, na proteção social, na instituição de arranjos para a prestação de serviços, e no financiamento, com definições sobre repasses regulares e mecanismos de transferências de recursos fundo a fundo baseada em pisos, critérios e indicadores de partilha\footnote{Norma Operacional Básica NOB/SUAS. Construindo as bases para a implantação do Sistema Único de Assistência Social. Disponível em:  (http://www.assistenciasocial.al.gov.br/sala-de-imprensa/arquivos/NOB-SUAS.pdf). Acesso em 26/10/2017}.

A NOB/SUAS 2012 avançou na pactuação de metas e de resultados, e trouxe maior flexibilização para uso dos recursos, ampliando a autonomia dos municípios. Também trouxe avanços em relação à organização da Vigilância Socioassistencial e da gestão do trabalho, principalmente em relação à educação dos trabalhadores.

Outro marco legal de destaque para a Assistência Social foi a Tipificação Nacional dos Serviços Socioassistenciais. Ela foi importante para padronizar a oferta dos serviços de proteção social básica e proteção social especial nacionalmente, especificando os conteúdos da oferta de serviços socioasisstenciais. A Tipificação traz detalhamentos importantes sobre ambiente físico, recursos materiais, recursos humanos, dentre outros. Tem-se, a partir da Tipificação, que os Serviços da Proteção Social Básica são compostos pelo Serviço de Proteção e Atendimento Integral à Família (PAIF), Serviço de Convivência e Fortalecimento de Vínculos e pelo Serviço de Proteção Social Básica no domicílio para pessoas com deficiência e idosas. Os Serviços da Proteção Social Básica buscam a prevenção de vulnerabilidades e riscos sociais.

Os Serviços da Proteção Social Especial, destinada a indivíduos em situação de violação de direitos, por sua vez, dividem-se entre média e alta complexidade. No primeiro caso, enquadram-se o Serviço de Proteção e Atendimento Especializado a Famílias e Indivíduos (PAEFI), o Serviço Especializado em Abordagem Social e o Serviço de Proteção Social a Adolescentes em Cumprimento de Medida Socioeducativa de Liberdade Assistida (LA), e de Prestação de Serviços à Comunidade (PSC). Na alta complexidade, estão os serviços de Acolhimento Institucional, Acolhimento em República, Acolhimento em Família Acolhedora e o Serviço de Proteção em Situações de Calamidades Públicas e de Emergências.

As diversas atualizações de normativos realizadas desde a promulgação da Constituição de 1988 definem aspectos de gestão, financiamento, organização da prestação dos serviços, oferta de benefícios, estrutura, recursos humanos e de participação social para a Assistência Social. Nesse sentido, destaca-se a importância do Censo SUAS como ferramenta de acompanhamento e monitoramento dos diversos elementos que compõem o SUAS.

# Metodologia

Os caminhos metodológicos para a publicação do Censo SUAS traz tem seu percurso uma construção coletiva dos três entes federados. Pode-se dizer que o Censo SUAS se consolida em três grandes processos referentes às seguintes fases:

a)  Ciclo da preparação,
b)  Preenchimento dos formulários,
c)  Tabulação dos dados e análise.

## Ciclo da preparação

A preparação se caracteriza como um momento em que as questões são revisadas com inclusão e exclusão de perguntas. Parte de um processo coordenado pela Vigilância Socioassistencial Nacional em que são debatidos e definidos de forma conjunta pela Secretaria Nacional de Assistência Social (SNAS) e pela Secretaria de Avaliação, Gestão da Informação e Cadastro Único (SAGICAD). Cada alteração tem como objetivo aprimorar e adequar as questões a partir das demandas da conjuntura.

O primeiro formulário do Censo SUAS foi criado em 2007 como uma ficha de registro de caracterização básica dos CRAS, o levantamento passou a ser denominado de Censo CRAS. O SUAS foi expandindo as suas entregas, tipificando novos serviços e consequentemente a necessidade de conhecer melhor a execução desta política em vários aspectos trouxe novos formulários ao longo dos anos. Atualmente são 14 formulários com aproximadamente 6 mil variáveis. O quadro abaixo sinaliza esse percurso histórico da inclusão dos formulários temáticos.

<!-- colar a imagem no arquivo -->

Ao longo desses dezesseis anos, o Censo tem como principal objetivo retratar as estruturas de gestão e de oferta de serviços do SUAS, produzindo informações que subsidiem o planejamento da política, o aperfeiçoamento do sistema, a formação dos trabalhadores e a prestação de contas à sociedade. Assim, é possível, a partir de seus resultados, monitorar e gerar ações e medidas que objetivam a resolução de dificuldades e o aprimoramento da gestão. Cabe destacar que o Censo SUAS foi uma das iniciativas premiadas\footnote{Em ENAP (2011)} na publicação de registro das dez ações premiadas do 16º Concurso Inovação na Gestão Pública Federal, há um breve relato histórico do Censo SUAS.

Sobre o conteúdo dos formulários destacados na ilustração histórica, destaca-se os seguintes a partir da última publicação:

-   **Questionário Gestão Municipal:** 8 Blocos, são eles: Identificação do Órgão Gestor; Gestão do SUAS; Serviços; Programas e outras Ações Socioassistenciais; Benefícios Socioassistenciais, CadÚnico e Transferência de Renda; Atuação durante a pandemia de Covid-19 e Gestão do Trabalho.

-   **Questionário Gestão Estadual :** 8 Blocos, são eles: Identificação do Órgão Gestor; Estrutura Administrativa e Gestão do SUAS; Serviços e Benefícios; Regionalização dos Serviços de Média e Alta Complexidade; Plano de Providência e Apoio Técnico; Comissão Intergestores Bipartite (CIB); Funcionamento durante a pandemia de Covid 19 e Gestão do Trabalho.

-   **Questionário Fundo Municipal:** 5 Blocos, são eles: Identificação; Gestão de Recursos; Recursos Humanos e Responsável pelo preenchimento.

-   **Questionário Fundo Estadual:** 6 Blocos, são eles: Identificação; Cofinanciamento Estadual; Índice de Gestão Descentralizada do Programa Auxílio Brasil; Gestão de Recursos; Recursos Humanos e Responsável pelo preenchimento.

-   **Questionário Centro de Referência de Assistência Social (CRAS):** 12 Blocos, são eles: Identificação; Estrutura Física; Serviço de Proteção e Atendimento Integral a Família (PAIF); Serviço de Convivência e Fortalecimento de Vínculos (SCFV); Serviços de PSB no Domicílio para pessoas com Deficiência e idosas; Equipe Volante; Benefícios socioassistenciais; Cadastro Único; Programa Auxílio Brasil; Funcionamento do CRAS durante a pandemia de Covid 19; Programa Criança Feliz; Gestão e Território; Gestão de Pessoas.

-   **Questionário Centro de Convivência:** 5 Blocos, são eles: Identificação; Caracterização da Unidade; Serviços e Atividades; Gestão; Gestão do trabalho.

-   **Questionário Centro de Referência Especializado de Assistência Social (CREAS):** 11 Blocos, são eles: Identificação; Estrutura Física; Serviço de Proteção e Atendimento Especializado a Famílias e Indivíduos (PAEFI); Serviço de Proteção Social a Adolescentes em Cumprimento de Medida Socioeducativa de Liberdade Assistida (LA) e de Prestação de Serviços à Comunidade (PSC); Serviço de Abordagem Social; Serviço de Proteção Social Especial para Pessoas com Deficiência, Idosas e suas Famílias; Benefícios e Cadastro Único; Gestão e território; Funcionamento durante a pandemia de Covid-19; Articulação e Gestão de Pessoas.

-   **Questionário Centro de Referência Especializado para População em Situação de Rua (Centro POP):** 8 Blocos, são eles: Identificação; Estrutura Física; Funcionamento durante a pandemia de COVID-19; Serviço Especializado para Pessoas em Situação de Rua; Serviço Especializado em Abordagem Social; Benefícios, Cadastro Único Gestão e Participação de Usuárias(os); Articulação e Gestão de Pessoas.

-   **Questionário do Centro Dia e similares:** 7 Blocos, são eles: Identificação, Caracterização da Unidade, Serviços e atividades; Estrutura Física; Perfil dos usuários; Funcionamento durante a pandemia de Covid 19; Articulação; Serviços e Atividades e Gestão de Pessoas.

-   **Questionário Unidades de Acolhimento:** 7 Blocos, são eles: Identificação; Caracterização da Unidade; Características das usuárias (os); Serviço de Acolhimento; Estrutura Física e Área de Localização da Unidade; Funcionamento deste acolhimento durante a pandemia de Covid 19 e Recursos Humanos.

-   **Questionário Família Acolhedora:** 4 Blocos, são eles: Identificação, Caracteristica dos Acolhidas (os); Serviços de Acolhimento; Funcionamento durante a pandemia de Covid 19; Famílias Acolhedoras e Gestão de Pessoas.

-   **Questionário Postos de Cadastro Único:** 4 Blocos, são eles: Identificação, Estrutura Física; Cadastro Único; Programa Bolsa Família; Outras Atividades; Funcionamento dos postos e Gestão de Pessoas.

-   **Questionário Conselhos Municipais de Assistência Social (CMAS) e Conselho de Assistência Social do Distrito Federal (CAS/DF):** 10 Blocos, são eles: Identificação; Regulação; Infraestrutura do Conselho; Secretaria Executiva; Orçamento dos Conselhos; Dinâmica de Funcionamento; Rede Socioassistencial; Composição do Conselho; Conselheiros (as) e Responsável pelo Preenchimento.

-   **Questionário Conselhos Estaduais de Assistência Social (CEAS):** 10 Blocos, são eles: Identificação; Regulação; Infraestrutura do Conselho; Secretaria Executiva; Orçamento dos Conselhos; Dinâmica de Funcionamento; Rede Socioassistencial; Composição do Conselho; Conselheiros (as) e Responsável pelo Preenchimento.

Após essa fase de decisão, os formulários são encaminhados para SAGICAD para processo de tabulação e geração de códigos. É importante destacar que os códigos das variáveis sofrem mudança conforme alteração das perguntas (inclusão e exclusão de perguntas). Este torna-se um desafio para o acompanhamento das respostas ao longo de períodos, haja vista inexistência de uma chave mestra.

## Preenchimento dos formulários

A coleta de dados envolve vários agentes públicos municipais e estaduais das gestões e controle social do SUAS. De acordo com a Norma Operacional Básica do SUAS / 2012 (NOBSUAS/2012) o processo de realização do Censo SUAS deve ser coordenado pela vigilância socioassistencial que deve apoiar no preenchimento zelando pela qualidade das informações coletadas.

O Censo SUAS 2022 foi realizado, como todo ano, por meio de questionários eletrônicos disponíveis no portal da SAGI. O preenchimento em meio eletrônico é realizado apenas pelos órgãos gestores (estaduais e municipais) e conselhos de assistência social (estaduais e municipais). Destaca-se que, para preenchimento dos questionários, o usuário deve estar devidamente cadastrado na Rede SUAS e possuir uma senha de acesso. Os questionários, depois de preenchidos, devem ser salvos pelo respondente. O período de coleta foi entre outubro e dezembro de 2022, conforme cronograma da \Cref{tab:cronograma}.

```{=tex}
\begin{table}[h]
\centering
\caption{Cronograma de preenchimento do Censo SUAS 2022 por questionário.}
\label{tab:cronograma}
\begin{tabular}{|l|c|c|}
\hline
\multicolumn{1}{|c|}{Questionário} & Abertura                      & Encerramento                  \\ \hline
CRAS                               & \multirow{11}{*}{06/Out/2022} & \multirow{11}{*}{02/dez/2022} \\ \cline{1-1}
Centros de Convivência             &                               &                               \\ \cline{1-1}
CREAS (municipal e estadual)       &                               &                               \\ \cline{1-1}
Centro POP                         &                               &                               \\ \cline{1-1}
Centro DIA e Similares             &                               &                               \\ \cline{1-1}
Unidades de Acolhimento
(municipal e estadual)             &                               &                               \\ \cline{1-1}
Família Acolhedora                 &                               &                               \\ \cline{1-1}
Posto de Cadastramento             &                               &                               \\ \cline{1-1}
Fundos de Assistencia social
(municipal e estadual)             &                               &                               \\ \cline{1-1}
Gestão (municipal e estadual)      &                               &                               \\ \cline{1-1}
Conselhos (municipal e estadual)   &                               &                               \\ \hline
\hline
Período de Retificação             & 05/Dez/2022                   & 16/Dez/2022                   \\ \hline
\end{tabular}
\floatfoot{Fonte: MDS, Censo SUAS.}
\end{table}
```
## Tabulação dos dados e análise

Aproximadamente 45 mil questionários foram coletadas. Os bancos de dados resultantes da coleta foram então submetidos a procedimentos de análise da integridade e consistência, bem como de limpeza de dados e de organização da estrutura final e da documentação das bases. Para cada base resultante de um tipo de questionário, foram realizados procedimentos de limpeza e organização específicos. Inicialmente, pretendeu-se manter o maior número possível de respondentes válidos. Para isso, foram considerados como válidos:

-   Questionários totalmente preenchidos e devidamente salvos pelos respondentes;

-   Questionários preenchidos em sua totalidade, mas não devidamente salvos por razões de sistema; e

-   Questionários preenchidos até 90% de sua totalidade com pelo menos um trabalhador registrado no bloco de Recursos Humanos do questionário.

<!-- Nas bases de dados de Recursos Humanos foram descartados, ainda, casos de questionários duplicados ou duplicação do registro dos trabalhadores. Além disso, foi realizada uma verificação de consistência que identificou divergência de informações ligadas à escolaridade e à profissão do trabalhador, prevalecendo escolaridade\footnote{Por exemplo: Profissionais que assinalaram possuir ensino superior completo, mas foram identificados como profissional de nível médio ou sem formação profissional, prevaleceu a escolaridade e o campo profissão permaneceu em branco. Da mesma maneira, um trabalhador que assinalou possuir escolaridade mais baixa à formação, prevaleceu a escolaridade, de tal forma que a profissão permaneceu em branco.}. -->

Para análise dos dados, foram consideradas as quantidades de respondentes de acordo com os bancos de dados após tratamento realizado pela Coordenação-Geral de Planejamento e Vigilância Socioassistencial (CGPVIS/SNAS) descrito acima. A quantidade de unidades consideradas no banco de dados após tratamento constam na \cref{tab:qtd_equipamentos}.

```{=tex}
\begin{table}[h]
\centering
\caption{Quantidade de equipamentos respondentes segundo o Status Censo SUAS.}
\label{tab:qtd_equipamentos}
\begin{tabular}{@{}lc@{}}
\toprule
Equipamento             & Analisados após validação \\ \midrule
CRAS                    & 8.240                     \\
CREAS                   & 2.522                     \\
Centro POP              & 230                       \\
Centros de Convivência  & 8.510                     \\
Unidade de Acolhimento  & 5.832                     \\
Centros Dia e similares & 1.345                     \\ \bottomrule
\end{tabular}
\floatfoot{Fonte: MDS, Censo SUAS.}
\end{table}
```
A análise dos resultados do Censo SUAS 2022 compreende o SUAS como política social por meio dos componentes sistêmicos da PNAS, conforme seu estágio de institucionalização8. Para essa versão consideramos destaques do II Plano Descenal. A tentativa é aprofundar da compreensão universal do SUAS. A exposição da análise do Censo SUAS será realizada de acordo com seis eixos de análise, a saber\footnote{A forma de organização processual destas informações foram através do “R Markdown”. Tal metodologia foi inovadora para o ano de 2022 que antes era realizado a partir de planilhas e gráficos gerados pelo excel. Tal percurso representa maior confiabilidade nas informações, amplia as possibilidades de produção de gráficos, ganho no tempo para próximas publicações entre outras.}:

-   **Gestão e Financiamento do Sistema Único de Assistência Social:** panorama geral da gestão e do financiamento em estados e municípios, com a observação de aspectos como a estrutura administrativa da gestão da assistência social, a atualização de normativos, o apoio de estados aos municípios, as atividades de cofinanciamento e transferência de recursos, funcionamento das instâncias de pactuação, entre outras.

-   **Unidades, Serviços e Benefícios da Assistência Social:** apresenta informações a respeito dos equipamentos da Assistência Social e sua evolução ao longo do tempo, sua esturura e condições na perspectiva de acessibilidade e equipamentos disponíveis. A integração dos Serviços do SUAS no âmbito das proteções sociais, relação com o Cadastro Único, Benefícios do SUAS, bem como Programas. Também aborda-se sobre a Regionalização da proteção social Especial.

-   **Recursos Humanos do SUAS:** apresenta um panorama geral da situação das trabalhadoras e trabalhadores do SUAS tanto nos equipamentos da assistência social quanto nas gestões municipais e estaduais, apresentando informações sobre quantitativo, tipo de vínculo trabalhista, escolaridade, entre outros aspectos referentes à gestão do trabalho, e sua evolução ao longo dos anos.

-   **Participação e controle social no SUAS:** apresenta os resultados apurados pelo Censo SUAS para os Conselhos Municipais e Estaduais de Assistência Social, considerando a estrutura administrativa, a dinâmica de funcionamento e a composição

-   **Indicadores de Desenvolvimento (IDs):** apresenta os resultados dos Indicadores de Desenvolvimento (IDs), uma das proposições da Vigilância Socioassistencial para o acompanhamento e avaliação do desenvolvimento de equipamentos CRAS e CREAS e Conselhos Municipais de Assistência Social (CMAS). Os IDs buscam, por meio da análise de diversos critérios, agrupados em diferentes dimensões, promover o aprimoramento das ações a partir de seu monitoramento.

Espera-se que, a partir de uma avaliação com abordagem direcionada à análise integrada do SUAS e partindo dos dados dos órgãos de gestão das unidades de atendimento públicas e privadas e das instâncias administrativas e deliberativas, seja possível retratar o seu funcionamento e evolução como política social. Assim, amplia-se a compreensão acerca da rede de assistência social por parte dos gestores, trabalhadores e sociedade civil, permitindo uma apreensão crítica de seu funcionamento.

```{r carregamento, cache=TRUE}
ge_2010 <- read_excel("../Censo SUAS 2010/Gestão Estadual/Censo SUAS 2010_Gestão Estadual_DIVULGAÇÃO.xlsx", sheet = "Censo SUAS 2010 Gestão Estadual") %>%
  filter(UF != "DF")

ge_2011 <- read_excel("../Censo SUAS 2011/GESTÃO ESTADUAL/Censo SUAS 2011_Gestão_Estadual_DIVULGAÇÃO.xlsx", sheet = "Censo SUAS 2011 Gestão Estadual")

ge_2012 <- read_excel("../Censo SUAS 2012/Gestão Estadual+DF/Censo SUAS 2012_GestaoEstadual+DF_divulgação.xlsx", sheet = "CensoSUAS2012 GestãoEstadual+DF") %>%
  filter(UF != "DF")

ge_2013 <- read_excel("../Censo SUAS 2013/Gestão Estadual/Censo_SUAS_2013_Gestão_Estadual_Dados_Gerais_Divulgação.xlsx", sheet = "Gestão Estadual 2013")

ge_2014 <- read_excel("../Censo SUAS 2014/Gestão Estadual/Bases de Dados/CensoSUAS2014_GestãoEstadual_Divulgação.xlsx", sheet = "Gestão Estadual 2014")

ge_2015 <- read_excel("../Censo SUAS 2015/Gestão Estadual/Censo_SUAS_2015_Gestão_Estadual_divulgacao.xlsx", sheet = "Censo SUAS Gest. Estadual 2015")

ge_2016 <- read_excel("../Censo SUAS 2016/Gestão Estadual/Censo SUAS Gestão Estadual_2016_DIVULGAÇÃO.xlsx", sheet = "Censo Gestão Estadual 2016")

ge_2017 <- read_excel("../Censo SUAS 2017/Censo_SUAS_2017_Gestão_Estadual/Censo SUAS 2017_Gestão Estadual_divulgação.xlsx", sheet = "Base de dados")

ge_2018 <- read_excel("../Censo SUAS 2018/7 - Gestão Estadual/Censo_SUAS_2018_Gestão_Estadual_Dados_Gerais_divulgaçao.xlsx", sheet = 1)

gerh_2018 <- read_excel("../Censo SUAS 2018/7 - Gestão Estadual/Censo_SUAS_2018_Gestão_Estadual_RH_divulgação.xlsx", sheet = 1)

ge_2019 <- read_excel("../Censo SUAS 2019/8 - Gestão Estadual/Censo_SUAS_2019_dados_gerais_GE__divulgação.xlsx", sheet = 1)

#gerh_2019 <- read_excel("../", sheet = 1)

ge_2020 <- read_excel("../Censo SUAS 2020/10 - Gestão Estadual/Censo_SUAS_2020_dados_gerais_Gestão_Estadual.xlsx", sheet = 1)

gerh_2020 <- read_excel("../Censo SUAS 2020/10 - Gestão Estadual/Censo_SUAS_2020_RH_Gestão_Estadual.xlsx", sheet = 1)

ge_2021 <- read_excel("../Censo SUAS 2021/8 - Gestão Estadual/Censo_SUAS_2021_Gestão_Estadual_Dados_Gerais_Divulgaçao.xlsx", sheet = 1) %>%
  filter(IBGE < 53) # No arquivo tem uma linha em branco com o código do município de Fortaleza

# ATENÇÃO: Verificar por que no arquivo de RH de 2021 têm dados com o código do município de Fortaleza-CE, além dos dados com o código do Ceará
#gerh_2021 <- read_excel("../Censo SUAS 2021/8 - Gestão Estadual/Censo_SUAS_2021_Gestão_Estadual_RH.xlsx", sheet = 1)

ge_2022 <- read_excel("../Censo SUAS 2022/10 - GESTAO ESTADUAL/Censo_SUAS_2022_Gestão_Estadual_Dados_gerais.xlsx", sheet = "Sheet1")

gerh_2022 <- read_excel("../Censo SUAS 2022/10 - GESTAO ESTADUAL/Censo_SUAS_2022_Gestão_Estadual_RH.xlsx")

gm_2010 <- read_excel("../Censo SUAS 2010/Gestão Municipal/Censo SUAS 2010_Gestão Municipal_DIVULGAÇÃO.xlsx", sheet = "Censo SUAS 2010 GestãoMunicipal")

gm_2011 <- read_excel("../Censo SUAS 2011/GESTÃO MUNICIPAL/Censo SUAS 2011_GestãoMunicipal_DIVULGAÇÃO.xlsx", sheet = "Censo SUAS 2011 GestãoMunicipal")

gm_2012 <- read_excel("../Censo SUAS 2012/Gestão Municipal+DF/Censo SUAS 2012_GestaoMunicipal+DF_divulgação.xlsx", sheet = 1)

gm_2013 <- read_excel("../Censo SUAS 2013/Gestão Municipal/Censo_SUAS_2013_Gestão_Municipal_Dados_Gerais_Divulgação.xlsx", sheet = "Gestão Municipal 2013")

gm_2014 <- read_excel("../Censo SUAS 2014/Gestão Municipal/Bases de Dados/CensoSUAS2014_GestãoMunicipal_Divulgação.xlsx", sheet = "Gestão Municipal 2014")

gm_2015 <- read_excel("../Censo SUAS 2015/Gestão Municipal/CensoSUAS_2015_GestãoMunicipal_DIVULGAÇÃO.xlsx", sheet = "Dados_GM_2015")

gm_2016 <- read_excel("../Censo SUAS 2016/Gestão Municipal/Censo_SUAS_2016_Gestao_Municipal_divulgacao.xlsx", sheet = "Censo Gestão Municipal 16")

gm_2017 <- read_excel("../Censo SUAS 2017/Censo_SUAS_2017_Gestão_Municipal/Censo_SUAS_2017_Gestao_Municipal_divulgação.xlsx", sheet = "Base de Dados")

gm_2018 <- read_excel("../Censo SUAS 2018/10 - Gestao Municipal/Censo SUAS 2018_Gestao_Municipal_Dados_Gerais_divulgacao.xlsx", sheet = 1)

gm_2019 <- read_excel("../Censo SUAS 2018/Censo_SUAS_2019_Gestão_Municipal_dados_gerais_divulgacao.xlsx", sheet = 1)

gm_2020 <- read_excel("../Censo SUAS 2020/9 - Gestão Municipal/Censo_SUAS_2020_Gestão_Municipal_dados gerais.xls", sheet = 1)

gm_rh_2020 <- read_excel("../Censo SUAS 2020/9 - Gestão Municipal/Censo_SUAS_2020_Gestão_Municipal_RH.xlsx", sheet = 1)

gm_2021 <- read_excel("../Censo SUAS 2021/3 - Gestao Municipal/Censo_SUAS_2021_Gestão_Municipal_Dados_Gerais_Divulgação.xlsx", sheet = 1)

gm_rh_2021 <- read_excel("../Censo SUAS 2021/3 - Gestao Municipal/Censo_SUAS_Gestão_Municipal_RH.xlsx", sheet = 1)

gm_2022 <- read_excel("../Censo SUAS 2022/9 - GESTÃO MUNICIPAL/Censo_SUAS_2022_Gestão_Municipal_dados_gerais.xlsx", sheet = 1)

gmrh_2022 <- read_excel("../Censo SUAS 2022/9 - GESTÃO MUNICIPAL/Censo_SUAS_2022_Gestão_Municipal_RH.xlsx", sheet = 1)

cras_2007 <- read_excel("../Censo SUAS 2007/CRAS/Censo SUAS CRAS 2007.xls", sheet = 1)

cras_2008 <- read_excel("../Censo SUAS 2008/CRAS/Banco CRAS.xlsx", sheet = "Sheet1")

cras_2009 <- read_excel("../Censo SUAS 2009/CRAS/CRAS2009_final_5798_caracteres_invalidos-registro-1992-corrigidos.xlsx", sheet = "Sheet1")

cras_2010 <- read_excel("../Censo SUAS 2010/CRAS/Censo SUAS 2010_CRAS_DIVULGAÇÃO.xlsx", sheet = "Censo SUAS 2010 CRAS")

cras_2011 <- read_excel("../Censo SUAS 2011/CRAS/Censo SUAS 2011_CRAS_DIVULGAÇÃO.xlsx", sheet = "Censo SUAS 2011 CRAS")

cras_2012 <- read_excel("../Censo SUAS 2012/CRAS/Censo SUAS 2012_CRAS_dados_gerais_2012_divulgação.xlsx", sheet = "Censo SUAS 2012 - CRAS")

crasrh_2012 <- read_excel("../Censo SUAS 2012/CRAS/Censo SUAS 2012_CRAS RH_2012_base_divulgação.xlsx", sheet = "CRAS RH - CensoSUAS2012")

cras_2013 <- read_excel("../Censo SUAS 2013/CRAS/Censo_SUAS_2013_CRAS_Dados_Gerais_Divulgação.xlsx", sheet = "CRAS 2013")

crasrh_2013 <- read_excel("../Censo SUAS 2013/CRAS/Censo_SUAS_2013_CRAS_RH_Divulgação.xlsx", sheet = "CRAS RH 2013")

cras_2014 <- read_excel("../Censo SUAS 2014/CRAS/Bases de Dados/CensoSUAS2014_CRAS_DadosGerais_Divulgação.xlsx", sheet = "CRAS Dados Gerais 2014")

crasrh_2014 <- read_excel("../Censo SUAS 2014/CRAS/Bases de Dados/CensoSUAS2014_CRAS_RH_RETIFICADA_Divulgação.xlsx", sheet = "CRAS RH 2014")

cras_2015 <- read_excel("../Censo SUAS 2015/CRAS/CensoSUAS_2015_CRAS_dadosgerais_divulgacao.xlsx", sheet = "Censo CRAS 2015")

crasrh_2015 <- read_excel("../Censo SUAS 2015/CRAS/CensoSUAS_2015_CRAS_RH_divulgacao.xlsx", sheet = "Censo CRAS RH 2015")

cras_2016 <- read_excel("../Censo SUAS 2016/CRAS/Censo SUAS_CRAS_DadosGerais_DIVULGAÇÃO.xlsx", sheet = "Censo CRAS 2016")

crasrh_2016 <- read_excel("../Censo SUAS 2016/CRAS/Censo SUAS_CRAS_RH_DIVULGAÇÃO.xlsx", sheet = "Censo CRAS RH 2016")

cras_2017 <- read_excel("../Censo SUAS 2017/Censo_SUAS_2017_CRAS/Censo SUAS 2017_CRAS_divulgacao.xlsx", sheet = "Base de dados")

crasrh_2017 <- read_excel("../Censo SUAS 2017/Censo_SUAS_2017_CRAS/Censo SUAS 2017_CRAS_RH_divulgacao.xlsx", sheet = "Base de dados")

cras_2018 <- read_excel("../Censo SUAS 2018/1 - CRAS/Censo_SUAS_2018_CRAS_Dados_Gerais_divulgacao.xlsx", sheet = 1)

crasrh_2018 <- read_excel("../Censo SUAS 2018/1 - CRAS/Censo_SUAS_2018_CRAS_RH_divulgacao.xlsx", sheet= 1)

cras_2019 <- read_excel("../Censo SUAS 2019/1 - CRAS/Censo_SUAS_2019_dados_gerais_RH_CRAS_divulgação.xls", sheet = 1)

crasrh_2019 <- read_excel("../Censo SUAS 2019/1 - CRAS/Censo_SUAS_2019_dados_gerais_RH_CRAS_divulgação.xls", sheet= 1)

cras_2020 <- read_excel("../Censo SUAS 2020/1 - CRAS/Censo_SUAS_2020_CRAS_dados_gerais (1).xlsx", sheet = 1)

crasrh_2020 <- read_excel("../Censo SUAS 2020/1 - CRAS/Censo_SUAS_2020_CRAS_RH.xlsx", sheet= 1)

cras_2021 <- read_excel("../Censo SUAS 2021/1 - CRAS/Censo_SUAS_2021_CRAS_Dados_Gerais.xlsx", sheet = 1)

crasrh_2021 <- read_excel("../Censo SUAS 2021/1 - CRAS/Censo_SUAS_2021_CRAS_RH.xlsx", sheet= 1)

cras_2022 <- read_excel("../Censo SUAS 2022/1_CRAS/Censo_SUAS_2022_CRAS_Dados_Gerais_Divulgação.xlsx", sheet = 1)

posto_cadunico_2020 <- read_excel("../Censo SUAS 2020/5 - Postos do cadunico/Censo_SUAS_2020_Postos_Cadastro_Único_Dados_Gerais.xlsx", sheet = 1)

posto_cadunicorh_2020 <- read_excel("../Censo SUAS 2020/5 - Postos do cadunico/Censo_SUAS_2020_Postos_Cadastro_Único_RH.xlsx", sheet = 1)

posto_cadunico_2021 <- read_excel("../Censo SUAS 2021/14 - Postos do CadUnico/Censo_SUAS_2021_Posto_Cadastramento_Dados_Gerais_Divulgação.xlsx", sheet = 1)

posto_cadunicorh_2021 <- read_excel("../Censo SUAS 2021/14 - Postos do CadUnico/Censo_SUAS_Posto_Cadastramento_RH.xlsx", sheet = 1)

posto_cadunico_2022 <- read_excel("../Censo SUAS 2022/8 - POSTO DE CADASTRAMENTO/Censo _SUAS_ 2022_Posto_cadastramento_Dados_Gerais.xlsx", sheet = 1)

posto_cadunicorh_2022 <- read_excel("../Censo SUAS 2022/8 - POSTO DE CADASTRAMENTO/Censo _SUAS_ 2022_Posto_cadastramentoo_RH.xlsx", sheet = 1)

creas_2010 <- read_excel("../Censo SUAS 2010/CREAS/Censo SUAS 2010_CREAS_DIVULGAÇÃO.xlsx", sheet = "Censo SUAS 2010 CREAS")

creas_2011 <- read_excel("../Censo SUAS 2011/CREAS/Censo SUAS 2011_CREAS_DIVULGAÇÃO.xlsx", sheet = "Censo SUAS 2011 CREAS")

creas_2012 <- read_excel("../Censo SUAS 2012/CREAS/Censo SUAS 2012_CREAS_dados_gerais_2012_divulgação.xlsx", sheet = "Censo SUAS 2012 CREAS")

creasrh_2012 <- read_excel("../Censo SUAS 2012/CREAS/Censo SUAS 2012_CREAS_RH_2012_divulgação.xlsx", sheet = "CREAS RH - CensoSUAS2012")

creas_2013 <- read_excel("../Censo SUAS 2013/CREAS/Censo_SUAS_2013_CREAS_Dados_Gerais_Divulgação_11-04-2014_retificado q55_e_q56.xlsx", sheet = "CREAS 2013")

creasrh_2013 <- read_excel("../Censo SUAS 2013/CREAS/Censo_SUAS_2013_CREAS_RH_Divulgação.xlsx", sheet = "CREAS RH 2013")

creas_2014 <- read_excel("../Censo SUAS 2014/CREAS/Bases de Dados/CensoSUAS2014_CREAS_DadosGerais_Divulgação.xlsx", sheet = "CREAS Dados Gerais 2014")

creasrh_2014 <- read_excel("../Censo SUAS 2014/CREAS/Bases de Dados/CensoSUAS2014_CREAS_RH_Divulgação.xlsx", sheet = "CREAS RH 2014")

creas_2015 <- read_excel("../Censo SUAS 2015/CREAS/CensoSUAS2015_CREAS_DadosGerais_Divulgação.xlsx", sheet = "Censo CREAS 2015")

creasrh_2015 <- read_excel("../Censo SUAS 2015/CREAS/CensoSUAS2015_CREAS_RH_Divulgação.xlsx", sheet = "Censo CREAS RH 2015")

creas_2016 <- read_excel("../Censo SUAS 2016/CREAS/Censo SUAS CREAS_DadosGerais_2016_DIVULGAÇÃO.xlsx", sheet = "Censo CREAS 2016")

creasrh_2016 <- read_excel("../Censo SUAS 2016/CREAS/Censo SUAS CREAS_RH_2016_DIVULGAÇÃO.xlsx", sheet = "Censo CREAS RH 2016")

creas_2017 <- read_excel("../Censo SUAS 2017/Censo_SUAS_2017_CREAS/Censo SUAS 2017_CREAS_divulgacao.xlsx", sheet = "Base de dados")

creasrh_2017 <- read_excel("../Censo SUAS 2017/Censo_SUAS_2017_CREAS/Censo SUAS 2017_CREAS_RH_divulgacao.xlsx", sheet = "Base de dados")

creas_2018 <- read_excel("../Censo SUAS 2018/2 - CREAS/Censo_SUAS_2018_CREAS_Dados_Gerais_divulgacao.xlsx", sheet = 1)

creasrh_2018 <- read_excel("../Censo SUAS 2018/2 - CREAS/Censo_SUAS_2018_CREAS_RH_divulgacao.xlsx", sheet = 1)

creas_2019 <- read_excel("../Censo SUAS 2019/2 - CREAS/Censo_SUAS_2019_CREAS_Dados_Gerais_divulgacao.xlsx", sheet = 1)

creasrh_2019 <- read_excel("../Censo SUAS 2019/2 - CREAS/Censo_SUAS_2019_RH_CREAS_divulgação.xlsx", sheet = 1)

creas_2020 <- read_excel("../Censo SUAS 2020/2 - CREAS/Censo_SUAS_CREAS_2020_Dados_Gerais_divulgacao_revisado.xlsx", sheet = 1)

#creasrh_2020 <- read_excel("../Censo SUAS 2020/2 - CREAS/Censo_SUAS_CREAS_2020_RH_divulgacao.xlsx", sheet = 1)

creas_2021 <- read_excel("../Censo SUAS 2021/2 - CREAS/Censo_SUAS_2021_CREAS_Dados_Gerais_Divulgação.xlsx", sheet = 1)

#creasrh_2021 <- read_excel("../Censo SUAS 2021/2 - CREAS/Censo_SUAS_2021_CREAS_RH.xlsx", sheet = 1)

creas_2022 <- read_excel("../Censo SUAS 2022/2 - CREAS/Censo_SUAS_ 2022_ CREAS_Dados_ Gerais.xlsx", sheet = "dados")

cest_2010 <- read_excel("../Censo SUAS 2010/Conselho Estadual/Censo SUAS 2010_Conselho Estadual_DIVULGAÇÃO.xlsx", sheet = "Censo SUAS 2010 Cons. Estadual")

cest_2011 <- read_excel("../Censo SUAS 2011/CONSELHOS ESTADUAIS/Censo SUAS 2011_Conselho_Estadual_DIVULGAÇÃO.xlsx", sheet = "Censo SUAS 2011 Cons. Estadual")

cest_2012 <- read_excel("../Censo SUAS 2012/Conselho Estadual/Censo SUAS 2012_ConselhoEstadual_dadosgerais_divulgação.xlsx", sheet = "CensoSUAS2012 ConselhoEstadual")

cestrh_2012 <- read_excel("../Censo SUAS 2012/Conselho Estadual/Censo SUAS 2012_ConselhoEstadual_RH_divulgação.xlsx", sheet = "Censo2012 ConselhoEstadual RH")

cest_2013 <- read_excel("../Censo SUAS 2013/Conselho Estadual/Censo_SUAS_2013_Conselho_Estadual_Dados_Gerais_Divulgação.xlsx", sheet = "Conselho Estadual 2013")

cestrh_2013 <- read_excel("../Censo SUAS 2013/Conselho Estadual/Censo_SUAS_2013_Conselho_Estadual_RH_Divulgação.xlsx", sheet = "Conselho Estadual RH 2013")

cest_2014 <- read_excel("../Censo SUAS 2014/Conselho Estadual/Bases de Dados/CensoSUAS2014_ConselhoEstadual_DadosGerais_Divulgação.xlsx", sheet = "Conselho Estadual 2014")

cestrh_2014 <- read_excel("../Censo SUAS 2014/Conselho Estadual/Bases de Dados/CensoSUAS2014_ConselhoEstadual_RH_Divulgação.xlsx", sheet = "Conselho Estadual RH 2014")

cest_2015 <- read_excel("../Censo SUAS 2015/Conselho Estadual/Censo SUAS 2015_Conselho Estadual_Dados Gerais_divulgação.xlsx", sheet = "CensoSUAS2015 ConselhoEstadual")

cestrh_2015 <- read_excel("../Censo SUAS 2015/Conselho Estadual/Censo SUAS 2015_Conselho Estadual_RH_divulgação.xlsx", sheet = "CensoSUAS2015ConselhoEstadualRH")

cest_2016 <- read_excel("../Censo SUAS 2016/Conselho/Estadual/Censo SUAS 2016_Conselho_Estadual_Dados Gerais_Divulgação.xlsx", sheet = "Censo SUAS 2016 Conselho Est DG")

cestrh_2016 <- read_excel("../Censo SUAS 2016/Conselho/Estadual/Censo SUAS 2016_Conselho Estadual_RH_Divulgação.xlsx", sheet = "Censo SUAS 2016_Conselho Est RH")

cest_2017 <- read_excel("../Censo SUAS 2017/Censo_SUAS_2017_Conselho_Estadual/Censo SUAS 2017_Conselho Estadual.xlsx", sheet = "Base de dados")

cestrh_2017 <- read_excel("../Censo SUAS 2017/Censo_SUAS_2017_Conselho_Estadual/Censo SUAS_RH_Conselhos Estaduais.xlsx", sheet = "Base de dados")

cest_2018 <- read_excel("../Censo SUAS 2018/13 - CEAS/Censo SUAS 2018_Conselho Estadual_Dados_Gerais_divulgacao.xlsx", sheet = 1)

cestrh_2018 <- read_excel("../Censo SUAS 2018/13 - CEAS/Censo SUAS 2018_Conselho_Estadual_RH_divulgacao.xlsx", sheet = 1)

cest_2019 <- read_excel("../Censo SUAS 2019/13 - CEAS/Censo_SUAS_2019_dados_gerais_RH_Conselho_Estadual_divulgação.xlsx", sheet = 1)

cestrh_2019 <- read_excel("../Censo SUAS 2019/13 - CEAS/Censo_SUAS_2019_dados_gerais_RH_Conselho_Estadual_divulgação.xlsx", sheet = 1)

cest_2020 <- read_excel("../Censo SUAS 2020/13 - CEAS/Censo_SUAS_2020_Dados_Gerais_Conselho_Estadual.xlsx", sheet = 1)

cestrh_2020 <- read_excel("../Censo SUAS 2020/13 - CEAS/Censo_SUAS_2020_RH_Conselho_Estadual.xlsx", sheet = 1)

cest_2021 <- read_excel("../Censo SUAS 2021/13 - CEAS/Censo_SUAS_2021_Conselho_Estadual_Dados_Gerais_Divulgação.xlsx", sheet = 1)

cestrh_2021 <- read_excel("../Censo SUAS 2021/13 - CEAS/Censo_SUAS_2021_Conselho_Estadual_RH.xlsx", sheet = 1)

cest_2022 <- read_excel("../Censo SUAS 2022/13 - CEAS/Censo_SUAS_2022_Conselho_Estadual_dados_gerais.xlsx", sheet = 1)

cestrh_2022 <- read_excel("../Censo SUAS 2022/13 - CEAS/Censo_SUAS_2022_Conselho_Estadual_RH.xlsx", sheet = 1)

cmun_2010 <- read_excel("../Censo SUAS 2010/Conselho Municipal/Censo SUAS 2010_Conselho Municipal_DIVULGAÇÃO.xlsx", sheet = "Censo SUAS 2010 Cons. Municipal")

cmun_2011 <- read_excel("../Censo SUAS 2011/CONSELHOS MUNICIPAIS E DF/Censo SUAS 2011_Conselhos_municipais_e DF_DIVULGAÇÃO.xlsx", sheet = "Censo SUAS 2011 Cons. Municipal")

cmun_2012 <- read_excel("../Censo SUAS 2012/Conselho Municipal+DF/Censo SUAS 2012_ConselhoMunicipal+DF_dadosgerais_divulgação.xlsx", sheet = "CensoSUAS2012 ConselhoMunicipal")

cmunrh_2012 <- read_excel("../Censo SUAS 2012/Conselho Municipal+DF/Censo SUAS 2012_ConselhoMunicipal+DF_RH_divulgação.xlsx", sheet = "Censo2012 ConselhoMunicipal RH")

cmun_2013 <- read_excel("../Censo SUAS 2013/Conselho Municipal/Censo_SUAS_2013_Conselho_Municipal_Dados Gerais_Divulgação.xlsx", sheet = 1)

cmunrh_2013 <- read_excel("../Censo SUAS 2013/Conselho Municipal/Censo_SUAS_2013_Conselho_Municipal_RH_Divulgação.xlsx", sheet = "Conselho Municipal RH 2013")

cmun_2014 <- read_excel("../Censo SUAS 2014/Conselho Municipal/Bases de Dados/CensoSUAS2014_ConselhoMunicipal_DadosGerais_Divulgação.xlsx", sheet = "Conselho Municipal 2014")

cmunrh_2014 <- read_excel("../Censo SUAS 2014/Conselho Municipal/Bases de Dados/CensoSUAS2014_ConselhoMunicipal_RH_Divulgação.xlsx", sheet = "Conselho Municipal RH 2014")

cmun_2015 <- read_excel("../Censo SUAS 2015/Conselho Municipal/Censo SUAS 2015_Conselho Municipal_Dados Gerais_divulgação.xlsx", sheet = "CensoSUAS2015 ConselhoMunicipal")

cmunrh_2015 <- read_excel("../Censo SUAS 2015/Conselho Municipal/Censo SUAS 2015_Conselho Municipal_RH_divulgação.xlsx", sheet = "CensoSUAS15 ConselhoMunicipalRH")

cmun_2016 <- read_excel("../Censo SUAS 2016/Conselho/Municipal/Censo SUAS 2016_Conselho Municipal_Dados Gerais_Divulgação.xlsx", sheet = "Censo SUAS 2016_Conselho Mun DG")

cmunrh_2016 <- read_excel("../Censo SUAS 2016/Conselho/Municipal/Censo SUAS 2016_Conselho Municipal_RH_Divulgação.xlsx", sheet = "Censo SUAS 2016_Conselho Mun_RH")

cmun_2017 <- read_excel("../Censo SUAS 2017/Censo_SUAS_2017_Conselho_Municipal/Censo SUAS 2017_Conselho Municipal.xlsx", sheet = "Base de dados")

cmunrh_2017 <- read_excel("../Censo SUAS 2017/Censo_SUAS_2017_Conselho_Municipal/Censo SUAS 2017_RH_Conselho Municipal.xlsx", sheet = "Base de dados")

cmun_2018 <- read_excel("../Censo SUAS 2018/12 - CMAS/Censo SUAS 2018_Conselho_Municipal_Dados_Gerais_divulgacao.xlsx", sheet = 1)

cmunrh_2018 <- read_excel("../Censo SUAS 2018/12 - CMAS/Censo SUAS 2018 _Conselho Municipal_RH_divulgacao.xlsx", sheet = 1)

cmun_2019 <- read_excel("../Censo SUAS 2019/12 - CMAS/Censo_SUAS_2019_Dados_gerais_RH_Conselho_Municipal_divulgação.xlsx", sheet = 1)

cmunrh_2019 <- read_excel("../Censo SUAS 2019/12 - CMAS/Censo_SUAS_2019_Dados_gerais_RH_Conselho_Municipal_divulgação.xlsx", sheet = 1)

cmun_2020 <- read_excel("../Censo SUAS 2020/4 - CMAS/Censo_SUAS_2020_Conselho_municipal_Dados_Gerais.xlsx", sheet = 1)

cmunrh_2020 <- read_excel("../Censo SUAS 2020/4 - CMAS/Censo_SUAS_2020_Conselho_municipal_RH.xlsx", sheet = 1)

cmun_2021 <- read_excel("../Censo SUAS 2021/12 - CMAS/Censo_SUAS_2021_Conselho_Municipal_Dados_Gerais_Divulgação.xlsx", sheet = 1)

cmunrh_2021 <- read_excel("../Censo SUAS 2021/12 - CMAS/Censo_SUAS_2021_Conselho_Municipal_RH.xlsx", sheet = 1)

cmun_2022 <- read_excel("../Censo SUAS 2022/12 - CMAS/Censo_SUAS_2022_Conselho_Municipal_Dados_gerais.xlsx", sheet = 1)

cmunrh_2022 <- read_excel("../Censo SUAS 2022/12 - CMAS/Censo_SUAS_2022_Conselho_Municipal_RH.xlsx", sheet = 1)

rpriv_2010 <- read_excel("../Censo SUAS 2010/Rede Privada/Censo SUAS 2010_Rede privada_DIVULGAÇÃO.xlsx", sheet = "Censo SUAS 2010 Rede Privada")

rpriv_2011 <- read_excel("../Censo SUAS 2011/Rede Privada/Censo SUAS 2011_Rede Privada_DIVULGAÇÃO.xlsx", sheet = "Censo SUAS 2010 Rede Privada")

rpriv_2011 <- read_excel("../Censo SUAS 2011/Rede Privada/Censo SUAS 2011_Rede Privada_DIVULGAÇÃO.xlsx", sheet = "Censo SUAS 2010 Rede Privada")

cpop_2011 <- read_excel("../Censo SUAS 2011/CENTRO POP/Censo SUAS 2011_CENTRO_POP_DIVULGAÇÃO.xlsx", sheet = "Censo SUAS 2011 Centro POP")

cpop_2012 <- read_excel("../Censo SUAS 2012/Centro POP/Censo SUAS 2012_CentroPOP_Divulgação.xlsx", sheet = "Centro POP - CensoSUAS2012")

cpoprh_2012 <- read_excel("../Censo SUAS 2012/Centro POP/Censo SUAS 2012_CentroPOP_RH_Divulgação.xlsx", sheet = "Centro POP RH - CensoSUAS2012")

cpop_2013 <- read_excel("../Censo SUAS 2013/Centro POP/Censo_SUAS_2013_CentroPOP_Dados_Gerais_Divulgação.xlsx", sheet = "Centro POP 2013")

cpoprh_2013 <- read_excel("../Censo SUAS 2013/Centro POP/Censo_SUAS_2013_CentroPOP_RH_Divulgação.xlsx", sheet = "CentroPOP RH 2013")

cpop_2014 <- read_excel("../Censo SUAS 2014/CentroPOP/Bases de Dados/Censo_SUAS_2014_CentroPOP_Dados Gerais_Divulgação.xlsx", sheet = "CentroPOP Dados Gerais 2014")

cpoprh_2014 <- read_excel("../Censo SUAS 2014/CentroPOP/Bases de Dados/Censo_SUAS_2014_CentroPOP_RH_Divulgação.xlsx", sheet = "CentroPOP_2014_RH")

cpop_2015 <- read_excel("../Censo SUAS 2015/Centro POP/Censo-SUAS_2015_Centro_POP_dados_gerais_divulgação.xlsx", sheet = "Censo Centro POP 2015")

cpoprh_2015 <- read_excel("../Censo SUAS 2015/Centro POP/Censo-SUAS_2015_Centro_POP_RH_divulgação.xlsx", sheet = "Censo Centro POP RH 2015")

cpop_2016 <- read_excel("../Censo SUAS 2016/Centro POP/Censo SUAS_CentroPOP_DadosGerais_2016_DIVULGAÇÃO.xlsx", sheet = "Censo Centro POP 2016")

cpoprh_2016 <- read_excel("../Censo SUAS 2016/Centro POP/Censo SUAS_CentroPOP_RH_2016_DIVULGAÇÃO.xlsx", sheet = "Censo CentroPOP RH 2016")

cpop_2017 <- read_excel("../Censo SUAS 2017/Censo_SUAS_2017_Centro_POP/Censo SUAS 2017_Centro POP_divulgação.xlsx", sheet = "Base de dados")

cpoprh_2017 <- read_excel("../Censo SUAS 2017/Censo_SUAS_2017_Centro_POP/Censo SUAS 2017_Centro POP_RH_divulgação.xlsx", sheet = "Base de dados")

cpop_2018 <- read_excel("../Censo SUAS 2018/4 - Centro Pop/Censo_SUAS_2018_Centro_POP_Dados_Gerais.xlsx", sheet = 1)

cpoprh_2018 <- read_excel("../Censo SUAS 2018/4 - Centro Pop/Censo_SUAS_2018_Centro_POP_RH.xlsx", sheet = 1)

cpop_2019 <- read_excel("../Censo SUAS 2019/3 - Centro Pop/Censo_SUAS_2019_Centro_POP_ Dados_Gerais.xlsx", sheet = 1)

cpoprh_2019 <- read_excel("../Censo SUAS 2019/3 - Centro Pop/Censo_SUAS_2019_Centro_POP_RH.xlsx", sheet = 1)

cpop_2020 <- read_excel("../Censo SUAS 2020/8 - Centro Pop/CensoSUAS_2020_Dados_Gerais_Centro_POP.xlsx", sheet = 1)

cpoprh_2020 <- read_excel("../Censo SUAS 2020/8 - Centro Pop/CensoSUAS_2020_RH_Centro_POP.xlsx", sheet = 1)

cpop_2021 <- read_excel("../Censo SUAS 2021/4 - Centro Pop/Censo_SUAS_2021_CPOP_Dados_Gerais_divulgação.xlsx", sheet = 1)

cpoprh_2021 <- read_excel("../Censo SUAS 2021/4 - Centro Pop/Censo_SUAS_2021_CPOP_Dados_Gerais_divulgação.xlsx", sheet = 1)

cpop_2022 <- read_excel("../Censo SUAS 2022/3 - CENTRO POP/Censo_SUAS_2022_Centro_POP_dados_gerais.xlsx", sheet = 1)

cpoprh_2022 <- read_excel("../Censo SUAS 2022/3 - CENTRO POP/Censo_SUAS_2021_Centro_POP_RH.xlsx", sheet = 1)

unac_2012 <- read_excel("../Censo SUAS 2012/Unidades de Acolhimento/Censo SUAS 2012_Unidades_de_Acolhimento_dadosgerais_divulgação.xlsx", sheet = 1)

unacrh_2012 <- read_excel("../Censo SUAS 2012/Unidades de Acolhimento/Censo SUAS 2012_Unidades_de_Acolhimento_RH_divulgação.xlsx", sheet = "CensoSUAS2012 Acolhimento RH")

unac_2013 <- read_excel("../Censo SUAS 2013/Acolhimento/Censo_SUAS_2013_Acolhimento_Dados_Gerais_Divulgação.xlsx", sheet = "Acolhimento 2013")

unacrh_2013 <- read_excel("../Censo SUAS 2013/Acolhimento/Censo_SUAS_2013_Acolhimento_RH_Divulgação.xlsx", sheet = "Acolhimento RH 2013")

unac_2014 <- read_excel("../Censo SUAS 2014/Acolhimento/Bases de Dados/CensoSUAS2014_Acolhimento_DadosGerais_Divulgação_Retificada_14_08_2015.xlsx", sheet = "Acolhimento 2014")

unacrh_2014 <- read_excel("../Censo SUAS 2014/Acolhimento/Bases de Dados/CensoSUAS2014_Acolhimento_RH_Divulgação.xlsx", sheet = "Acolhimento RH 2014")

unac_2015 <- read_excel("../Censo SUAS 2015/Unidades de Acolhimento/Censo SUAS 2015_Unidades de Acolhimento_Dados Gerais_divulgação.xlsx", sheet = "Censo Acolhimento 2015 DG")

unacrh_2015 <- read_excel("../Censo SUAS 2015/Unidades de Acolhimento/Censo SUAS 2015_Unidades de Acolhimento_Recursos Humanos_divulgação.xlsx", sheet = "Censo SUAS Acolhimento 2015 RH")

unac_2016 <- read_excel("../Censo SUAS 2016/Acolhimento/CensoSUAS2016_Acolhimento_DG_DIVULGAÇÃO.xlsx", sheet = 1)

unacrh_2016 <- read_excel("../Censo SUAS 2016/Acolhimento/CensoSUAS2016_Acolhimento_RH_DIVULGAÇÃO.xlsx", sheet = "CensoSUAS2016_Acolhimento_RH")

unac_2017 <- read_excel("../Censo SUAS 2017/Censo_SUAS_2017_Unidades_Acolhimento/Censo Suas 2017 Unidades de Acolhimento_divulgação.xlsx", sheet = "Base de dados")

unacrh_2017 <- read_excel("../Censo SUAS 2017/Censo_SUAS_2017_Unidades_Acolhimento/CENSO SUAS 2017 Acolhimento RH divulgação.xlsx", sheet = "Base de dados")

unac_2018 <- read_excel("../Censo SUAS 2018/3 - Unidade de acolhimento/Censo_SUAS_2018_Acolhimento_Municipal_e_Estadual_dados_gerais_divulgação (1).xls", sheet = 1)

unacrh_2018 <- read_excel("../Censo SUAS 2018/3 - Unidade de acolhimento/Censo_SUAS_2018_Acolhimento_Municipal_RH_divulgacao.xlsx", sheet = 1)

unac_2019 <- read_excel("../Censo SUAS 2019/5 - Unidade de acolhimento/Censo_SUAS_2019_DG_Acolhimento.xlsx", sheet = 1)

unacrh_2019 <- read_excel("../Censo SUAS 2019/5 - Unidade de acolhimento/Censo_SUAS_2019_RH_Acolhimento.xlsx", sheet = 1)

unac_2020 <- read_excel("../Censo SUAS 2020/14 - Unidades de Acolhimento/Censo_SUAS_2020_DG_Acolhimento.xlsx", sheet = 1)

unacrh_2020 <- read_excel("../Censo SUAS 2020/14 - Unidades de Acolhimento/Censo_SUAS_2020_RH_Acolhimento.xlsx", sheet = 1)

unac_2021 <- read_excel("../Censo SUAS 2021/7 - Unidade de acolhimento/Censo_SUAS_2021_Unidade_Acolhimento_Dados_Gerais_Divulgação.xlsx", sheet = 1)

unacrh_2021 <- read_excel("../Censo SUAS 2021/7 - Unidade de acolhimento/Censo_SUAS_2021_Unidade_Acolhimento_RH.xlsx", sheet = 1)

unac_2022 <- read_excel("../Censo SUAS 2022/4 - UNIDADE DE ACOLHIMENTO/Censo_SUAS_2022 _ Unidades_de_Acolhimento_dados_gerais.xlsx", sheet = 1)

ceconv_2014 <- read_excel("../Censo SUAS 2014/Centros de Convivência/Bases de Dados/CensoSUAS2014_Convivência_Divulgação.xlsx", sheet = "Convivência 2014")

ceconv_2015 <- read_excel("../Censo SUAS 2015/Centro de Convivência/CensoSUAS_2015_Convivencia_DadosGerais_divulgacao.xlsx", sheet = "Censo Convivência 2015")

ceconvrh_2015 <- read_excel("../Censo SUAS 2015/Centro de Convivência/CensoSUAS_2015_Convivencia_RH_divulgacao.xlsx", sheet = "Censo Convivência RH 2015")

ceconv_2016 <- read_excel("../Censo SUAS 2016/Convivência/CensoSUAS_2016_Convivencia_DadosGerais_divulgacao.xlsx", sheet = "CensoSUAS_2016_Convivencia_DG")

ceconvrh_2016 <- read_excel("../Censo SUAS 2016/Convivência/CensoSUAS_2016_Convivencia_RH_divulgacao.xlsx", sheet = "CensoSUAS_2016_Convivencia_RH")

ceconv_2017 <- read_excel("../Censo SUAS 2017/Censo_SUAS_2017_Centro_Convivencia/CensoSUAS2017_Convivencia_DG_divulgacao.xlsx", sheet = "Base de dados")

ceconvrh_2017 <- read_excel("../Censo SUAS 2017/Censo_SUAS_2017_Centro_Convivencia/CensoSUAS2017_Convivencia_RH_divulgacao.xlsx", sheet = "Base de dados")

ceconv_2018 <- read_excel("../Censo SUAS 2018/6 - Centro Convivência/CENSO_SUAS_2018_Centro_Convivencia_Dados_gerais_divulgacao.xls", sheet = 1)

ceconv_2020 <- read_excel("../Censo SUAS 2020/10 - centro convivencia/Censo_SUAS_2020_Centro_Convivencia_dados_gerais.xlsx", sheet = 1)

ceconvrh_2020 <- read_excel("../Censo SUAS 2020/10 - centro convivencia/Censo_SUAS_2020_Centro_Convivencia_RH.xlsx", sheet = 1)

ceconv_2021 <- read_excel("../Censo SUAS 2021/10 - centro convivencia/Censo_SUAS_2021_Centro_Convivencia_Dados_Gerais_Divulgação.xls", sheet = 1)

ceconvrh_2021 <- read_excel("../Censo SUAS 2021/10 - centro convivencia/Censo_SUAS_2021_Centro_Convivencia_Dados_Gerais_Divulgação.xls", sheet = 1)

ceconv_2022 <- read_excel("../Censo SUAS 2022/5 - Centro Convivência/Censo_SUAS_ 2022_ Centros_de_Convivência_dados_gerais.xlsx", sheet = 1)

ceconvrh_2022 <- read_excel("../Censo SUAS 2022/5 - Centro Convivência/Censo_SUAS_ 2022_ Centros_de_Convivência_RH.xlsx", sheet = 1)

cedia_2015 <- read_excel("../Censo SUAS 2015/Centro DIA/CensoSUAS_2015_CentroDIA_dadosgerais_divulgacao.xlsx", sheet = "Censo SUAS Centro DIA 2015")

cediarh_2015 <- read_excel("../Censo SUAS 2015/Centro DIA/CensoSUAS_2015_CentroDIA_RH_divulgacao.xlsx", sheet = "Censo SUAS Centro DIA RH 2015")

cedia_2016 <- read_excel("../Censo SUAS 2016/Centro DIA/Censo SUAS 2016_CentroDIA_DadosGerais_Divulgacao.xlsx", sheet = "Censo SUAS 2016 CentroDIA DG")

cediarh_2016 <- read_excel("../Censo SUAS 2016/Centro DIA/Censo SUAS 2016_CentroDIA_RH_Divulgacao.xlsx", sheet = "Censo SUAS 2016 CentroDIA RH")

cedia_2017 <- read_excel("../Censo SUAS 2017/Censo SUAS 2017_Centro DIA/CensoSUAS2017_CentroDIA_DG_divulgacao.xlsx", sheet = "Base de dados")

cediarh_2017 <- read_excel("../Censo SUAS 2017/Censo SUAS 2017_Centro DIA/CensoSUAS2017_CentroDIA_RH_divulgacao.xlsx", sheet = "Base de dados")

cedia_2018 <- read_excel("../Censo SUAS 2018/5 - Centro Dia/Censo_SUAS_2018_Centro_DIA_dados_gerais_divulgacao.xlsx", sheet = 1)

cediarh_2018 <- read_excel("../Censo SUAS 2018/5 - Centro Dia/Censo_SUAS_2018_Centro_DIA_RH_divulgacao.xlsx", sheet = 1)

cedia_2019 <- read_excel("../Censo SUAS 2019/6 - Centro Dia/Censo_SUAS_2019_Dados_Gerais_RH_Centro_DIA_divulgação.xlsx", sheet = 1)

cediarh_2019 <- read_excel("../Censo SUAS 2019/6 - Centro Dia/Censo_SUAS_2019_Centro_DIA_RH_divulgação.xlsx", sheet = 1)

cedia_2020 <- read_excel("../Censo SUAS 2020/10 - Centro Dia/Censo_SUAS_2020_Centro_Dia_Dados_Gerais.xls", sheet = 1)

cediarh_2020 <- read_excel("../Censo SUAS 2020/10 - Centro Dia/Censo_SUAS_2020_Centro_Dia_RH.xlsx", sheet = 1)

cedia_2021 <- read_excel("../Censo SUAS 2021/6 - Centro Dia/Censo_SUAS_2021_Centro_Dia_Dados_Gerais_Divulgação.xls", sheet = 1)

cediarh_2021 <- read_excel("../Censo SUAS 2021/6 - Centro Dia/Censo_SUAS_2021_Centro_Dia_RH.xls", sheet = 1)

cedia_2022 <- read_excel("../Censo SUAS 2022/6 - CENTRO DIA/Censo_SUAS_2022_Centro_Dia_dados_gerais.xlsx", sheet= 1)

#famacol_2017 <- read_excel("../Censo SUAS 2017/Censo SUAS 2017 Família Acolhedora/Censo SUAS 2017_Família Acolhedora_divulgação.xlsx", sheet = "Base de dados")

#famacolrh_2017 <- read_excel("../Censo SUAS 2017/Censo SUAS 2017 Família Acolhedora/Censo SUAS 2017_Família Acolhedora_RH_divulgação.xlsx", sheet = "Base de dados")

famacolfam_2017 <- read_excel("../Censo SUAS 2017/Censo SUAS 2017 Família Acolhedora/Censo SUAS 2017_Família Acolhedora_Familia_divulgação.xlsx", sheet = "Base de dados")

feas_2018 <- read_excel("../Censo SUAS 2018/8 - Fundo Estadual/Censo_SUAS_2018_Dados_gerais_FE_divulgação.xlsx", sheet = 1)

feas_2019 <- read_excel("../Censo SUAS 2019/9 - Fundo Estadual/Censo_SUAS_2019_Fundo_Estadual_dados_gerais_divulgacao.xlsx", sheet = 1)

feas_2020 <- read_excel("../Censo SUAS 2020/12 - Fundo Estadual/Censo_SUAS_2020_FE_dados_gerais_divulgação.xlsx", sheet = 1)

feas_2021 <- read_excel("../Censo SUAS 2021/9 - Fundo Estadual/Censo_SUAS_2021_Fundo_Estadual_Dados_Gerais_Divulgação.xlsx", sheet = 1)

feasrh_2021 <- read_excel("../Censo SUAS 2021/9 - Fundo Estadual/Censo_SUAS_2021_Fundo_Estadual_RH.xlsx", sheet = 1)

feas_2022 <- read_excel("../Censo SUAS 2022/10 - FEAS/Censo_SUAS_2022_ Fundo_Estadual_Dados_gerais.xlsx", sheet = 1)

feasrh_2022 <- read_excel("../Censo SUAS 2022/10 - FEAS/Censo_SUAS_2022_Fundo_Estadual_RH.xlsx",sheet = 1)

fmas_2018 <- read_excel("../Censo SUAS 2018/9 - Fundo Municipal/Censo_SUAS_2018_FM_Dados_Gerais_divulgação.xlsx",sheet = 1)

fmasRH_2018 <- read_excel("../Censo SUAS 2018/9 - Fundo Municipal/Censo_SUAS_2018_FM_RH_divulgação.xlsx",sheet = 1)

#fmas_2019 <- read_excel("../Censo SUAS 2019/10 - Fundo Municipal/Censo_SUAS_2019_Fundo_Municipal_Dados_Gerais.xls",sheet = 1)

#fmasRH_2019 <- read_excel("../Censo SUAS 2019/10 - Fundo Municipal/Censo_SUAS_2019_Fundo_Municipal_RH.xls",sheet = 1)

fmas_2020 <- read_excel("../Censo SUAS 2020/11 - Fundo Municipal/Censo_SUAS_2020_Fundo_Municipal_dados_gerais_divulgação.xlsx",sheet = 1)

fmasRH_2020 <- read_excel("../Censo SUAS 2020/11 - Fundo Municipal/Censo_SUAS_2020_Fundo_Municipal_RH.xlsx",sheet = 1)

fmas_2021 <- read_excel("../Censo SUAS 2021/10 - Fundo Municipal/Censo_SUAS_2021_Fundo_Municipal_Dados_Gerais_Divulgação.xlsx",sheet = 1)

fmasRH_2021 <- read_excel("../Censo SUAS 2021/10 - Fundo Municipal/Censo_SUAS_2021_Fundo_Municipal_RH.xlsx",sheet = 1)

fmas_2022 <- read_excel("../Censo SUAS 2022/11 - FMAS/Censo_SUAS_2022 - Fundo Municipal_dados_gerais.xlsx",sheet = 1)


idconselho_2014 <- read_excel("../ID CONSELHO/IDConselho2014_alterado_08-12-2016.xlsx",sheet = 1)
idconselho_2015 <- read_excel("../ID CONSELHO/ID CONSELHO - 2015.xlsx",sheet = 1)
idconselho_2016 <- read_excel("../ID CONSELHO/ID CONSELHO - 2016.xlsx",sheet = 1)
idconselho_2017 <- read_excel("../ID CONSELHO/ID CONSELHO - 2017.xlsx",sheet = 1)
idconselho_2018 <- read_excel("../ID CONSELHO/ID CONSELHO - 2018.xlsx",sheet = 1)
idconselho_2019 <- read_excel("../ID CONSELHO/ID CONSELHO - 2019.xlsx",sheet = 1,guess_max=7)
idconselho_2020 <- read_excel("../ID CONSELHO/ID CONSELHO - 2020.xlsx",sheet = 1,guess_max=12)
idconselho_2021 <- read_excel("../ID CONSELHO/IDCONSELHO_2021_divulgacao.xlsx",guess_max=140)
idconselho_2022 <- read_excel("../ID CONSELHO/IDConselho_Municipal_2022_divulgacao.xlsx",sheet = 1)

idcras_2014 <- read_excel("../ID CRAS/NOVO_IDCRAS_2014_divulgação_retificado_07_10_2016.xlsx",sheet = 1)
idcras_2015 <- read_excel("../ID CRAS/NOVO_IDCRAS_2015_divulgação_retificado_07_10_2016.xlsx",sheet = 1)
idcras_2016 <- read_excel("../ID CRAS/IDCRAS_2016_FINAL_(01062017).xlsx",sheet = 1)
idcras_2017 <- read_excel("../ID CRAS/IDCRAS_2017_DIVULGAÇÃO_atualizado__030523.xlsx",sheet = 2, skip=6)
idcras_2018 <- read_excel("../ID CRAS/IDCRAS_2018_DIVULGAÇÃO_atualizado_280423.xlsx",sheet = 1)
idcras_2019 <- read_excel("../ID CRAS/IDCRAS_2019_DIVULGAÇÃO_atualizado_280423.xlsx",sheet = 1)
idcras_2020 <- read_excel("../ID CRAS/IDCRAS_2020_DIVULGAÇÃO_atualizado_280423(1).xlsx",sheet = 1)
idcras_2021 <- read_excel("../ID CRAS/IDCRAS_2021_DIVULGAÇÃO_atulaizado_280423(1).xlsx",sheet = 1)
idcras_2022 <- read_excel("../ID CRAS/IDCRAS_2022_DIVULGAÇÃO_atualizado_280423(1).xlsx",sheet = 1)

idcreas_2014 <- read_excel("../ID CREAS/IDCREAS_2014_DIVULGACAO_site.xlsx",sheet = 1)
idcreas_2015 <- read_excel("../ID CREAS/ID_CREAS_2015_divulgacao_site.xlsx",sheet = 1)
idcreas_2016 <- read_excel("../ID CREAS/IDCREAS_2016_DIVULGAÇÃO.xlsx",sheet = 1)
idcreas_2017 <- read_excel("../ID CREAS/IDCREAS_2017_DIVULGAÇÃO (2).xlsx",sheet = 1)
idcreas_2018 <- read_excel("../ID CREAS/IDCREAS2018_divulgacao(2).xlsx",sheet = 1)
idcreas_2019 <- read_excel("../ID CREAS/IDCREAS2019_divulgacao.xlsx",sheet = 1)
idcreas_2020 <- read_excel("../ID CREAS/IDCREAS2020_divulgacao.xlsx",sheet = 1)
idcreas_2021 <- read_excel("../ID CREAS/IDCREAS2021_divulgacao_retificado191022(1) (1).xlsx",sheet = 1)
idcreas_2022 <- read_excel("../ID CREAS/IDCREAS2022_divulgacao_retificado270923.xlsx",sheet = 1)

niveis_ID <- c(1, 2, 3, 4, 5)

#Número de municipios no Brasil e por região. Fonte: Anuários Estatístico do Brasil 2017, IBGE.
#c(Norte, Nordeste, Sudeste, Sul, Centro-Oeste, Brasil)
municipios_2007 <- c(449, 1793, 1668, 1188, 466, 5564)
municipios_2008 <- c(449, 1793, 1668, 1188, 466, 5564)
municipios_2009 <- c(449, 1794, 1668, 1188, 466, 5565)
municipios_2010 <- c(449, 1794, 1668, 1188, 466, 5565)
municipios_2011 <- c(449, 1794, 1668, 1188, 466, 5565)
municipios_2012 <- c(449, 1794, 1668, 1188, 466, 5565)
municipios_2013 <- c(450, 1794, 1668, 1191, 467, 5570)
municipios_2014 <- c(450, 1794, 1668, 1191, 467, 5570)
municipios_2015 <- c(450, 1794, 1668, 1191, 467, 5570)
municipios_2016 <- c(450, 1794, 1668, 1191, 467, 5570)
municipios_2017 <- c(450, 1794, 1668, 1191, 467, 5570)
municipios_2018 <- c(450, 1794, 1668, 1191, 467, 5570)
municipios_2019 <- c(450, 1794, 1668, 1191, 467, 5570)
municipios_2020 <- c(450, 1794, 1668, 1191, 467, 5570)
municipios_2021 <- c(450, 1794, 1668, 1191, 467, 5570)
municipios_2022 <- c(450, 1794, 1668, 1191, 467, 5570)

# População dos municípios estimada pelo IBGE
pop_municipios_2016 <- read_excel("../Estimativa População IBGE/estimativa_dou_2016_20160913.xlsx", sheet = "Municípios (limpo)")
pop_municipios_2017 <- read_excel("../Estimativa População IBGE/estimativa_dou_2017.xls", sheet = "Municípios (limpo)")

```


```{r funcoes}

for (i in 1:ncol(cmun_2013)){
 cmun_2013[[i]] = str_trim(str_replace_all(cmun_2013[[i]], pattern = '\"(.*?)\\"', replacement = '\\1'))
}

# Classificação do porte populacional dos municípios.
# Fonte: PNAS 2004
f_porte_populacional = function(df, populacao){
  populacao <- enquo(populacao)

  df %>%
    mutate("Porte" = case_when(!! populacao <= 20000~"Pequeno I",
                               !! populacao <= 50000~"Pequeno II",
                               !! populacao <= 100000~"Médio",
                               !! populacao <= 900000~"Grande",
                               !! populacao > 900000~"Metrópole")) %>%
    mutate(Porte = factor(Porte, levels = c("Pequeno I",
                                            "Pequeno II",
                                            "Médio",
                                            "Grande",
                                            "Metrópole")))
}

f_selecao_regiao_ano_com_na = function(df, q, selecao, regiao, ano){
  q <- enquo(q)
  ano <- quo_name(ano)
  regiao <- enquo(regiao)
  selecao <- quo_name(selecao)

  df %>%
    select(!! regiao, !!q) %>%
    mutate(!! regiao := case_when(substr(!! regiao,1,1) == "1"~"Norte",
                                  substr(!! regiao,1,1) == "2"~"Nordeste",
                                  substr(!! regiao,1,1) == "3"~"Sudeste",
                                  substr(!! regiao,1,1) == "4"~"Sul",
                                  substr(!! regiao,1,1) == "5"~"Centro-Oeste",
                                  TRUE ~ str_replace(!! regiao, "Região ", ""))) %>%
    group_by(!! regiao, !! q) %>%
    summarise(n=n()) %>%
    spread(!! regiao, n, fill = 0) %>%
    mutate("Brasil" = rowSums(.[2:6])) %>%
    gather("Região","n",-!! q) %>%
    group_by(Região) %>%
    mutate("Percentual" = n/sum(n)) %>%
    filter(!! q == !! selecao) %>%
    mutate("Ano" = !! ano)
}

f_selecao_regiao_ano = function(df, q, selecao, regiao, ano){
  q <- enquo(q)
  regiao <- enquo(regiao)

  df %>%
    filter(!is.na(!! q)) %>%
    f_selecao_regiao_ano_com_na(!! q, selecao, !! regiao, ano)
}

f_maior0_regiao_ano = function(df, q, regiao, ano){
  q <- enquo(q)
  regiao <- enquo(regiao)

  df %>%
    mutate(!! q := case_when(!! q > 0~"S",
                             TRUE ~ as.character(!! q))) %>%
    f_selecao_regiao_ano_com_na(!! q, "S", !! regiao, ano)
}

f_quantitativo_regiao_ano = function(df, regiao, ano){
  ano <- quo_name(ano)
  regiao <- enquo(regiao)

  df %>%
    select(!! regiao) %>%
#    filter(!is.na(!! regiao)) %>%
    mutate(!! regiao := case_when(substr(!! regiao,1,1) == "1"~"Norte",
                                  substr(!! regiao,1,1) == "2"~"Nordeste",
                                  substr(!! regiao,1,1) == "3"~"Sudeste",
                                  substr(!! regiao,1,1) == "4"~"Sul",
                                  substr(!! regiao,1,1) == "5"~"Centro-Oeste",
                                  TRUE ~ str_replace(!! regiao, "Região ", ""))) %>%
    group_by(!! regiao) %>%
    summarise(n=n()) %>%
    spread(!! regiao, n, fill = 0) %>%
    mutate("Brasil" = rowSums(.[1:5])) %>%
    gather("Região","n") %>%
    mutate("Ano" = !! ano)
}

f_soma_regiao_ano = function(df, q, regiao, ano){
  q <- enquo(q)
  regiao <- enquo(regiao)
  ano <- quo_name(ano)

  df %>%
    select(!! q, !! regiao) %>%
    mutate(!! regiao := case_when(substr(!! regiao,1,1) == "1"~"Norte",
                                  substr(!! regiao,1,1) == "2"~"Nordeste",
                                  substr(!! regiao,1,1) == "3"~"Sudeste",
                                  substr(!! regiao,1,1) == "4"~"Sul",
                                  substr(!! regiao,1,1) == "5"~"Centro-Oeste",
                                  TRUE ~ str_replace(!! regiao, "Região ", ""))) %>%
    group_by(!! regiao) %>%
    summarise(n=sum(!! q)) %>%
    spread(!! regiao, n, fill = 0) %>%
    mutate("Brasil" = rowSums(.[1:5])) %>%
    gather("Região","n") %>%
    mutate("Ano" = !! ano)
}

f_percentual_municipios_regiao_ano = function(df, municipio, ano){
  ano <- quo_name(ano)
  municipio <- enquo(municipio)

  total_municipios <-case_when(!! ano == "2007"~municipios_2007,
                               !! ano == "2008"~municipios_2008,
                               !! ano == "2009"~municipios_2009,
                               !! ano == "2010"~municipios_2010,
                               !! ano == "2011"~municipios_2011,
                               !! ano == "2012"~municipios_2012,
                               !! ano == "2013"~municipios_2013,
                               !! ano == "2014"~municipios_2014,
                               !! ano == "2015"~municipios_2015,
                               !! ano == "2016"~municipios_2016,
                               !! ano == "2017"~municipios_2017,
                               !! ano == "2018"~municipios_2018,
                               !! ano == "2019"~municipios_2019,
                               !! ano == "2020"~municipios_2020,
                               !! ano == "2021"~municipios_2021,
                               !! ano == "2022"~municipios_2022)

  df %>%
    select(!! municipio) %>%
    distinct(!! municipio) %>%
    mutate(regiao := substr(!! municipio,1,1)) %>%
    select(regiao) %>%
    group_by(regiao) %>%
    summarise(n=n()) %>%
    spread(regiao, n, fill = 0) %>%
    mutate("6" = rowSums(.[1:5])) %>%
    gather("Região","n") %>%
    mutate("Total_municipios" = total_municipios[as.numeric(Região)]) %>%
    mutate("Percentual" = n/Total_municipios) %>%
    mutate(Região = case_when(Região == "1"~"Norte",
                              Região == "2"~"Nordeste",
                              Região == "3"~"Sudeste",
                              Região == "4"~"Sul",
                              Região == "5"~"Centro-Oeste",
                              Região == "6"~"Brasil")) %>%
    mutate("Ano" = !! ano)
}

f_situacao = function(df, situacao){
  situacao <- enquo(situacao)

  df %>%
    mutate(!! situacao := case_when(!! situacao == "próprio da Prefeitura Municipal"~"Próprio",
                                    !! situacao == "Próprio da Prefeitura Municipal"~"Próprio",
                                    !! situacao == "Próprio da Prefeitura Municipal ou do governo do DF"~"Próprio",
                                    !! situacao == "Próprio da Prefeitura Municipal/DF"~"Próprio",
                                    !! situacao == "Próprio do Governo Estadual"~"Próprio",
                                    !! situacao == "alugado pela Prefeitura Municipal"~"Alugado",
                                    !! situacao == "Alugado pela Prefeitura Municipal"~"Alugado",
                                    !! situacao == "Alugado pela Prefeitura Municipal ou pelo governo do DF"~"Alugado",
                                    !! situacao == "Alugado pela Prefeitura Municipal/DF"~"Alugado",
                                    !! situacao == "Alugado pelo Governo Estadual"~"Alugado",
                                    !! situacao == "cedido para a Prefeitura Municipal"~"Cedido",
                                    !! situacao == "Cedido para a Prefeitura Municipal"~"Cedido",
                                    !! situacao == "Cedido para a Prefeitura Municipal ou pelo governo do DF"~"Cedido",
                                    !! situacao == "Cedido para a Prefeitura Municipal/DF por órgãos/unidades públicas"~"Cedido",
                                    !! situacao == "Cedido para a Prefeitura Municipal/DF por entidades/instituições privadas"~"Cedido",
                                    !! situacao == "outro"~"Outro ou não informou",
                                    !! situacao == "Outro"~"Outro ou não informou",
                                    !! situacao == "Outros"~"Outro ou não informou",
                                    is.na(!! situacao)~"Outro ou não informou",
                                    TRUE ~ as.character(!! situacao))) %>%
    mutate(!! situacao := factor(!! situacao, levels = c("Próprio",
                                                         "Alugado",
                                                         "Cedido",
                                                         "Outro ou não informou")))
}

f_acessibilidade = function(df, q){
  q <- enquo(q)

  df %>%
    mutate(!! q := case_when(!! q == "Sim, de acordo com a Norma da ABNT (NBR9050)"~"Sim",
                             !! q == "Sim, de acordo com a Norma da ABNT"~"Sim",
                             !! q == "Sim,de acordo com a Norma da ABNT (NBR9050)"~"Sim",
                             !! q == "Sim, de acordo coma Norma da ABNT (NBR9050)"~"Sim",
                             !! q == "SIM, De acordo com a Norma da ABNT"~"Sim",
                             !! q == "SIM, De acordo com a Norma da ABNT (NBR9050)"~"Sim",
                             !! q == "SIM De acordo com a Norma da ABNT (NBR9050)"~"Sim",
                             !! q == "Sim, de acordo com a norma da ABNT"~"Sim",
                             !! q == "Sim, De acordo com a Norma da ABNT (NBR9050)"~"Sim",
                             !! q == "SIM Mas não estão de acordo com a Norma da ABNT(NBR9050)"~"Sim",
                             !! q == "Sim, mas não estão de acordo com a Norma da ABNT(NBR9050)"~"Sim",
                             !! q == "Sim, mas não estão de acordo com a Norma da ABNT"~"Sim",
                             !! q == "Sim, mas, não estão de acordo com a Norma da ABNT(NBR9050)"~"Sim",
                             !! q == 1~"Sim",
                             TRUE ~ as.character(!! q)))
}

f_tipo_acessibilidade = function(df, cod_categoria){
  cod_categoria <- quo_name(cod_categoria)

  df %>%
    mutate("Categoria" = case_when(!! cod_categoria == "1"~"Acesso principal adaptado com rampas e rota acessível desde a calçada até a recepção",
                                   !! cod_categoria == "2"~"Rota acessível aos espaços (recepção, salas de atendimento e espaços de uso coletivo)",
                                   !! cod_categoria == "3"~"Rota acessível ao banheiro",
                                   !! cod_categoria == "4"~"Banheiro adaptado para pessoas com deficiência"))
}

equip_acessibilidade = function(df, q, ano, cod_categoria){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! q) %>%
    filter(!is.na(!! q)) %>%
    f_acessibilidade(!! q) %>%
    group_by(!! q) %>%
    summarise(n=n()) %>%
    mutate(Percentual = n/sum(n)) %>%
    filter(!! q == "Sim") %>%
    f_tipo_acessibilidade(cod_categoria) %>%
    mutate("Ano" = !! ano)
}



equip_acessibilidade_situacao = function(df, q_situacao, q_acessibilidade, cod_categoria){
  q_situacao <- enquo(q_situacao)
  q_acessibilidade <- enquo(q_acessibilidade)

  df %>%
    select(!! q_situacao, !! q_acessibilidade) %>%
    filter(!is.na(!! q_situacao) & !is.na(!! q_acessibilidade)) %>%
    f_acessibilidade(!! q_acessibilidade) %>%
    f_situacao(!! q_situacao) %>%
    group_by(!! q_situacao, !! q_acessibilidade) %>%
    summarise(n=n()) %>%
    mutate(Percentual = n/sum(n)) %>%
    filter(!! q_acessibilidade == "Sim") %>%
    f_tipo_acessibilidade(cod_categoria) %>%
    mutate("Situacao" = !! q_situacao)
}



f_equip_imovel = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    f_situacao(Nível) %>%
    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    mutate(Percentual = n/sum(n))
}


f_situacao2 = function(df, situacao2){
  situacao2 <- enquo(situacao2)

  df %>%
    mutate(!! Situacao2 := case_when(!! Situacao2 == "Crianças adolescentes"~"Crianças/adolescentes",
                                    !! situacao2 == "Crianças adolescentes"~"Crianças/adolescentes",
                                    !! situacao2 == "Crianças/adolescentes"~"Crianças/adolescentes",
                                    !! situacao2 == "Adultos e famílias em situação de rua e/ou migrantes"~"Adultos e famílias",
                                    !! situacao2 == "Adultos e famílias em situação de rua e ou migrantes"~"Adultos e famílias",
                                    !! situacao2 == "Exclusivamente para pessoas adultas com Deficiência"~"Adultos e famílias",
                                    !! situacao2 == "Adultos e famílias"~"Exclusivamente pessoas adultas com deficiência",
                                    !! situacao2 == "Mulheres em situação de violência doméstica ou familiar"~" Mulheres em situação de violência",
                                    !! situacao2 == "Jovens egressas(os) de serviços de acolhimento"~"Jovens egressos de serviços de acolhimento",
                                    !! situacao2 == "Jovens egressas(os) de serviços de acolhimento"~"Jovens egressos de serviços de acolhimento",
                                    !! situacao2 == "Jovens egressos de serviços de acolhimento"~"Jovens egressos de serviços de acolhimento",
                                    !! situacao2 == "Exclusivamente crianças adolescente com Deficiência"~"Exclusivamente crianças/adolescente com Deficiência",
                                    !! situacao2 == "Pessoas idosas"~"Pessoas idosas",
                                    !! situacao == "Pessoa com deficiência sem critério de idade"~"Outro",
                                    !! situacao == "Usuários de substância psicoativas"~"Outro",
                                    !! situacao == "Substâncias psicoativas"~"Outro",
                                    !! situacao == "Famílias desabrigadas desalojadas"~"Outro",
                                    is.na(!! situacao)~"Outro",
                                    TRUE ~ as.character(!! situacao2))) %>%
    mutate(!! Situacao2 := factor(!! Situacao2, levels = c("Crianças/adolescentes",
                                                         "Adultos e famílias",
                                                        "Exclusivamente pessoas adultas com deficiência",
                                                        "Mulheres em situação de violência",
                                                        "Jovens egressos de serviços de acolhimento",
                                                        "Exclusivamente crianças adolescente com Deficiência",
                                                        "Pessoas idosas",
                                                        "Outro")))

}

f_grupo_media = function(df, q_media, grupo, eixo_x){
  grupo <- quo_name(grupo)
  q_media <- enquo(q_media)
  eixo_x <- quo_name(eixo_x)

  df %>%
    select(!! q_media) %>%
    filter(!is.na(!! q_media)) %>%
    summarise(m=mean(!! q_media)) %>%
    mutate("Eixo_X" = !! eixo_x) %>%
    mutate("Grupo" = !! grupo)
}

f_situacao3 = function(df, situacao3){
  situacao <- enquo(situacao)

  df %>%
    mutate(!! situacao3 := case_when(!! situacao3 == "Sim, com equipe exclusiva para esta finalidade"~"sim",
                                    !! situacao3 == "Sim, com a equipe responsável pelo PAIF"~"sim",
                                    !! situacao3 == "Sim, com equipe exclusiva para esta finalidade"~"sim",
                                    !! situacao3 == "Não"~"Não",
                                    is.na(!! situacao3)~"Não",
                                    TRUE ~ as.character(!! situacao3))) %>%
    mutate(!! situacao3 := factor(!! situacao, levels = c("sim",
                                                          "Não")))
}

f_quantitativo_niveis = function(df, q_grupo, eixo_x, niveis){
  q_grupo <- enquo(q_grupo)
  eixo_x <- quo_name(eixo_x)

  df %>%
    select(!! q_grupo) %>%
    mutate(!! q_grupo := factor(!! q_grupo, levels = niveis)) %>%
    count(!! q_grupo, name = "n", .drop = F) %>%
    mutate("Eixo_X" = !! eixo_x) %>%
    mutate("Grupo" = !! q_grupo)
}

f_sim_nao  = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == "Não possui"~"Não",
                             Nível == "sim"~"Sim",
                             Nível == "não"~"Não",
                             Nível == "Não Sabe"~"Não sabe",
                             Nível == "99" ~ "Não sabe",
                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("Sim",
                                            "Não",
                                            "Não sabe"))) %>%
    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n))
}

f_nomex_somay_nomegrupo = function(df, nomex, somay, nomegrupo){
  nomex <- quo_name(nomex)
  somay <- enquo(somay)
  nomegrupo <- quo_name(nomegrupo)

  df %>%
    select(!! nomex := !! somay) %>%
    gather("Eixo_x","Eixo_y") %>%
#    filter(!is.na(Nível)) %>%
    group_by(Eixo_x) %>%
    summarise(Eixo_y = sum(Eixo_y)) %>%
    mutate("Grupo" = !! nomegrupo)
}

f_calcula_percentual  = function(df, grupo_percentual, item_percentual, n){
  grupo_percentual <- enquo(grupo_percentual)
  item_percentual <- enquo(item_percentual)
  n <- enquo(n)

  df %>%
    mutate(!! grupo_percentual := as_factor(!! grupo_percentual)) %>%
    mutate(!! item_percentual := as_factor(!! item_percentual)) %>%
    group_by(!! grupo_percentual) %>%
    mutate(Percentual = !! n/sum(!! n))
}

f_nomex_grupos_quantitativo = function(df, nomex, grupos){
  nomex <- quo_name(nomex)
  grupos <- enquo(grupos)

  df %>%
    select("Grupo" = !! grupos) %>%
    group_by(Grupo) %>%
    summarise("Eixo_y"=n()) %>%
    mutate("Eixo_x" = !! nomex)
}

f_nivel_ensino = function(df, nivel_ensino){
  nivel_ensino <- enquo(nivel_ensino)

  df %>%
    mutate(!! nivel_ensino := case_when(!! nivel_ensino == "Nível fundamental"~"Nível Fundamental",
                                        TRUE ~ !! nivel_ensino))
}

f_grafico_col_numero = function(df, x, y){
  x <- enquo(x)
  y <- enquo(y)

  df %>%
    ggplot(aes(x = !! x, y = !! y)) +
    geom_col(aes(fill = !! y), position="dodge") +
    geom_text(aes(label = format(!! y, big.mark=".", digits = 3, decimal.mark = ",")),
              vjust = -0.5,
              position = position_dodge(width = 0.9)) +
    scale_y_continuous(expand = expand_scale(mult = c(0, .15))) +
    theme(legend.position="none",
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.y = element_blank(),
          axis.line.x = element_line(),
          panel.background = element_blank())
}

f_grafico_col_group_numero = function(df, x, y, grupo, legend_nrow){
  x <- enquo(x)
  y <- enquo(y)
  grupo <- enquo(grupo)

  df %>%
    ggplot(aes(x = !! x, y = !! y, group = !! grupo)) +
    geom_col(aes(fill = !! grupo), position="dodge") +
    geom_text(aes(label = format(!! y, big.mark=".", digits = 3, decimal.mark = ",")),
              hjust = -0.01,
              position = position_dodge(width = 0.9),
              angle = 90) +
    scale_y_continuous(expand = expand_scale(mult = c(0, .15))) +
    theme(legend.position="bottom",
          legend.title = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.y = element_blank(),
          axis.line.x = element_line(),
          panel.background = element_blank()) +
    guides(fill=guide_legend(nrow=legend_nrow,byrow=TRUE))
}

f_grafico_col_numero_flip = function(df, x, y, grupo){
  x <- enquo(x)
  y <- enquo(y)
  grupo <- enquo(grupo)

  df %>%
    ggplot(aes(x = !! x, y = !! y, group = fct_rev(!! grupo))) +
    geom_col(aes(fill = !! grupo), position = "dodge") +
    geom_text(aes(label = format(!! y, big.mark=".", digits = 3, decimal.mark = ",")),
              hjust = -0.5,
              position = position_dodge(width = 0.9)) +
    scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
    coord_flip() +
    theme(legend.position="bottom",
          legend.title = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.line.y = element_line(),
          panel.background = element_blank()) +
    guides(fill=guide_legend(nrow=1, byrow=TRUE))
}

f_grafico_col_percent = function(df, x, y){
  x <- enquo(x)
  y <- enquo(y)

  df %>%
    mutate(precisao = ifelse(!! y < 0.0995, 0.1, 1)) %>%
    ggplot(aes(x = !! x, y = !! y)) +
    geom_col(aes(fill = !! y), position = "dodge") +
    geom_text(aes(label = label_percent(accuracy = precisao, decimal.mark = ",")(!! y)),
              vjust = -0.5,
              position = position_dodge(width = 0.9)) +
    scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
    theme(legend.position="none",
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.y = element_blank(),
          axis.line.x = element_line(),
          panel.background = element_blank())
}

f_grafico_col_group_percent = function(df, x, y, grupo, legend_nrow){
  x <- enquo(x)
  y <- enquo(y)
  grupo <- enquo(grupo)

  df %>%
    mutate(precisao = ifelse(!! y < 0.0995, 0.1, 1)) %>%
    ggplot(aes(x = !! x, y = !! y, group = !! grupo)) +
    geom_col(aes(fill = !! grupo), position = "dodge") +
    geom_text(aes(label = label_percent(accuracy = precisao, decimal.mark = ",")(!! y)),
#              vjust = -0.2,
              hjust = -0.01,
              position = position_dodge(width = 0.9),
              angle = 90) +
    scale_y_continuous(expand = expand_scale(mult = c(0, .16))) +
    theme(legend.position="bottom",
          legend.title = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.y = element_blank(),
          axis.line.x = element_line(),
          panel.background = element_blank()) +
    guides(fill=guide_legend(nrow=legend_nrow, byrow=TRUE))
}

f_grafico_col_percent_flip = function(df, x, y, grupo, legend_nrow){
  x <- enquo(x)
  y <- enquo(y)
  grupo <- enquo(grupo)

  df %>%
    mutate(precisao = ifelse(!! y < 0.0995, 0.1, 1)) %>%
    ggplot(aes(x = !! x, y = !! y, group = fct_rev(!! grupo))) +
    geom_col(aes(fill = !! grupo), position = "dodge") +
    geom_text(aes(label = label_percent(accuracy = precisao, decimal.mark = ",")(!! y)),
              hjust = -0.05,
              position = position_dodge(width = 0.9)) +
    scale_y_continuous(expand = expand_scale(mult = c(0, .15))) +
    coord_flip() +
    theme(legend.position="bottom",
          legend.title = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.line.y = element_line(),
          panel.background = element_blank()) +
    guides(fill=guide_legend(nrow=legend_nrow, byrow=TRUE))
}

f_grafico_col_stack_percent = function(df, x, y, grupo, legend_nrow){
  x <- enquo(x)
  y <- enquo(y)
  grupo <- enquo(grupo)

  df %>%
    mutate(precisao = ifelse(!! y < 0.0995, 0.1, 1)) %>%
    ggplot(aes(x = !! x, y = !! y, group = !! grupo)) +
    geom_col(aes(fill = !! grupo), position = position_stack(reverse = TRUE)) +
    geom_text_repel(aes(label = ifelse(!! y > 0.0005, label_percent(accuracy = precisao, decimal.mark = ",")(!! y), "")),
                    position = position_stack(reverse = TRUE, vjust = .5),
                    point.size = NA) +
    scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
    theme(legend.position="bottom",
          legend.title = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.y = element_blank(),
          axis.line.x = element_line(),
          panel.background = element_blank()) +
    guides(fill=guide_legend(nrow=legend_nrow,byrow=TRUE))
}

f_grafico_col_stack_percent_flip = function(df, x, y, grupo, legend_nrow){
  x <- enquo(x)
  y <- enquo(y)
  grupo <- enquo(grupo)

  df %>%
    mutate(precisao = ifelse(!! y < 0.0995, 0.1, 1)) %>%
    ggplot(aes(x = !! x, y = !! y)) +
    geom_col(aes(fill = !! grupo), position = position_stack(reverse = TRUE)) +
    geom_text(aes(label = ifelse(!! y > 0.0005, label_percent(accuracy = precisao, decimal.mark = ",")(!! y), "")),
              position = position_stack(reverse = TRUE, vjust = .5)) +
    scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
    coord_flip() +
    theme(legend.position="bottom",
          legend.title = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.line.y = element_line(),
          panel.background = element_blank()) +
    guides(fill=guide_legend(nrow=legend_nrow,byrow=TRUE))
}

f_grafico_col_stack_percent_flip_repel = function(df, x, y, grupo){
  x <- enquo(x)
  y <- enquo(y)
  grupo <- enquo(grupo)

  df %>%
    mutate(precisao = ifelse(!! y < 0.0995, 0.1, 1)) %>%
    ggplot(aes(x = !! x, y = !! y)) +
    geom_col(aes(fill = !! grupo), position = position_stack(reverse = TRUE)) +
    geom_text_repel(aes(label = ifelse(!! y > 0.0005, label_percent(accuracy = precisao, decimal.mark = ",")(!! y), "")),
                    position = position_stack(reverse = TRUE, vjust = .5),
                    point.size = NA) +
    scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
    coord_flip() +
    theme(legend.position="bottom",
          legend.title = element_blank(),
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          axis.line.y = element_line(),
          panel.background = element_blank())
}

```

# Gestão e Financiamento

O Sistema Único de Assistência Social (SUAS) é definido pela Lei Orgânica da Assistência Social (LOAS)\footnote{Lei nº 8.742, de 7 de dezembro de 1993: Dispõe sobre a organização da Assistência Social e dá outras providências. (\url{http://www.planalto.gov.br/ccivil_03/Leis/L8742compilado.htm})} como um sistema descentralizado e participativo que organiza a gestão das ações na área de assistência social, a partir das diretrizes: descentralização político administrativa, participação social e primazia da responsabilidade do Estado na condução da política de assistência social. Assim, tem como um de seus objetivos a consolidação da gestão compartilhada dos os três entes federados.

A LOAS, a NOB SUAS\footnote{Norma Operacional Básica NOB - SUAS 2012 (\url{http://www.mds.gov.br/webarquivos/arquivo/assistencia_social/nob_suas.pdf})} e outros normativos que regulam a assistência social definem as responsabilidades da União, Estados, Distrito Federal e Municípios no âmbito da gestão compartilhada, que incluem o cofinanciamento de serviços, programas e ações da assistência social. Estão previstas ainda instâncias de pactuação e interlocução entre os três entes federados: a Comissão Intergestores Bipartite (CIB), da qual participam representantes de estados e municípios, e a Comissão Intergestores Tripartite (CIT), da qual participam, além de estados e municípios, representantes do governo federal.

A partir das informações contidas no Censo SUAS é possível ter um panorama geral da gestão e do financiamento em estados e municípios, com a observação de aspectos como a estrutura administrativa da gestão da assistência social, a atualização de normativos, o apoio de estados aos municípios, as atividades de cofinanciamento e transferência de recursos, funcionamento das instâncias de pactuação, entre outras. Nesse sentido, esta seção apresenta os principais resultados obtidos a partir das informações dos questionários de gestão estadual e gestão municipal.

A estrutura administrativa na Política de Assistência Social e Constituição de areas essenciais são elementos importantes para gestão do SUAS. No ambito da gestão estadual, no que se refere a exclusividade da area de Assistência Social, percebe-se que nos últimos 10 anos houve uma redução de areas específicas de Assistencia Social. Em 2012 existiam 29,6% \footnote{Estados: Amazonas, Acre, Pará, Amapá, Piauí, Paraíba, Sergipe e São Paulo} das secretarias estaduais exclusivas de Assistência Social, em 2022 esse número passa para 3,8%, \footnote{Estado do Amazonas} redução significativa de 87,2% Conforme a \Cref{fig:estados_sec_exc},

```{r estados_sec_exc, fig.cap = "Percentual de Estados quanto a caracteristica de estrutura administrativa, 2012 a 2022 - Brasil", fig.footer = "Fonte: MDS, Censo SUAS"}

estados_sec_exc  = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == "Secretaria estadual exclusiva da área de Assistência Social"~"Secretaria estadual exclusiva da área de Assistência Social",
                             Nível == "Secretaria estadual exclusiva da Área de Assistência Social"~"Secretaria estadual exclusiva da área de Assistência Social",
                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("Secretaria estadual exclusiva da área de Assistência Social",
                                            "Secretaria estadual em conjunto com outras políticas setoriais"))) %>%

    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n))
}

grafico <- estados_sec_exc(ge_2012, q1, "2012") %>%
  bind_rows(estados_sec_exc(ge_2013, q1, "2013")) %>%
  bind_rows(estados_sec_exc(ge_2014, q1, "2014")) %>%
  bind_rows(estados_sec_exc(ge_2015, q1, "2015")) %>%
  bind_rows(estados_sec_exc(ge_2016, q1, "2016")) %>%
  bind_rows(estados_sec_exc(ge_2017, q1, "2017")) %>%
  bind_rows(estados_sec_exc(ge_2018, q_1,"2018")) %>%
  bind_rows(estados_sec_exc(ge_2019, q1, "2019")) %>%
  bind_rows(estados_sec_exc(ge_2020, q1, "2020")) %>%
  bind_rows(estados_sec_exc(ge_2021, q1, "2021")) %>%
  bind_rows(estados_sec_exc(ge_2022, q1, "2022")) %>%

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 2)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r estados-caracteristica-secretaria-2022, fig.cap = "Percentual de Secretarias Estaduais de acordo com composição administrativa relacionada a outras políticas - Brasil, 2022", fig.footer = "Fonte: MDS, Censo SUAS.", eval=FALSE}

nao0_sim1 = function(df, q){
  q <- enquo(q)

  df %>%
    mutate(!! q := case_when(!! q == "Não"~0, !! q == "Sim"~1))
}

grafico <- ge_2022 %>%
  select(q1,q2_1,q2_2,q2_3,q2_4,q2_5,q2_6,q2_7,q2_99) %>%
  filter(!is.na(q1)) %>%
  nao0_sim1(q2_1) %>%
  nao0_sim1(q2_2) %>%
  nao0_sim1(q2_3) %>%
  nao0_sim1(q2_4) %>%
  nao0_sim1(q2_5) %>%
  nao0_sim1(q2_6) %>%
  nao0_sim1(q2_7) %>%
  nao0_sim1(q2_99) %>%
  mutate(q2=q2_1+q2_2+q2_3+q2_4+q2_5+q2_6+q2_7+q2_99) %>%
  group_by(q1,q2) %>%
  summarise(n=n()) %>%
  ungroup() %>%
  mutate(q1=case_when(q2==1~"Secretaria estadual em conjunto com uma política setorial",
                      q2==2~"Secretaria estadual em conjunto com duas políticas setoriais",
                      q2==3~"Secretaria estadual em conjunto com três políticas setoriais",
                      q2==4~"Secretaria estadual em conjunto com quatro políticas setoriais",
                      q2>=5~"Secretaria estadual em conjunto com cinco ou mais políticas setoriais",
                      TRUE ~ q1)) %>%
  mutate(q2=case_when(is.na(q2)~0, TRUE~q2)) %>%
  group_by(q1,q2) %>%
  summarise(n=sum(n)) %>%
  ungroup() %>%
  mutate(per=`n`/sum(`n`)) %>%
  arrange(q2) %>%
  mutate(q1=str_wrap(q1,width=35)) %>%
  mutate(q1=factor(q1, levels=q1)) %>%
  ggplot(aes(x="", y=per, fill=q1)) +
  geom_bar(stat="identity") +
#  geom_text(aes(label = percent(per)), position = position_stack(vjust = 0.5))  +
  geom_text(aes(label = label_percent(accuracy = 0.1, decimal.mark = ",")(per)), position = position_stack(vjust = 0.5)) +
  coord_polar(theta = "y", direction = -1) +
  theme_void() +
  theme(legend.title = element_blank(),
        legend.key.size = unit(2, 'lines'))

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos")
```

```{r estados-caracteristica-secretaria-2012, fig.cap = "Percentual de Secretarias Estaduais de acordo com composição administrativa relacionada a outras políticas - Brasil, 2012", fig.footer = "Fonte: MDS, Censo SUAS", eval=FALSE}

nao0_sim1 = function(df, q){
  q <- enquo(q)

  df %>%
    mutate(!! q := case_when(!! q == "Não"~0, !! q == "Sim"~1))
}

grafico <- ge_2012 %>%
  select(q1,q2_1,q2_2,q2_3,q2_4,q2_5,q2_6,q2_7,q2_8) %>%
  filter(!is.na(q1)) %>%
  nao0_sim1(q2_1) %>%
  nao0_sim1(q2_2) %>%
  nao0_sim1(q2_3) %>%
  nao0_sim1(q2_4) %>%
  nao0_sim1(q2_5) %>%
  nao0_sim1(q2_6) %>%
  nao0_sim1(q2_7) %>%
  nao0_sim1(q2_8) %>%
  mutate(q2=q2_1+q2_2+q2_3+q2_4+q2_5+q2_6+q2_7+q2_8) %>%
  group_by(q1,q2) %>%
  summarise(n=n()) %>%
  ungroup() %>%
  mutate(q1=case_when(q2==1~"Secretaria estadual em conjunto com uma política setorial",
                      q2==2~"Secretaria estadual em conjunto com duas políticas setoriais",
                      q2==3~"Secretaria estadual em conjunto com três políticas setoriais",
                      q2==4~"Secretaria estadual em conjunto com quatro políticas setoriais",
                      q2>=5~"Secretaria estadual em conjunto com cinco ou mais políticas setoriais",
                      TRUE ~ q1)) %>%
  mutate(q2=case_when(is.na(q2)~0, TRUE~q2)) %>%
  group_by(q1,q2) %>%
  summarise(n=sum(n)) %>%
  ungroup() %>%
  mutate(per=`n`/sum(`n`)) %>%
  arrange(q2) %>%
  mutate(q1=str_wrap(q1,width=35)) %>%
  mutate(q1=factor(q1, levels=q1)) %>%
  ggplot(aes(x="", y=per, fill=q1)) +
  geom_bar(stat="identity") +
#  geom_text(aes(label = percent(per)), position = position_stack(vjust = 0.5))  +
  geom_text(aes(label = label_percent(accuracy = 0.1, decimal.mark = ",")(per)), position = position_stack(vjust = 0.5)) +
  coord_polar(theta = "y", direction = -1) +
  theme_void() +
  theme(legend.title = element_blank(),
        legend.key.size = unit(2, 'lines'))

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos")
```

No que se refere aos municípios, esse cenário nacional se configurou inverso ao das gestões Estaduais. Observa-se através (\Cref{fig:sec-munic-exc}) um aumento de 217 municípios (1,5 pontos percentuais) com secretarias exclusivas de Assistência Social do período de 2012 a 2019. \footnote{a partir de 2019 essa pergunta foi retirada do formulário de gestão municipal}.

```{r sec-munic-exc, fig.cap = "Percentual de Secretarias Municipais exclusivas de Assistência Social - Brasil, 2012 a 2019", fig.footer = "Fonte: MDS, Censo SUAS"}

sec_munic_exc  = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == "Secretaria municipal exclusiva da área de Assistência Social"~"Secretaria municipal exclusiva da área de Assistência Social",
                             Nível == "Setor/Coordenadoria/Assessoria subordinado diretamente ao Gabinete do(a) Prefeito(a)"~"Setor/Coordenadoria/Assessoria subordinado diretamente ao Gabinete do(a) Prefeito(a)|",
                             Nível == "Setor subordinado diretamente à chefia do Executivo"~"Setor/Coordenadoria/Assessoria subordinado diretamente ao Gabinete do(a) Prefeito(a)|",
                             Nível == "Setor subordinado a outra secretaria"~"Secretaria municipal em conjunto com outras políticas setoriais",

                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("Secretaria municipal exclusiva da área de Assistência Social",
                            "Setor/Coordenadoria/Assessoria subordinado diretamente ao Gabinete do(a) Prefeito(a)|",
                                            "Fundação Pública",
                                            "Secretaria municipal em conjunto com outras políticas setoriais"))) %>%

    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n))
}

grafico <- sec_munic_exc(gm_2012, q1, "2012") %>%
bind_rows(sec_munic_exc(gm_2013, q1, "2013")) %>%
bind_rows(sec_munic_exc(gm_2014, q1, "2014")) %>%
bind_rows(sec_munic_exc(gm_2015, q1, "2015")) %>%
bind_rows(sec_munic_exc(gm_2016, q1, "2016")) %>%
bind_rows(sec_munic_exc(gm_2017, q1, "2017")) %>%
bind_rows(sec_munic_exc(gm_2018, q_1,"2018")) %>%
bind_rows(sec_munic_exc(gm_2019, q1, "2019")) %>%

# essa pergunta foi feita até 2019, após não se colocou mais

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 4)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r secretarias-municipais-exclusivas, fig.cap = "Percentual de Secretarias Municipais exclusivas de Assistência Social, segundo grandes regiões – Brasil, 2012 - 2017 e 2022", fig.footer = "Fonte: MDS, Censo SUAS.",eval=FALSE}

#grafico <- f_selecao_regiao_ano(gm_2010, q1, "Secretaria municipal exclusiva da área de Assistência Social", Região, "2010") %>%
#  bind_rows(f_selecao_regiao_ano(gm_2011, q1, "Secretaria Municipal exclusiva da área de Assistência Social", Região, "2011")) %>%
grafico <- f_selecao_regiao_ano(gm_2012, q1, "Secretaria municipal exclusiva da área de Assistência Social", Região, "2012") %>%
#  bind_rows(f_selecao_regiao_ano(gm_2013, q1, "Secretaria municipal exclusiva da área de Assistência Social", Região, "2013")) %>%
#  bind_rows(f_selecao_regiao_ano(gm_2014, q1, "Secretaria municipal exclusiva da área de Assistência Social", Região, "2014")) %>%
#  bind_rows(f_selecao_regiao_ano(gm_2015, q1, "Secretaria municipal exclusiva da área de Assistência Social", Região, "2015")) %>%
#  bind_rows(f_selecao_regiao_ano(gm_2016, q1, "Secretaria municipal exclusiva da área de Assistência Social", Região, "2016")) %>%
  bind_rows(f_selecao_regiao_ano(gm_2017, q1, "Secretaria municipal exclusiva da área de Assistência Social", Região, "2017")) %>%
  bind_rows(f_selecao_regiao_ano(gm_2019, q1, "Secretaria municipal exclusiva da área de Assistência Social", Região, "2019")) %>%

# essa pergunta foi feita até 2019, após não se colocou mais

  ggplot(aes(x = Região, y = Percentual, group = Ano)) +
  geom_col(aes(fill = Ano), position="dodge") +
#  geom_text(aes(label = percent(Percentual), y=Percentual+.05), position = position_dodge(width = 0.9), angle = 90) +
  geom_text(aes(label = label_percent(accuracy = 0.1, decimal.mark = ",")(Percentual), y=Percentual+.05), position = position_dodge(width = 0.9), angle = 90) +
  scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
  theme(legend.position="bottom",
        legend.title = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text.y = element_blank(),
        axis.line.x = element_line(),
        panel.background = element_blank()) +
  guides(fill=guide_legend(nrow=1,byrow=TRUE))

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Alguns órgãos gestores estaduais constituíram as áreas de assistência social como subdivisões administrativas em sua estrutura, como superintendências, departamentos, gerências, coordenações, dentre outras. De acordo com o último Pacto de aprimoramento Estadual do SUAS\footnote{Resolução CNAS Nº2, de 16 de março de 2017} umas das prioridades para o aperfeiçoamento institucional é possuir na estrutura administrativa das seguintes areas:

1)  Proteção Social Básica;
2)  Proteção Social Especial de Média e Alta Complexidade;
3)  Gestão do SUAS, com suas subdivisões de Vigilância Socioassistencial, Regulação do SUAS e Gestão do Trabalho; e
4)  Gestão do Fundo Estadual de Assistência Social - FEAS.

Observa-se avanço em todas as areas formalmente nos últimos 10 anos. As três áreas mais instituídas são: Proteção Social Básica, Proteção Social Especial com 88,46% e Gestão do SUAS com 84,62% \Cref{fig:uf_subd}.

```{r uf_subd, fig.cap = "Percentual segundo estrutura administrativa formal da Secretaria Estadual de Assistência Social - Brasil, 2012 - 2017 - 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

uf_subd= function(df, q, ano, cod_categoria){
  q <- enquo(q)
  ano <- quo_name(ano)
  cod_categoria <- quo_name(cod_categoria)


  categoria <- case_when(!! cod_categoria == "1"~"Gestão do SUAS",
                         !! cod_categoria == "2"~"Vigilância Socioassistencial (inclusive áreas de monitoramento e avaliação)",
                         !! cod_categoria == "3"~"Gestão do Trabalho",
                         !! cod_categoria == "4"~"Gestão Financeira e Orçamentária",
                         !! cod_categoria == "5"~"Proteção Social Básica",
                         !! cod_categoria == "6"~"Proteção Social Especial",
                         !! cod_categoria == "7"~"Gestão de Benefícios Assistenciais (BPC, Benefícios Eventuais",
                         !! cod_categoria == "8"~"Gestão do Cadastro Único e Programa Bolsa Família",
                         !! cod_categoria == "9"~"Regulação do SUAS")


 # não conseguir colocar a de maneira informal

  df %>%
    select(!! q) %>%
    filter(!is.na(!! q)) %>%
    group_by(!! q) %>%
    summarise(n=n()) %>%
    mutate(Percentual = n/sum(n)) %>%
    filter(!! q == "Sim, na estrutura formal do órgão gestor") %>%
    mutate("Categoria" = categoria, "Ano" = !! ano)

  }

 tabela <- uf_subd(ge_2012,q5_5,"2012","1") %>%
   bind_rows(uf_subd(ge_2012,q5_8,"2012","2")) %>%
   bind_rows(uf_subd(ge_2012,q5_7,"2012","3")) %>%
   bind_rows(uf_subd(ge_2012,q5_6,"2012","4")) %>%
   bind_rows(uf_subd(ge_2012,q5_1,"2012","5")) %>%
   bind_rows(uf_subd(ge_2012,q5_2,"2012","6")) %>%
   bind_rows(uf_subd(ge_2012,q5_4,"2012","7")) %>%


  bind_rows(uf_subd(ge_2017,q3_1,"2017","1")) %>%
  bind_rows(uf_subd(ge_2017,q3_2,"2017","2")) %>%
  bind_rows(uf_subd(ge_2017,q3_3,"2017","3")) %>%
  bind_rows(uf_subd(ge_2017,q3_5,"2017","4")) %>%
  bind_rows(uf_subd(ge_2017,q3_6,"2017","5")) %>%
  bind_rows(uf_subd(ge_2017,q3_7,"2017","6")) %>%
  bind_rows(uf_subd(ge_2017,q3_9,"2017","7")) %>%
  bind_rows(uf_subd(ge_2017,q3_8,"2017","8")) %>%
  bind_rows(uf_subd(ge_2017,q3_4,"2017","9")) %>%


  bind_rows(uf_subd(ge_2022,q3_1,"2022","1")) %>%
  bind_rows(uf_subd(ge_2022,q3_2,"2022","2")) %>%
  bind_rows(uf_subd(ge_2022,q3_3,"2022","3")) %>%
  bind_rows(uf_subd(ge_2022,q3_5,"2022","4")) %>%
  bind_rows(uf_subd(ge_2022,q3_6,"2022","5")) %>%
  bind_rows(uf_subd(ge_2022,q3_7,"2022","6")) %>%
  bind_rows(uf_subd(ge_2022,q3_9,"2022","7")) %>%
  bind_rows(uf_subd(ge_2022,q3_8,"2022","8")) %>%
  bind_rows(uf_subd(ge_2022,q3_4,"2022","9")) %>%



  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=51))

ordenado<-tabela %>%
  filter(Ano == "2022") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  f_grafico_col_percent_flip(Categoria, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r estados-constituicao-subdivisoes_2012, fig.cap = "Percentual de estados segundo característica da estrutura administrativa da Secretaria Estadual de Assistência Social - Brasil,  2012", fig.footer = "Fonte: MDS, Censo SUAS", eval=FALSE}

tabela<-ge_2012 %>%
# Questionário 2022:
  select("Gestão do SUAS"=q5_5,
         "Vigilância Socioassistencial (inclusive áreas de monitoramento e avaliação)"=q5_8,
         "Gestão do Trabalho"=q5_7,
         "Gestão Financeira e Orçamentária"=q5_6,
         "Proteção Social Básica"=q5_1,
         "Proteção Social Especial"=q5_2,
         "Gestão de Benefícios Assistenciais (BPC, Benefícios Eventuais"=q5_4) %>%

#-------------------
  gather("Categoria","Nível") %>%
  mutate(Categoria=str_wrap(Categoria,width=39)) %>%
  mutate(Nível = case_when(Nível=="Sim, na estrutura formal do órgão gestor"~"Constituída formalmente",
                           Nível=="Sim, de maneira informal"~"Constituída informalmente",
                           TRUE ~ Nível)) %>%
  group_by(Categoria, Nível) %>%
  summarise(n=n()) %>%
  group_by(Categoria) %>%
  mutate(Percentual = n/sum(n), Posição = (cumsum(n/sum(n)) - 0.5 * n/sum(n)))

ordenado<-tabela %>%
  filter(Nível == "Constituída formalmente") %>%
  arrange(Percentual) %>%
  select(Categoria)

ordenado<-factor(ordenado, levels = ordenado$Categoria)

grafico<-tabela %>%
  ungroup() %>%
  mutate(Categoria = factor(Categoria, levels = levels(ordenado))) %>%
  mutate(Nível=str_wrap(Nível,width=22)) %>%
  ggplot(aes(x = Categoria, y = Percentual)) +
  geom_col(aes(fill = Nível), position = position_stack(reverse = TRUE)) +
  geom_text(aes(y=Posição, label = percent(Percentual))) +
  scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
  coord_flip() +
  theme(legend.position="bottom",
        legend.title = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text.x = element_blank(),
        axis.line.y = element_line(),
        panel.background = element_blank())

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)

```

Quando se observa a regularização destas areas, há um grupo instituídas informalmente conforme \Cref{fig:estados-constituicao-subdivisoes}, e setores que ainda não estão consituídos em 100% dos estados, a saber Gestão do SUAS, Gestão do trabalho e regulação do SUAS.

```{r estados-constituicao-subdivisoes, fig.cap = "Percentual de estados segundo característica da estrutura administrativa da Secretaria Estadual de Assistência Social - Brasil,  2022", fig.footer = "Fonte: MDS, Censo SUAS."}

tabela<-ge_2022 %>%
# Questionário 2022:
  select("Gestão do SUAS"=q3_1,
         "Vigilância Socioassistencial (inclusive áreas de monitoramento e avaliação)"=q3_2,
         "Gestão do Trabalho"=q3_3,
         "Regulação do SUAS"=q3_4,
         "Gestão Financeira e Orçamentária"=q3_5,
         "Proteção Social Básica"=q3_6,
         "Proteção Social Especial"=q3_7,
         "Gestão do Cadastro Único e Programa Bolsa Família"=q3_8,
         "Gestão de Benefícios Assistenciais (BPC, Benefícios Eventuais)"=q3_9,
         "Programa Criança Feliz"=q3_10) %>%

#-------------------
  gather("Categoria","Nível") %>%
  mutate(Categoria=str_wrap(Categoria,width=39)) %>%
  mutate(Nível = case_when(Nível=="Sim, na estrutura formal do órgão gestor"~"Constituída formalmente",
                           Nível=="Sim, de maneira informal"~"Constituída informalmente",
                           TRUE ~ Nível)) %>%
  group_by(Categoria, Nível) %>%
  summarise(n=n()) %>%
  group_by(Categoria) %>%
  mutate(Percentual = n/sum(n))

ordenado<-tabela %>%
  filter(Nível == "Constituída formalmente") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  ungroup() %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  mutate(Nível=str_wrap(Nível,width=22)) %>%
  f_grafico_col_stack_percent_flip(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

No que se refere aos municípios, a última pactuação sobre estrutura administrativa a partir dos portes populacionais dos municípios\footnote{124ª reunião ordinária da CIT - Pacto de Aprimoramento do SUAS} prevê:

-   **municípios de pequeno I e II e médio porte:** 100% dos municípios com instituição formal, na estrutura do órgão gestor de assistência social, as áreas constituídas de Proteção Social Básica, Proteção Social Especial e a área de Gestão do SUAS com competência de Vigilância Socioassistencial.

-   **municípios de grande porte e metrópole:** 100% dos muncípios com instituição formal, na estrutura do órgão gestor de assistência social, áreas constituídas de Proteção Social Básica, Proteção Social Especial, com subdivisão de Média e Alta Complexidade, Gestão Financeira e Orçamentária, Gestão de Benefícios Assistenciais e Transferência de Renda, área de Gestão do SUAS com competência de: Gestão do Trabalho, Regulação do SUAS e Vigilância Socioassistencial.

A \Cref{fig:munic_sub} mostra crescimento formal de todas as areas administrativas. As areas do SUAS com maior percentual de constituição formal \footnote{A
regulamentação destas areas essenciais devem estar previstas no
organograma. A Lei do SUAS Lei nº 12.435, de 06/07/2011 altera a Lei Organiza da Assistência
Social (LOAS) - nº 8.742, de 07/.12.1993} que dispõe sobre esta organização são respectivamente: Gestão do Cadastro Único e Bolsa Família, Gestão da Proteção Social Básica e Gestão do SUAS.

```{r munic_sub, fig.cap = "Percentual segundo estrutura administrativa formal da Secretaria Municipal de Assistência Social - Brasil, 2012 - 2017 - 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

munic_sub= function(df, q, ano, cod_categoria){
  q <- enquo(q)
  ano <- quo_name(ano)
  cod_categoria <- quo_name(cod_categoria)


  categoria <- case_when(!! cod_categoria == "1"~"Gestão do SUAS",
                         !! cod_categoria == "2"~"Vigilância Socioassistencial (inclusive áreas de monitoramento e avaliação)",
                         !! cod_categoria == "3"~"Gestão do Trabalho",
                         !! cod_categoria == "4"~"Gestão Financeira e Orçamentária",
                         !! cod_categoria == "5"~"Proteção Social Básica",
                         !! cod_categoria == "6"~"Proteção Social Especial",
                         !! cod_categoria == "7"~"Gestão de Benefícios Assistenciais (BPC, Benefícios Eventuais",
                         !! cod_categoria == "8"~"Gestão do Cadastro Único e Programa Bolsa Família",
                         !! cod_categoria == "9"~"Regulação do SUAS")


 # não conseguir colocar a de maneira informal

  df %>%
    select(!! q) %>%
    filter(!is.na(!! q)) %>%
    group_by(!! q) %>%
    summarise(n=n()) %>%
    mutate(Percentual = n/sum(n)) %>%
    filter(!! q == "Sim, na estrutura formal do órgão gestor") %>%
    mutate("Categoria" = categoria, "Ano" = !! ano)

  }

 tabela <- munic_sub(gm_2012,q3f,"2012","1") %>%
   bind_rows(munic_sub(gm_2012,q3i,"2012","2")) %>%
   #bind_rows(munic_sub(gm_2012,q3j,"2012","2")) %>%
   bind_rows(munic_sub(gm_2012,q3g,"2012","3")) %>%
   bind_rows(munic_sub(gm_2012,q3c,"2012","4")) %>%
   bind_rows(munic_sub(gm_2012,q3a,"2012","5")) %>%
   bind_rows(munic_sub(gm_2012,q3b,"2012","6")) %>%
   bind_rows(munic_sub(gm_2012,q3e,"2012","7")) %>%

   #queria somar q3i + q3j pois representa mesma informação consolidada.

   bind_rows(munic_sub(gm_2017,q3.1,"2017","1")) %>%
   bind_rows(munic_sub(gm_2017,q3.2,"2017","2")) %>%
   bind_rows(munic_sub(gm_2017,q3.3,"2017","3")) %>%
   bind_rows(munic_sub(gm_2017,q3.5,"2017","4")) %>%
   bind_rows(munic_sub(gm_2017,q3.6,"2017","5")) %>%
   bind_rows(munic_sub(gm_2017,q3.7,"2017","6")) %>%
   bind_rows(munic_sub(gm_2017,q3.9,"2017","7")) %>%
   bind_rows(munic_sub(gm_2017,q3.8,"2017","8")) %>%
   bind_rows(munic_sub(gm_2017,q3.4,"2017","9")) %>%


  bind_rows(munic_sub(gm_2022,q1_1,"2022","1")) %>%
  bind_rows(munic_sub(gm_2022,q1_2,"2022","2")) %>%
  bind_rows(munic_sub(gm_2022,q1_3,"2022","3")) %>%
  bind_rows(munic_sub(gm_2022,q1_5,"2022","4")) %>%
  bind_rows(munic_sub(gm_2022,q1_6,"2022","5")) %>%
  bind_rows(munic_sub(gm_2022,q1_7,"2022","6")) %>%
  bind_rows(munic_sub(gm_2022,q1_9,"2022","7")) %>%
  bind_rows(munic_sub(gm_2022,q1_8,"2022","8")) %>%
  bind_rows(munic_sub(gm_2022,q1_4,"2022","9")) %>%



  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=51))

ordenado<-tabela %>%
  filter(Ano == "2022") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  f_grafico_col_percent_flip(Categoria, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Ao considerar a instituição informal, o \Cref{fig:municipais-constituicao-subdivisoes} sinaliza que a Gestão do trabalho e Vigilância Socioassistencial são os mais altos percentuais de informalidade e não constituição. Destaca-se também a proteção social especial, area recomendada existir independe da presença de undiades de CREAS.

```{r municipais-constituicao-subdivisoes, fig.cap = "Distribuição dos órgãos gestores municipais segundo constituição/formalização de subdivisões administrativas - Brasil, 2022", fig.footer = "Fonte: MDS, Censo SUAS"}

# Questionários 2016:
#tabela<-gm_2016 %>%
#  select("Proteção Social Básica"=q3_1,
#         "Proteção Social Especial"=q3_2,
#         "Gestão de Benefícios Assistenciais (Bolsa Família, BPC, Benefícios Eventuais)"=q3_3,
#         "Gestão do SUAS"=q3_4,
#         "Vigilância Socioassistencial (inclusive áreas de monitoramento e avaliação)"=q3_5,
#         "Gestão do Trabalho"=q3_6,
#         "Regulação do SUAS"=q3_7,
#         "Gestão Financeira e Orçamentária"=q3_8) %>%
#-------------------
# Questionário 2017:
#tabela<-gm_2017 %>%
#  select("Gestão do SUAS"=q3.1,
#         "Vigilância Socioassistencial (inclusive áreas de monitoramento e avaliação)"=q3.2,
#         "Gestão do Trabalho"=q3.3,
#         "Regulação do SUAS"=q3.4,
#         "Gestão Financeira e Orçamentária"=q3.5,
#         "Proteção Social Básica"=q3.6,
#         "Proteção Social Especial"=q3.7,
#         "Gestão do Cadastro Único e Programa Bolsa Família"=q3.8,
#         "Gestão de Benefícios Assistenciais (BPC, Benefícios Eventuais)"=q3.9) %>%
#-------------------
# Questionário 2022:
tabela<-gm_2022 %>%
  select("Gestão do SUAS"=q1_1,
         "Vigilância Socioassistencial (inclusive áreas de monitoramento e avaliação)"=q1_2,
         "Gestão do Trabalho"=q1_3,
         "Regulação do SUAS"=q1_4,
         "Gestão Financeira e Orçamentária"=q1_5,
         "Proteção Social Básica"=q1_6,
         "Proteção Social Especial"=q1_7,
         "Gestão do Cadastro Único e Programa Bolsa Família"=q1_8,
         "Gestão de Benefícios Assistenciais (BPC, Benefícios Eventuais)"=q1_9) %>%
#-------------------
  gather("Categoria","Nível") %>%
  mutate(Categoria=str_wrap(Categoria,width=39)) %>%
  mutate(Nível = case_when(Nível=="Sim, na estrutura formal do órgão gestor"~"Constituída formalmente",
                           Nível=="Sim, de maneira informal"~"Constituída informalmente",
                           TRUE ~ Nível)) %>%
  group_by(Categoria, Nível) %>%
  summarise(n=n()) %>%
  group_by(Categoria) %>%
  mutate(Percentual = n/sum(n))

ordenado<-tabela %>%
  filter(Nível == "Constituída formalmente") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  ungroup() %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  mutate(Nível=str_wrap(Nível,width=22)) %>%
  f_grafico_col_stack_percent_flip(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r municipais-constituicao-subdivisoes_2012, fig.cap = "Distribuição dos órgãos gestores municipais segundo constituição/formalização de subdivisões administrativas - Brasil, 2012", fig.footer = "Fonte: MDS, Censo SUAS", eval=FALSE}

# Questionários 2012:
tabela<-gm_2012 %>%
  select("Proteção Social Básica"=q3a,
         "Proteção Social Especial"=q3b,
         "Gestão de Benefícios Assistenciais (Bolsa Família, BPC, Benefícios Eventuais)"=q3e,
          "Gestão do Bolsa Família)"=q3d,
         "Gestão do SUAS"=q3f,
         "Vigilância Socioassistencial (inclusive áreas de monitoramento e avaliação)"=q3i,
         "Monitoramento e avaliação)"=q3j,
         "Gestão do Trabalho"=q3g,
         "Regulação do SUAS"=q3h,
         "Gestão Financeira e Orçamentária"=q3c) %>%
# Questionários 2016:
#tabela<-gm_2016 %>%
#  select("Proteção Social Básica"=q3_1,
#         "Proteção Social Especial"=q3_2,
#         "Gestão de Benefícios Assistenciais (Bolsa Família, BPC, Benefícios Eventuais)"=q3_3,
#         "Gestão do SUAS"=q3_4,
#         "Vigilância Socioassistencial (inclusive áreas de monitoramento e avaliação)"=q3_5,
#         "Gestão do Trabalho"=q3_6,
#         "Regulação do SUAS"=q3_7,
#         "Gestão Financeira e Orçamentária"=q3_8) %>%
#-------------------
# Questionário 2017:
#tabela<-gm_2017 %>%
#  select("Gestão do SUAS"=q3.1,
#         "Vigilância Socioassistencial (inclusive áreas de monitoramento e avaliação)"=q3.2,
#         "Gestão do Trabalho"=q3.3,
#         "Regulação do SUAS"=q3.4,
#         "Gestão Financeira e Orçamentária"=q3.5,
#         "Proteção Social Básica"=q3.6,
#         "Proteção Social Especial"=q3.7,
#         "Gestão do Cadastro Único e Programa Bolsa Família"=q3.8,
#         "Gestão de Benefícios Assistenciais (BPC, Benefícios Eventuais)"=q3.9) %>%
#-------------------
# Questionário 2022:
#tabela<-gm_2022 %>%
#  select("Gestão do SUAS"=q1_1,
#         "Vigilância Socioassistencial (inclusive áreas de monitoramento e avaliação)"=q1_2,
#         "Gestão do Trabalho"=q1_3,
#         "Regulação do SUAS"=q1_4,
#         "Gestão Financeira e Orçamentária"=q1_5,
#         "Proteção Social Básica"=q1_6,
#         "Proteção Social Especial"=q1_7,
#         "Gestão do Cadastro Único e Programa Bolsa Família"=q1_8,
#         "Gestão de Benefícios Assistenciais (BPC, Benefícios Eventuais)"=q1_9) %>%
#-------------------
  gather("Categoria","Nível") %>%
  mutate(Categoria=str_wrap(Categoria,width=39)) %>%
  mutate(Nível = case_when(Nível=="Sim, na estrutura formal do órgão gestor"~"Constituída formalmente",
                           Nível=="Sim, de maneira informal"~"Constituída informalmente",
                           TRUE ~ Nível)) %>%
  group_by(Categoria, Nível) %>%
  summarise(n=n()) %>%
  group_by(Categoria) %>%
  mutate(Percentual = n/sum(n), Posição = (cumsum(n/sum(n)) - 0.5 * n/sum(n)))

ordenado<-tabela %>%
  filter(Nível == "Constituída formalmente") %>%
  arrange(Percentual) %>%
  select(Categoria)

ordenado<-factor(ordenado, levels = ordenado$Categoria)

grafico<-tabela %>%
  ungroup() %>%
  mutate(Categoria = factor(Categoria, levels = levels(ordenado))) %>%
  mutate(Nível=str_wrap(Nível,width=22)) %>%
  ggplot(aes(x = Categoria, y = Percentual)) +
  geom_col(aes(fill = Nível), position = position_stack(reverse = TRUE)) +
  geom_text(aes(y=Posição, label = percent(Percentual))) +
  scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
  coord_flip() +
  theme(legend.position="bottom",
        legend.title = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text.x = element_blank(),
        axis.line.y = element_line(),
        panel.background = element_blank())

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

A uniformização da Lei do SUAS dos estados e municpípios em consonâcia com a LOAS foi deliberação da X Conferência Nacional. Sobre essa disposição, observa-se que nas gestões estaduais, 58% dos estados possuem Lei Estadual de regulamentação do SUAS (total de 15 estados). As últimas atualizações ocorreram a partir de 2017 (12 estados), com exceção de Minas Gerais em 2011 Goiás em 2015 e Mato Grosso do Sul em 2016.

Entratando, 11 estados que não possuem Lei do SUAS. Esse número estão presentes nas seguintes regiões do Brasil: 4 - Nordeste, 3 - Norte, 2 - Região Sul e 1 - Região Sudeste. Sudeste\footnote{ siglas dos Estado que não possuem Lei do SUAS - censo suas 2022: RR, PA, TO, PI, RN, SE, BA, SP, PR, SC e RS}.

```{r estados-atualizacao-lei, fig.cap = "Quantidade de estados segundo último ano de atualização da Lei Estadual de regulamentação do Sistema Único de Assistência Social (SUAS) - Brasil, 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

grafico<-ge_2022 %>%
  select(x = q4) %>%
  mutate(x = case_when(x <= 2017~"Até 2017",
                            TRUE ~ as.character(x))) %>%
  mutate(x = factor(x, levels = c("Até 2017","2018","2019","2020","2021","2022"))) %>%

  group_by(x) %>%
  summarise(n=n()) %>%
  filter(!is.na(x)) %>%

  f_grafico_col_numero(x, n)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Em 2022, 75% dos municípios possuíam Lei Municipal de regulamentação do SUAS (4.170). Destes, a maioria, 91% (3.798) aprovaram/atualizaram após 2013 e 9% (372) anterior a atualização da Lei Nacional\footnote{Lei nº 12.435, de 06/07/2011 altera a Lei Organiza da Assistência Social (LOAS) - nº 8.742, de 07/.12.1993} e a NOB SUAS/2012 conforme detalha a \Cref{fig:municipios-atualizacao-lei}. A inexistência de Lei é encontrada em 25% (1.400) dos municípios.

```{r municipios-atualizacao-lei, fig.cap = "Percentual de municípios segundo último ano de atualização da Lei Municipal de regulamentação do Sistema Único de Assistência Social (SUAS) - Brasil, 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

grafico <- gm_2022 %>%
  select(x=q3) %>%
  mutate(x = case_when(x <= 2012~"Até 2012",
                       x <= 2016~"Entre 2013 e 2016",
                       x <= 2019~"Entre 2017 e 2019",
                       x <= 2022~"Entre 2020 e 2022",
                       TRUE ~ as.character(x))) %>%
  mutate(x = factor(x, levels = c("Até 2012","Entre 2013 e 2016", "Entre 2017 e 2019", "Entre 2020 e 2022"))) %>%
  group_by(x) %>%
  summarise(n=n()) %>%
  mutate(Percentual = n/sum(n)) %>%
  filter(!is.na(x)) %>%

  f_grafico_col_percent(x, Percentual)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

No que se refere ao Planejamento, trata-se de uma obrigatoriedade para existência do Sistema Único e repasse de confinanciamento. O Plano Estadual de Assistência Social (PEAS) deve ser aprovado pelo Conselho Estadual de Assistência Social (CEAS). Os dados da \Cref{fig:PEAS} sinalizam que a partir de 2020 há um descrecimo desta atualização com devida aprovação do conselho.\footnote{Para os anos de 2016, 2017, 2018 e 2019 as perguntas alteraram, impossibilitande a linha histórica}\footnote{Para os municípios não foi possivel fazer essa linha histórica em decorrencia de mudanças nas perguntas}

```{r PEAS, fig.cap = "Percentual de Estados quanto a atualização do Plano Estadual de Assistência Social em 2022 - Brasil", fig.footer = "Fonte: MDS, Censo SUAS"}

grafico <- f_sim_nao(ge_2012,q8,"2012") %>%
  bind_rows(f_sim_nao(ge_2013,q9,"2013")) %>%
  bind_rows(f_sim_nao(ge_2014,q9,"2014")) %>%
  bind_rows(f_sim_nao(ge_2015,q9,"2015")) %>%

  bind_rows(f_sim_nao(ge_2020,q5,"2020")) %>%
  bind_rows(f_sim_nao(ge_2021,q5,"2021")) %>%
  bind_rows(f_sim_nao(ge_2022,q5,"2022")) %>%

  #anos que as questões mudam: 2016, 2017,2018,2019

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

O Plano de apoio técnico aos municípios também é um produto a ser realizado pelos Estados e previsto no último pacto de aprimoramento Estadual do SUAS\footnote{Resolução CNAS Nº2, de 16 de março de 2017}. De acordo com Censo Suas 2022, 57,69% dos estados possuem este plano pactuado na CIB. Este percentual reduziu em relação ao ano de 2017, na qual mais de 76% dos Estados informaram possuir este documento pactuado nesta instância de comissão intergestores bipartite (CIB).

```{r plan_apoio_tec, fig.cap = "Percentual de Estados que possuem Plano de Apoio Técnico pactuado na CIB - Brasil, 2013 a 2022", fig.footer = "Fonte: MDS, Censo SUAS"}

grafico <- f_sim_nao(ge_2013, q85, "2013") %>%
   bind_rows(f_sim_nao(ge_2014, q26, "2014")) %>%
   bind_rows(f_sim_nao(ge_2015, q19, "2015")) %>%
   bind_rows(f_sim_nao(ge_2016, q27, "2016")) %>%
   bind_rows(f_sim_nao(ge_2017, q36, "2017")) %>%
   bind_rows(f_sim_nao(ge_2018, q_18,"2018")) %>%
   bind_rows(f_sim_nao(ge_2019, q18, "2019")) %>%
   bind_rows(f_sim_nao(ge_2020, q20, "2020")) %>%
   bind_rows(f_sim_nao(ge_2021, q18, "2021")) %>%
   bind_rows(f_sim_nao(ge_2022, q20, "2022")) %>%

  #2012 não tem essa pergunta

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

A NOB SUAS 2012 também evidencia o papel dos estados frente as atribuições de apoio técnico e financeiro aos municípios\footnote{Capítulo III - NOBSUAS/2012} na qual compreende ações de:

I)  Capacitação;
II) Elaboração de normas e instrumentos;
III) Publicação de materiais informativos e de orientações técnicas;
IV) Assessoramento e acompanhamento;
V)  Incentivos financeiros.

Em 2022, todos os estados informaram realizar alguma modalidade de apoio técnico aos municípios. Os maiores percentuais observados referiam-se ao Apoio Técnico individualizado a municípios específicos ofertado por 96,2% dos estados (25). Os menores percentuais eram referentes a Seminários 46,2%, (12). Outras formas, eram ofertadas por 15,4% dos estados (\Cref{fig:estados-formas-apoio}).

Entre 2013 e 2022 o percentual de estados que prestavam assessoramento técnico a distância aumentou significativamente, passando de 42,3% (11) em 2013 para 92,3% (24) em 2022.

```{r estados-formas-apoio, fig.cap = "Percentual de estados segundo formas de apoio técnico aos municípios - Brasil, 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

ge_apoio_tecnico = function(df, q, ano, cod_categoria){
  q <- enquo(q)
  ano <- quo_name(ano)
  cod_categoria <- quo_name(cod_categoria)

#metodologia usada até 2017
#  categoria <- case_when(!! cod_categoria == "1"~"Produção e distribuição de material técnico",
#                         !! cod_categoria == "2"~"Elaboração, pelo Estado, de normativas e instruções operacionais para orientação dos municípios",
#                         !! cod_categoria == "3"~"Capacitações presenciais",
#                         !! cod_categoria == "4"~"Capacitações à distância",
#                         !! cod_categoria == "5"~"Assessoramento técnico de forma presencial no município",
#                         !! cod_categoria == "6"~"Assessoramento técnico à distância",
#                         !! cod_categoria == "7"~"Outras formas")

#2022
  categoria <- case_when(!! cod_categoria == "1"~"Encontros_Eventos de apoio técnico presenciais",
                         !! cod_categoria == "2"~"Encontros_Eventos de apoio técnico remotos (a distância)",
                         !! cod_categoria == "3"~"Apoio técnico individualizado a municípios específicos",
                         !! cod_categoria == "4"~"Monitoramento com periodicidade mínima anual",
                         !! cod_categoria == "5"~"Seminários",
                         !! cod_categoria == "6"~"Quais ações de apoio técnico foram ofertadas aos municípios",
                         !! cod_categoria == "7"~"Centrais de relacionamento",
                         !! cod_categoria == "8"~"Elaboração de orientações técnicas e materiais informativos",
                         !! cod_categoria == "9"~"Videoconferências e transmissões ao vivo",
                         !! cod_categoria == "10"~"Sítios eletrônicos e aplicativos",
                         !! cod_categoria == "11"~"Outras formas")

  df %>%
    select(!! q) %>%
    filter(!is.na(!! q)) %>%
    group_by(!! q) %>%
    summarise(n=n()) %>%
    mutate(Percentual = n/sum(n)) %>%
    filter(!! q == "Sim") %>%
    mutate("Categoria" = categoria, "Ano" = !! ano)
}

#tabela <- ge_apoio_tecnico(ge_2012, q73_1, "2012", "1") %>%
#  bind_rows(ge_apoio_tecnico(ge_2012, q73_2, "2012", "2")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2012, q73_3, "2012", "3")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2012, q73_4, "2012", "4")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2012, q73_5, "2012", "5")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2012, q73_6, "2012", "6")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2013, q83a, "2013", "1")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2013, q83b, "2013", "2")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2013, q83c, "2013", "3")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2013, q83d, "2013", "4")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2013, q83e, "2013", "5")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2013, q83f, "2013", "6")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2013, q83g, "2013", "7")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2014, q28_1, "2014", "1")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2014, q28_2, "2014", "2")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2014, q28_3, "2014", "3")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2014, q28_4, "2014", "4")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2014, q28_5, "2014", "5")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2014, q28_6, "2014", "6")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2014, q28_7, "2014", "7")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2015, q21_1, "2015", "1")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2015, q21_2, "2015", "2")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2015, q21_3, "2015", "3")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2015, q21_4, "2015", "4")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2015, q21_5, "2015", "5")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2015, q21_6, "2015", "6")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2015, q21_99, "2015", "7")) %>%

#  bind_rows(ge_apoio_tecnico(ge_2016, q28_1, "2016", "1")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2016, q28_2, "2016", "2")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2016, q28_3, "2016", "3")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2016, q28_4, "2016", "4")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2016, q28_5, "2016", "5")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2016, q28_6, "2016", "6")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2016, q28_99, "2016", "7")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2017, q37_1, "2017", "1")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2017, q37_2, "2017", "2")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2017, q37_3, "2017", "3")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2017, q37_4, "2017", "4")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2017, q37_5, "2017", "5")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2017, q37_6, "2017", "6")) %>%
#  bind_rows(ge_apoio_tecnico(ge_2017, q37_99, "2017", "7")) %>%


#para o ano de 2022 as perguntas mudaram significativamente impossibilitando fazer a linha histórica

tabela <- ge_apoio_tecnico(ge_2022, q21_1, "2022", "1") %>%
  bind_rows(ge_apoio_tecnico(ge_2022, q21_2, "2022", "2")) %>%
  bind_rows(ge_apoio_tecnico(ge_2022, q21_3, "2022", "3")) %>%
  bind_rows(ge_apoio_tecnico(ge_2022, q21_4, "2022", "4")) %>%
  bind_rows(ge_apoio_tecnico(ge_2022, q21_5, "2022", "5")) %>%
  bind_rows(ge_apoio_tecnico(ge_2022, q21_6, "2022", "6")) %>%
  bind_rows(ge_apoio_tecnico(ge_2022, q21_7, "2022", "7")) %>%
  bind_rows(ge_apoio_tecnico(ge_2022, q21_8, "2022", "8")) %>%
  bind_rows(ge_apoio_tecnico(ge_2022, q21_9, "2022", "9")) %>%
  bind_rows(ge_apoio_tecnico(ge_2022, q21_10, "2022", "10")) %>%
  bind_rows(ge_apoio_tecnico(ge_2022, q21_99, "2022", "11")) %>%

  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=51))

ordenado<-tabela %>%
  filter(Ano == "2022") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  f_grafico_col_percent_flip(Categoria, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r municipios-formas-apoio, fig.cap = "Percentual de municípios por formas de apoio técnico recebido do Estado nos 12 meses anteriores à pesquisa, segundo grandes regiões - Brasil, 2022", fig.footer = "Fonte: MDS, Censo SUAS.", eval=FALSE}

tabela<-gm_2022 %>%
# Questionários 2016:
#  select(Região,
#         "Produção e distribuição de material técnico"=q9_1,
#         "Elaboração, pelo Estado, de normativas e instruções operacionais para orientação dos municípios"=q9_2,
#         "Capacitações presenciais"=q9_3,
#         "Capacitações à distância"=q9_4,
#         "Assessoramento técnico de forma presencial no município"=q9_5,
#         "Assessoramento técnico à distância"=q9_6,
#         "Outras formas"=q9_99) %>%
#  mutate(Região = str_replace(Região, "Região ", "")) %>%
#-------------------
# Questionários 2017:
#  select(Região,
#         "Produção e distribuição de material técnico"=q18.1,
#         "Elaboração, pelo Estado, de normativas e instruções operacionais para orientação dos municípios"=q18.2,
#         "Capacitações presenciais"=q18.3,
#         "Capacitações à distância"=q18.4,
#         "Assessoramento técnico de forma presencial no município"=q18.5,
#         "Assessoramento técnico à distância"=q18.6,
#         "Outras formas"=q18.99) %>%
#  mutate(Região = str_replace(Região, "Região ", "")) %>%
#-------------------
# Questionários 2022:
  select(IBGE,
         "Participou de encontros de apoio técnico presenciais"=q7_1,
         "Recebeu apoio técnico individualizado do estado"=q7_2,
         "Enviou informações à Secretaria Estadual para monitoramento"=q7_3,
         "Participou de seminários"=q7_4,
         "Recebeu visitas técnicas do estado"=q7_5,
         "Entrou em contato com a Central de relacionamento do estado"=q7_6,
         "Recebeu orientações técnicas e materiais informativos elaborados ou compartilhados pelo estado"=q7_8,
         "Acessou sítios eletrônicos e aplicativos do estado"=q7_9,
         "Outras formas"=q7_7) %>%
  mutate(Região = case_when(substr(IBGE,1,1) == "1"~"Norte",
                            substr(IBGE,1,1) == "2"~"Nordeste",
                            substr(IBGE,1,1) == "3"~"Sudeste",
                            substr(IBGE,1,1) == "4"~"Sul",
                            substr(IBGE,1,1) == "5"~"Centro-Oeste")) %>%
#-------------------
  gather("Categoria","Valor", -Região) %>%
  mutate(Categoria=str_wrap(Categoria,width=36)) %>%
  group_by(Região, Categoria, Valor) %>%
  summarise(n=n()) %>%
  spread(Região, n, fill = 0) %>%
  ungroup() %>%
  mutate("Brasil" = rowSums(.[3:7])) %>%
  gather("Região","n",-(Categoria:Valor)) %>%
  group_by(Região, Categoria) %>%
  mutate(Percentual = n/sum(n)) %>%
  filter(Valor == "Sim") %>%
  ungroup()

ordenado<-tabela %>%
  filter(Região == "Brasil") %>%
  arrange(Percentual) %>%
  select(Categoria)

ordenado<-factor(ordenado, levels = ordenado$Categoria)

ordenado2<-tabela %>%
  select(Região) %>%
  distinct() %>%
  arrange(Região)

ordenado2<-factor(ordenado2, levels = ordenado2$Região)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = levels(ordenado))) %>%
  mutate(Região = factor(Região, levels = rev(levels(ordenado2)))) %>%
  ggplot(aes(x = Categoria, y = Percentual, group = Região)) +
  geom_col(aes(fill = Região), position = "dodge") +
  geom_text(aes(label = percent(Percentual), y=Percentual+.05), position = position_dodge(width = 0.9), size=3) +
  scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
  coord_flip() +
  theme(legend.position="bottom",
        legend.title = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text.x = element_blank(),
        axis.line.y = element_line(),
        panel.background = element_blank()) +
  guides(fill=guide_legend(nrow=1, byrow=TRUE, reverse=TRUE))

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

<!-- Em 2016, 51,8% dos municípios receberam pelo menos uma visita de técnicos da Secretaria Estadual de Assistência Social (SEAS) nos 12 meses que antecederam a pesquisa. Foi o menor percentual observado desde 2013, quando 60,0% dos municípios tinham recebido ao menos uma visita. A maior parte dos municípios que informou ter recebido visitas nos quatro anos observados foi visitada de uma a três vezes pelos técnicos da SEAS nos 12 meses que antecederam as pesquisas (\Cref{fig:municipios-receberam-visitas}). -->

```{r municipios-receberam-visitas, fig.cap = "Percentual de municípios que receberam visitas de técnicos da Secretaria Estadual de Assistência Social (SEAS) - Brasil, 2013 a 2017", fig.footer = "Fonte: MDS, Censo SUAS.", eval=FALSE}

gm_visita_tecnicos = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == "Nenhuma"~"Nenhuma visita",
                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("Nenhuma visita",
                                            "Uma visita",
                                            "Duas a três visitas",
                                            "Quatro a seis visitas",
                                            "Mais de seis visitas"))) %>%
    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n), Posição = (cumsum(n/sum(n)) - 0.5 * n/sum(n)))
}

grafico <- gm_visita_tecnicos(gm_2013, q19, "2013") %>%
  bind_rows(gm_visita_tecnicos(gm_2014, q23, "2014")) %>%
  bind_rows(gm_visita_tecnicos(gm_2015, q24, "2015")) %>%
  bind_rows(gm_visita_tecnicos(gm_2016, q7, "2016")) %>%
  bind_rows(gm_visita_tecnicos(gm_2017, q19, "2017")) %>%
  bind_rows(gm_visita_tecnicos(gm_2019, q10, "2019")) %>%
  #bind_rows(gm_visita_tecnicos(gm_2022, q7_5, "2022")) %>%

 #2022 muda a lógica da pergunta


  ggplot(aes(x = Categoria, y = Percentual, group = Nível)) +
#  geom_col(aes(fill = Nível), position = "dodge") +
#  geom_text(aes(label = percent(Percentual), y=Percentual+.07), position = position_dodge(width = 0.9), angle = 90) +
  geom_col(aes(fill = Nível), position = position_stack(reverse = TRUE)) +
  geom_text_repel(aes(y=Posição, label = percent(Percentual)), point.padding = NA) +
  scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
  theme(legend.position="bottom",
        legend.title = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text.y = element_blank(),
        axis.line.x = element_line(),
        panel.background = element_blank()) +
  guides(fill=guide_legend(nrow=1,byrow=TRUE))

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Na \Cref{fig:munic_vit_estadual} os dados percentuais mostram um aumento gradual dos municípios que informam receber visitas da gestão estadual para apoio técnico. Entretanto 62,5% informam não ter recebido visita de apoio técnico no último ano.

```{r munic_vit_estadual, fig.cap = "Percentual de Municipios que informam receber visitas de Apoio Técnico do Estado - Brasil, 2020 a 2022", fig.footer = "Fonte: MDS, Censo SUAS"}

grafico <- f_sim_nao(gm_2020, q7_5, "2020") %>%
  bind_rows(f_sim_nao(gm_2021, q7_5, "2021")) %>%
  bind_rows(f_sim_nao(gm_2022, q7_5, "2022")) %>%

  #a partir de 2020 a pergunta foi alterada, impossibilitando a linha histórica

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

O modelo de gestão do SUAS preve cofinanciamento compartilhado entre os três entes federados.\footnote{Art. 30-A.  O cofinanciamento dos serviços, programas, projetos e benefícios eventuais, no que couber, e o aprimoramento da gestão da política de assistência social no Suas se efetuam por meio de transferências automáticas entre os fundos de assistência social e mediante alocação de recursos próprios nesses fundos nas 3 (três) esferas de governo.}.

Nesta perspetiva, percebe-se um avanço nos últimos 10 anos sobre a participação dos estados no cofinanciamento estadual com participação de 96,15% (25) dos estados que informam cofinanciar os municípios (\Cref{fig:estados-cofinanciamento-municipios}).

A forma de cofinanciamento deve ser viabilizada por meio de transferência automática regular entre os fundos de assistência social (Fundo a Fundo). Sobre esse item, observa-se que em 2012, 26,63% (8) dos estados realizavam cofinanciamento na modalidade de apenas Fundo a Fundo e 25,9% (7) apenas por convenio. Dado que avançou ao longo dos anos, em 2022, 88,46% (23) dos estados que realizam cofinanciamneto regular e automático e nenhum estado apenas por convênio.

Apesar destes avanços, há registros de não cofinanciamento estadual, na qual caiu de 25,93% (7) no ano de 2012 para 3,85% (1) em 2022 (1)\footnote{o Estado do Acre não cofinancia os municípios}.

```{r estados-cofinanciamento-municipios, fig.cap = "Percentual de estados segundo realização de cofinanciamento aos municípios - Brasil; 2012 a 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

ge_cofinanciamento = function(df, q, ano, ibge){
  q <- enquo(q)
  ano <- quo_name(ano)
  ibge <- enquo(ibge)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == "Sim, fundo-a-fundo"~"Realiza apenas fundo-a-fundo",
                             Nível == "Sim, apenas fundo-a-fundo"~"Realiza apenas fundo-a-fundo",
                             Nível == "Sim, por convênio"~"Realiza apenas por convênio",
                             Nível == "Sim, apenas por convênio"~"Realiza apenas por convênio",
                             Nível == "Sim, ambos"~"Realiza ambos",
                             Nível == "Sim, por ambos"~"Realiza ambos",
                             Nível == "Não"~"Não realiza",
                             is.na(Nível)~"Não informou",
                             TRUE ~ Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("Não realiza",
                                            "Realiza apenas fundo-a-fundo",
                                            "Realiza apenas por convênio",
                                            "Realiza ambos",
                                            "Não informou"))) %>%
    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n))
}

#grafico <- ge_cofinanciamento(ge_2010, q24, "2010") %>%
#  bind_rows(ge_cofinanciamento(ge_2011, q64, "2011")) %>%
grafico <- ge_cofinanciamento(ge_2012, q64_0, "2012", codigo_ibge) %>%
  bind_rows(ge_cofinanciamento(ge_2013, q73, "2013", IBGE)) %>%
  bind_rows(ge_cofinanciamento(ge_2014, q40, "2014", IBGE)) %>%
  bind_rows(ge_cofinanciamento(ge_2015, q32, "2015", IBGE)) %>%
  bind_rows(ge_cofinanciamento(ge_2016, q30, "2016", IBGE)) %>%
  bind_rows(ge_cofinanciamento(ge_2017, q39, "2017", IBGE)) %>%
  bind_rows(ge_cofinanciamento(feas_2018, q_6, "2018", IBGE)) %>%
  bind_rows(ge_cofinanciamento(feas_2019, q9, "2019", IBGE)) %>%
  bind_rows(ge_cofinanciamento(feas_2020, q9, "2020", IBGE)) %>%
  bind_rows(ge_cofinanciamento(feas_2021, q9, "2021", IBGE)) %>%
  bind_rows(ge_cofinanciamento(feas_2022, q9, "2022", IBGE)) %>%

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

A \Cref{fig:estados-blocos-recursos} evidencia a quantidade de estados quando ao cofinanciamento aos municípios por blocos. Os dados dos últimos 10 anos, sinaliza que o número de estados que cofinanciam os municípios vem aumentando. Sobretudo o cofinanciamento da proteção social especial (Média e Alta Complexoidade), em seguida Benefícios Eventuais. No que se refere aos últimos 5 anos houve uma redução na destinação de recursos para proteção social básica e incetivos do SUAS.

```{r estados-blocos-recursos, fig.cap = "Número de estados segundo a destinação dos recursos transferidos aos municípios por blocos de financiamento - Brasil; 2012, 2017 e 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

ge_destinacao_recursos = function(df, q, ano, cod_categoria){
  q <- enquo(q)
  ano <- quo_name(ano)
  cod_categoria <- quo_name(cod_categoria)

  df %>%
    select(!! ano := !! q) %>%
    gather("Ano","Categoria") %>%
    mutate(Categoria = case_when(Categoria == "Sim"~!! cod_categoria,
                                 TRUE ~ "")) %>%
    mutate(Categoria = case_when(Categoria == "1"~"Serviço de Proteção Social Básica",
                                 Categoria == "2"~"Serviço de Proteção Social Especial de Média Complexidade",
                                 Categoria == "3"~"Serviço de Proteção Social Especial de Alta Complexidade",
                                 Categoria == "4"~"Benefícios Eventuais",
                                 Categoria == "5"~"Incentivo financeiro para Gestão do SUAS",
                                 TRUE ~ "")) %>%
    filter(Categoria != "") %>%
    mutate(Categoria=str_wrap(Categoria,width=30)) %>%
    group_by(Ano, Categoria) %>%
    summarise(n=n()) %>%
    ungroup()
}

tabela <- ge_destinacao_recursos(ge_2012, q65_1, "2012", "1") %>%
  bind_rows(ge_destinacao_recursos(ge_2012, q65_2, "2012", "2")) %>%
  bind_rows(ge_destinacao_recursos(ge_2012, q65_3, "2012", "3")) %>%
  bind_rows(ge_destinacao_recursos(ge_2012, q65_4, "2012", "4")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2013, q75a, "2013", "1")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2013, q75b, "2013", "2")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2013, q75c, "2013", "3")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2013, q75d, "2013", "4")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2013, q75e, "2013", "5")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2014, q45_1, "2014", "1")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2014, q45_2, "2014", "2")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2014, q45_3, "2014", "3")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2014, q45_4, "2014", "4")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2014, q45_5, "2014", "5")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2015, q37_1, "2015", "1")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2015, q37_2, "2015", "2")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2015, q37_3, "2015", "3")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2015, q37_4, "2015", "4")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2015, q37_5, "2015", "5")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2016, q34_1, "2016", "1")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2016, q34_2, "2016", "2")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2016, q34_3, "2016", "3")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2016, q34_4, "2016", "4")) %>%
#  bind_rows(ge_destinacao_recursos(ge_2016, q34_5, "2016", "5")) %>%
  bind_rows(ge_destinacao_recursos(ge_2017, q43_1, "2017", "1")) %>%
  bind_rows(ge_destinacao_recursos(ge_2017, q43_2, "2017", "2")) %>%
  bind_rows(ge_destinacao_recursos(ge_2017, q43_3, "2017", "3")) %>%
  bind_rows(ge_destinacao_recursos(ge_2017, q43_4, "2017", "4")) %>%
  bind_rows(ge_destinacao_recursos(ge_2017, q43_5, "2017", "5")) %>%
  bind_rows(ge_destinacao_recursos(feas_2022, q13_1, "2022", "1")) %>%
  bind_rows(ge_destinacao_recursos(feas_2022, q13_2, "2022", "2")) %>%
  bind_rows(ge_destinacao_recursos(feas_2022, q13_3, "2022", "3")) %>%
  bind_rows(ge_destinacao_recursos(feas_2022, q13_4, "2022", "4")) %>%
  bind_rows(ge_destinacao_recursos(feas_2022, q13_5, "2022", "5"))

ordenado<-tabela %>%
  filter(Ano == "2022") %>%
  arrange(n) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  f_grafico_col_numero_flip(Categoria, n, Ano)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r eval=FALSE, fig.cap = "Distribuição de municípios por recebimento de recursos estaduais para o cofinanciamento da Assistência Social - Brasil, 2013 a 2017", fig.footer = "Fonte: MDS, Censo SUAS."}

gm_cofinanciamento = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == "Sim, fundo-a-fundo"~"Recebe apenas fundo-a-fundo",
                             Nível == "Sim, apenas fundo-a-fundo"~"Recebe apenas fundo-a-fundo",
                             Nível == "Sim, por convênio"~"Recebe apenas por convênio",
                             Nível == "Sim, apenas por convênio"~"Recebe apenas por convênio",
                             Nível == "Sim, via convênio"~"Recebe apenas por convênio",
                             Nível == "Sim, ambos"~"Recebe ambos",
                             Nível == "Sim, por convênio e fundo-a-fundo"~"Recebe ambos",
                             Nível == "Não"~"Não recebe",
                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("Não recebe",
                                            "Recebe apenas fundo-a-fundo",
                                            "Recebe apenas por convênio",
                                            "Recebe ambos"))) %>%
    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n), Posição = (cumsum(n/sum(n)) - 0.5 * n/sum(n)))
}

grafico <- gm_cofinanciamento(gm_2013, q29, "2013") %>%
  bind_rows(gm_cofinanciamento(gm_2014, q39, "2014")) %>%
#  bind_rows(gm_cofinanciamento(gm_2015, q32, "2015")) %>%
#  bind_rows(gm_cofinanciamento(gm_2016, q13, "2016")) %>%
#  bind_rows(gm_cofinanciamento(gm_2017, q21, "2017")) %>%
  ggplot(aes(x = Categoria, y = Percentual, group = Nível)) +
#  geom_col(aes(fill = Nível), position = "dodge") +
#  geom_text(aes(label = percent(Percentual), y=Percentual+.07), position = position_dodge(width = 0.9), angle = 90) +
  geom_col(aes(fill = Nível), position = position_stack(reverse = TRUE)) +
  geom_text_repel(aes(y=Posição, label = percent(Percentual)), point.padding = NA) +
  scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
  theme(legend.position="bottom",
        legend.title = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text.y = element_blank(),
        axis.line.x = element_line(),
        panel.background = element_blank()) +
  guides(fill=guide_legend(nrow=1,byrow=TRUE))

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r municipios-recebimento-recursos, fig.cap = "Distribuição de municípios por recebimento de recursos estaduais para o cofinanciamento da Assistência Social e destinação dos recursos recebidos - Brasil, 2017", fig.footer = "Fonte: MDS, Censo SUAS.", eval=FALSE}

gm_cofinanciamento = function(df, q, destinacao){
  q <- enquo(q)
  destinacao <- quo_name(destinacao)

  df %>%
    select(!! destinacao := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Categoria=str_wrap(Categoria,width=24)) %>%
    mutate(Nível = case_when(Nível == "Sim, fundo-a-fundo"~"Recebe apenas fundo-a-fundo",
                             Nível == "Sim, apenas fundo-a-fundo"~"Recebe apenas fundo-a-fundo",
                             Nível == "Sim, por convênio"~"Recebe apenas por convênio",
                             Nível == "Sim, apenas por convênio"~"Recebe apenas por convênio",
                             Nível == "Sim, via convênio"~"Recebe apenas por convênio",
                             Nível == "Sim, ambos"~"Recebe ambos",
                             Nível == "Sim, por convênio e fundo-a-fundo"~"Recebe ambos",
                             Nível == "Não"~"Não recebe",
                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("Não recebe",
                                            "Recebe apenas fundo-a-fundo",
                                            "Recebe apenas por convênio",
                                            "Recebe ambos"))) %>%
    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n), Posição = (cumsum(n/sum(n)) - 0.5 * n/sum(n)))
}

tabela <- gm_cofinanciamento(gm_2017, q21.1, "Proteção Social Básica") %>%
  bind_rows(gm_cofinanciamento(gm_2017, q21.2, "Proteção Social Especial de Média Complexidade")) %>%
  bind_rows(gm_cofinanciamento(gm_2017, q21.3, "Proteção Social Especial de Alta Complexidade")) %>%
  bind_rows(gm_cofinanciamento(gm_2017, q21.4, "Benefícios Eventuais")) %>%
  bind_rows(gm_cofinanciamento(gm_2017, q21.5, "Incentivo à Gestão"))

ordenado<-tabela %>%
  filter(Nível == "Não recebe") %>%
  arrange(desc(Percentual)) %>%
  select(Categoria)

ordenado<-factor(ordenado, levels = ordenado$Categoria)

grafico<-tabela %>%
  ungroup() %>%
  mutate(Categoria = factor(Categoria, levels = levels(ordenado))) %>%
  ggplot(aes(x = Categoria, y = Percentual, group = Nível)) +
#  geom_col(aes(fill = Nível), position = "dodge") +
#  geom_text(aes(label = percent(Percentual), y=Percentual+.04), position = position_dodge(width = 0.9)) +
  geom_col(aes(fill = Nível), position = position_stack(reverse = TRUE)) +
  geom_text_repel(aes(y=Posição, label = percent(Percentual)), point.padding = NA) +
  scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
  coord_flip() +
  theme(legend.position="bottom",
        legend.title = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text.x = element_blank(),
        axis.line.y = element_line(),
        panel.background = element_blank()) +
  guides(fill=guide_legend(nrow=2,byrow=TRUE))

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

O ordenador de despesa responde pela emissão de empenho, autorização de pagamento dos recursos do fundo de assistencia social. Assim, recomenda-se que este tenha amplo conhecimento sobre a política. O gráfico da \Cref{fig:estado_ord_despesa} sinaliza que 73% dos gestores estaduais são ordenadores de despesa do fundo estadual. Dado que reduziu a partir de 2018.

```{r estado_ord_despesa, fig.cap = "Percentual de estados quanto a ordenação de despesa do Fundo Estadual - Brasil, 2018-2022", fig.footer = "Fonte: MDS, Censo SUAS."}

ord_despesa = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(
      Nível == "Secretário(a) Estadual de Assistência Social" ~ "O(a) Secretário(a) Estadual de Assistência Social",
      Nível == "O Secretário(a) Estadual da Assistência Social" ~ "O(a) Secretário(a) Estadual de Assistência Social",
      Nível == "O Secretário (a) Estadual da Assistência Social" ~ "O(a) Secretário(a) Estadual de Assistência Social",
      Nível == "Outro Funcionário da Secretaria de Assistência Social" ~ "Outro(a) Funcionário(a) da Secretaria de Assistência Social",
      Nível == "Secretário(a) ou técnic(a) de outra área" ~ "Secretário(a) ou técnico(a) de outra área",
      Nível == "Secretário(a) ou técnic(a) de outra área\"" ~ "Secretário(a) ou técnico(a) de outra área",
      Nível == "Secretário ou técnico de outra área" ~ "Secretário(a) ou técnico(a) de outra área",
      Nível == "O Governador" ~ "O Governador",


      TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("O(a) Secretário(a) Estadual de Assistência Social",
                                            "Secretário(a) ou técnico(a) de outra área",
                                            "Outro(a) Funcionário(a) da Secretaria de Assistência Social",
                                            "O Governador"))) %>%

    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n))
}

grafico <- ord_despesa(ge_2012, q44, "2012") %>%
  bind_rows(ord_despesa(ge_2013, q54, "2013")) %>%
  bind_rows(ord_despesa(ge_2014, q36, "2014")) %>%
  bind_rows(ord_despesa(ge_2015, q28, "2015")) %>%
  bind_rows(ord_despesa(ge_2016, q15, "2016")) %>%
  bind_rows(ord_despesa(ge_2017, q18, "2017")) %>%
  bind_rows(ord_despesa(feas_2018, q_2, "2018")) %>%
  bind_rows(ord_despesa(feas_2019, q2, "2019")) %>%
  bind_rows(ord_despesa(feas_2020, q2, "2020")) %>%
  bind_rows(ord_despesa(feas_2021, q2, "2021")) %>%
  bind_rows(ord_despesa(feas_2022, q2, "2022")) %>%

 f_grafico_col_stack_percent(Categoria, Percentual, Nível, 2)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

No que se refere aos municípios, aproximadamente 80% dos secretários (as) municipais são ordenadores de despesa do Fundo Municipal. Esse percentual aumentou a partir de 2016.

A \Cref{fig:munic_ord_despesa} também mostra que as/os prefeitas/os enquanto ordenadores de despesa da política de Assistência Social vem reduzindo ao longo dos anos. Dado que se revela como positivo, haja vista o gestor municipal encontra-se no cotidiano do planejamento desta política pública, sendo mais apropriado para tomar as decisões sobre o orçamento.

```{r munic_ord_despesa, fig.cap = "Percentual de municípios quanto a ordenação de despesa do Fundo Municipal - Brasil, 2013 - 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

ord_despesa = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == "Secretário Municipal de Assistência Social."~"O(a) Secretário(a) Municipal de Assistência Social.",
                            Nível == "O Secretário Municipal de Assistência Social" ~ "O(a) Secretário(a) Municipal de Assistência Social.",

                            Nível == "O Secretário(a) Municipal de Assistência Social" ~ "O(a) Secretário(a) Municipal de Assistência Social.",
                            Nível == "Outro(a) Funcionário(a) da Secretaria de Assistência Social." ~ "Outro(a) Funcionário(a) da Secretaria de Assistência Social.",
                            Nível == "Outro funcionário da Secretaria de Assistência Social" ~ "Outro(a) Funcionário(a) da Secretaria de Assistência Social.",
                            Nível == "O Secretário(a) Municipal de Assistência Social" ~ "O(a) Secretário(a) Municipal de Assistência Social.",
                            Nível == "Secretário ou técnico de outra área" ~ "Secretário(a) ou técnico(a) de outra área",
                            Nível == "Secretário ou técnico de outra área" ~ "Secretário(a) ou técnico(a) de outra área",
                            Nível == "O Prefeito" ~ "O(a) Prefeito(a)",
                             Nível == "NA" ~ "NA",



                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("O(a) Secretário(a) Municipal de Assistência Social.",
                                            "O(a) Prefeito(a)",
                                            "Secretário(a) ou técnico(a) de outra área",
                                            "Outro(a) Funcionário(a) da Secretaria de Assistência Social.",
                                            "NA"))) %>%

    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n))
}

grafico <- ord_despesa(gm_2012, q28, "2012") %>%
  bind_rows(ord_despesa(gm_2013, q27, "2013")) %>%
  bind_rows(ord_despesa(gm_2014, q33, "2014")) %>%
  bind_rows(ord_despesa(gm_2015, q30, "2015")) %>%
  bind_rows(ord_despesa(gm_2016, q11, "2016")) %>%
  bind_rows(ord_despesa(gm_2017, q20, "2017")) %>%
  bind_rows(ord_despesa(fmas_2018, q_2, "2018")) %>%
  #bind_rows(ord_despesa(fmas_2019, q2, "2019")) %>%
  bind_rows(ord_despesa(fmas_2020, q2, "2020")) %>%
  bind_rows(ord_despesa(fmas_2021, q2, "2021")) %>%
  bind_rows(ord_despesa(fmas_2022, q2, "2022")) %>%

  #2019 - FMAS base númerica - Solicitei substituição a Dionara

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 4)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r municipios-transferencia-recursos, fig.cap = "Distribuição de municípios segundo realização de transferência de recursos por meio de convênios ou termos de parcerias para ONGs, Organizações da Sociedade Civil ou Entidades de Assistência Social, por grandes regiões - Brasil, 2017", fig.footer = "Fonte: MDS, Censo SUAS", eval=FALSE}

# Questionários 2016:
#grafico <- gm_2016 %>%
#  select(Região, "resposta" = q15) %>%
#  mutate(Região = str_replace(Região, "Região ", "")) %>%
#-------------------
# Questionários 2017:
#grafico <- gm_2017 %>%
#  select(Região, "resposta" = q23) %>%
#  mutate(Região = str_replace(Região, "Região ", "")) %>%
#-------------------
# Questionários 2022:
grafico <- fmas_2022 %>%
  select(Regiao, "resposta" = q4) %>%
  mutate(Região = str_replace(Regiao, "Região ", "")) %>%
#-------------------

  mutate(Nível = case_when(resposta == "Não"~"Não realiza",
                           resposta == "Sim, com recursos do Fundo Municipal de Assistência Social (FMAS)"~"Realiza com recursos do Fundo Municipal de Assistência Social (FMAS)",
                           resposta == "Sim, com recursos de outras fontes"~"Realiza com recursos de outras fontes",
                           resposta == "Sim, com recursos do FMAS e de outras fontes"~"Realiza com recursos do FMAS e de outras fontes",
                           TRUE ~ resposta)) %>%
  filter(!is.na(Nível)) %>%
  mutate(Nível=str_wrap(Nível,width=38)) %>%
  mutate(Nível = factor(Nível, levels = str_wrap(c("Não realiza",
                                          "Realiza com recursos do Fundo Municipal de Assistência Social (FMAS)",
                                          "Realiza com recursos de outras fontes",
                                          "Realiza com recursos do FMAS e de outras fontes"),width=38))) %>%
  group_by(Região, Nível) %>%
  summarise(n=n()) %>%
  spread(Região, n, fill = 0) %>%
  mutate("Brasil" = rowSums(.[2:6])) %>%
  gather("Região","n",-Nível) %>%
  group_by(Região) %>%
  mutate("Percentual" = n/sum(n), Posição = (cumsum(n/sum(n)) - 0.5 * n/sum(n))) %>%

  ggplot(aes(x = Região, y = Percentual, group = Nível)) +
#  geom_col(aes(fill = Nível), position="dodge") +
#  geom_text(aes(label = percent(Percentual), y=Percentual+.06), position = position_dodge(width = 0.9), angle = 90) +
  geom_col(aes(fill = Nível), position = position_stack(reverse = TRUE)) +
  geom_text_repel(aes(y=Posição, label = percent(Percentual)), point.padding = NA) +
  scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
  theme(legend.position="bottom",
        legend.title = element_blank(),
        legend.key.size = unit(2, 'lines'),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text.y = element_blank(),
        axis.line.x = element_line(),
        panel.background = element_blank()) +
  guides(fill=guide_legend(nrow=2,byrow=TRUE))

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

No que se refere a Educação Permanente, nota-se um aumento dos estados que possuem Núcleo de Educação Permante (\Cref{fig:NUEP}).

O censo de 2022 sinaliza 88,5% (23) dos Estados possuem esta instancia colegiada de maneira formal. Trata-se de um foro contituída pela participação e cooperação institucionalizada de gestores, trabalhadores, usuários, conselheiros de assistência social, e instituições de ensino, pesquisa e extensão. O objetivo é deliberar sobre a implementação continuada da Política de educação permanente do SUAS.

```{r NUEP, fig.cap = "Percentual de Estados que possuem Núcleo de Educação Permanente, 2020 a 2022", fig.footer = "Fonte: MDS, Censo SUAS"}

nuep  = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == "Sim, de maneira formal"~"Sim, de maneira formal",
                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("Sim, de maneira formal",
                                            "Sim, de maneira informal",
                                            "Não"))) %>%
    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n))
}

grafico <- nuep(ge_2020, q47, "2020") %>%
    bind_rows(nuep(ge_2021, q47, "2021")) %>%
    bind_rows(nuep(ge_2022, q47, "2022")) %>%

  #pergunta sugiu a partir de 2020

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Em relação ao Plano de Educação Permanente, de acordo com censo suas de 2021, 13,9% (769) dos municípios possuem este plano. Esse percentual, como pode ser observado na \Cref{fig:PNEP_Munic}, teve evolução residual últimos anos.\footnote{Para o ano de 2022 essa pergunta foi extinta}.

```{r PNEP_Munic, fig.cap = "Percentual de municípios que possuem Plano de Capacitação e Educação Permanente, - Brasil; 2015, 2017 e 2022", fig.footer = "Fonte: MDS, Censo SUAS"}

grafico <- f_sim_nao(gm_2015, q40, "2015") %>%
    bind_rows(f_sim_nao(gm_2016, q20, "2016")) %>%
    bind_rows(f_sim_nao(gm_2017, q31, "2017")) %>%
    bind_rows(f_sim_nao(gm_2018, q_51, "2018")) %>%
    bind_rows(f_sim_nao(gm_2019, q52, "2019")) %>%
    #bind_rows(f_sim_nao(gm_2020, q73, "2020")) %>%
    bind_rows(f_sim_nao(gm_2021, q73, "2021")) %>%

  #pergunta foi extinta em 2022
  #2020 a base de dados não computou essa resposta - problemas de mineração (Dionada relatou).
  #para os estados não há essa pergunta

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r municipios-possuem-plano, fig.cap = "Percentual de municípios que possuem Plano de Capacitação e Educação Permanente, segundo grandes regiões - Brasil; 2015, 2017 e 2022", fig.footer = "Fonte: MDS, Censo SUAS",eval=FALSE}

grafico <- f_selecao_regiao_ano(gm_2015, q40, "Sim", Região, "2015") %>%
   bind_rows(f_selecao_regiao_ano(gm_2016, q20, "Sim", Região, "2016")) %>%
   bind_rows(f_selecao_regiao_ano(gm_2017, q31, "Sim", Região, "2017")) %>%
   bind_rows(f_selecao_regiao_ano(gm_2018, q_51, "Sim", Região, "2018")) %>%
   bind_rows(f_selecao_regiao_ano(gm_2019, q52, "Sim", Região, "2019")) %>%
   bind_rows(f_selecao_regiao_ano(gm_2020, q73, "Sim", Região, "2020")) %>%
   bind_rows(f_selecao_regiao_ano(gm_2021, q73, "Sim", Região, "2021")) %>%
  # bind_rows(f_selecao_regiao_ano(gm_2022, q73, "Sim", IBGE, "2022")) %>%

  #não há esta pergunta para os estados2022_foi retirada

  ggplot(aes(x = Região, y = Percentual, group = Ano)) +
  geom_col(aes(fill = Ano), position="dodge") +
  geom_text(aes(label = percent(Percentual), y=Percentual+.01), position = position_dodge(width = 0.9), angle = 90) +
  scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
  theme(legend.position="bottom",
        legend.title = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text.y = element_blank(),
        axis.line.x = element_line(),
        panel.background = element_blank()) +
  guides(fill=guide_legend(nrow=1,byrow=TRUE))

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r municipios-participacoes-CIB, fig.cap = "Percentual de municípios por número de participações em reuniões da CIB (Comissão Intergestores Bipartite) no ano de 2016, segundo grandes regiões - Brasil, 2017", fig.footer = "Fonte: MDS, Censo SUAS.", eval=FALSE}

grafico <- gm_2017 %>%
# Questionários 2016:
#  select(Região, "grupo" = q10) %>%
#-------------------
# Questionários 2017:
  select(Região, "grupo" = q16) %>%
#-------------------
  mutate(Região = str_replace(Região, "Região ", "")) %>%
  mutate(grupo = factor(grupo, levels = c("Não sabe",
                                          "Nenhuma",
                                          "1 vez no ano",
                                          "De 2 a 3 vezes no ano",
                                          "De 4 a 6 vezes no ano",
                                          "De 7 a 10 vezes no ano",
                                          "Mais de 10 vezes no ano"))) %>%
  filter(!is.na(grupo)) %>%
  group_by(Região, grupo) %>%
  summarise(n=n()) %>%
  spread(Região, n, fill = 0) %>%
  mutate("Brasil" = rowSums(.[2:6])) %>%
  gather("Região","n",-grupo) %>%
  group_by(Região) %>%
  mutate("Percentual" = n/sum(n), Posição = (cumsum(n/sum(n)) - 0.5 * n/sum(n))) %>%

  ggplot(aes(x = Região, y = Percentual, group = grupo)) +
#  geom_col(aes(fill = Nível), position="dodge") +
#  geom_text(aes(label = percent(Percentual), y=Percentual+.06), position = position_dodge(width = 0.9), angle = 90) +
  geom_col(aes(fill = grupo), position = position_stack(reverse = TRUE)) +
  geom_text_repel(aes(y=Posição, label = percent(Percentual)), point.padding = NA) +
  scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
  theme(legend.position="bottom",
        legend.title = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text.y = element_blank(),
        axis.line.x = element_line(),
        panel.background = element_blank()) +
  guides(fill=guide_legend(nrow=2,byrow=TRUE))

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

## Programas de execução própria executadas pelos estados

Em relação aos programas próprios de transferência de renda executados pelos estados, percebe-se um aumento ao longo dos anos na qual em 2022, 76,9% dos estados informaram que possuem conforme(\Cref{fig:be_uf_renda}).

```{r be_uf_renda, fig.cap = "Programas de execução própria e/ou transferência de renda executadas pelos estados", fig.footer = "Fonte: MDS, Censo SUAS"}

grafico <- f_sim_nao(ge_2012, q33, "2012") %>%
   bind_rows(f_sim_nao(ge_2013, q43, "2013")) %>%
   bind_rows(f_sim_nao(ge_2014, q74, "2014")) %>%
   bind_rows(f_sim_nao(ge_2015, q61, "2015")) %>%
   bind_rows(f_sim_nao(ge_2016, q24, "2016")) %>%
   bind_rows(f_sim_nao(ge_2017, q27, "2017")) %>%
   bind_rows(f_sim_nao(ge_2018, q_11,"2018")) %>%
   bind_rows(f_sim_nao(ge_2019, q11, "2019")) %>%
   bind_rows(f_sim_nao(ge_2020, q10, "2020")) %>%
   bind_rows(f_sim_nao(ge_2021, q10, "2021")) %>%
   bind_rows(f_sim_nao(ge_2022, q10, "2022")) %>%

  #até 2019 a pergunta era execução própria, transferencia de renda e, a partir de 2020 a pergunta muda para programas de execução própria

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

O Cadastro Único é ferramenta que possibilita inserção a programas sociais no ambito dos três entes, o grafico abaixo sinaliza evolução dos estados que usam o cadastro único enquanto respostas de programas estaduais.

```{r uf_usa_cad, fig.cap = "Programas usam Cadastro Único para seleção beneficiários", fig.footer = "Fonte: MDS, Censo SUAS"}

grafico <- f_sim_nao(ge_2020, q11_1, "2020") %>%
   bind_rows(f_sim_nao(ge_2021, q11_1, "2021")) %>%
   bind_rows(f_sim_nao(ge_2022, q11_1, "2022")) %>%

   f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

\section[Gestão do Cadastro Único]{Gestão do Cadastro Único\footnote{O formulário do posto do cadastro único foi criado em 2020, assim a maioria das informações disponíveis terão referencia esta data.}}

O Cadastro Único para Programas Sociais do Governo Federal (Cadastro Único) instituído por meio do art. 6º-F da Lei nº 8.742, de 7 de dezembro de 1993 (Lei Orgânica da Assistência Social), e regulamentado por meio do Decreto nº 11.016, de 29 de março de 2022 tem a finalidade de coletar, sistematizar e disseminar informações que permitem a identificação e caracterização das condições socioeconômicas das famílias em situação de vulnerabilidade social, sobretudo para as famílias de baixa de renda.

O objetivo é conhecer, incluir e aprimorar as políticas sociais através do acesso a Serviços, Programas, benefícios, identificação das famílias e territórios vulnerabilizados, bem como ações intersetoriais.

A gestão do Cadastro Único é compartilhada entre união, estados, municípios e distrito federal na qual cabe aos estados o apoio técnico, capacitação, monitoramento e avaliação. É nos municípios que estão os locais de cadastramento e toda gestão territorial da identificação das famílias neste cadastro público.

As unidades do Cadastro Único podem ser encontradas em locais exclusivos ou na rede de atendimento socioassistencial de CRAS, CREAS, Centro Pop. Dados do Censo SUAS mostram uma evolução de locais de cadastramento, sobretudo a partir de 2017.

Sobre a distribuição destes locais de Cadastro Único, destaca-se que em 2022, 31% (2.892) são unidades exclusivas de Cadastro Único e 68% estão em unidades da rede socioassistencial \footnote{CRAS, CREAS e CENTRO POP} conforme pode ser observado na tabela \ref{tab:qtd_unidades}.


```{=tex}
\begin{table}[H]
\centering
\caption{Quantidade de Unidades de Cadastro Único}
\label{tab:qtd_unidades}
\begin{tabular}{@{}lcccccc@{}}
\toprule
Unidades             & 2017  & 2018 & 2019 & 2020 &  2021 & 2022            \\ \midrule
CRAS                    & 5.669 & 5.508 & 5.923 & 5.729 & 5.937 & 6.090         \\
CREAS                   & 281 & 174 & 199 & 199 & 208 & 230                     \\
Centro POP              & 112 & 83 & 84 & 108 & 106 & 115                       \\
Postos Cadastro Único   & - & - & - & 2.530 & 2.695 & 2.892                       \\ \bottomrule
\textbf{Total}                   &\textbf{6.062} & \textbf{5.765} & \textbf{6.206} & \textbf{8.566} & \textbf{8.946} & \textbf{9.327}          \\ \bottomrule
\end{tabular}
\floatfoot{Fonte: MDS, Censo SUAS.}
\end{table}
```

A respeito da estrutura física das unidades exclusivas do Cadastro Único destacadas acima, 61,0% encontram-se na sede da Secretaria de Assistência Social e 24,3% em
estruturas especificas. Os demais percentuais são encontrados em outra unidade administrativa como, em um serviço integrado, OSC´s, conselho ou
escola.

No que se refere a gestão territorial, cabe as coordenações do Cadastro Único dos municípios o atendimento, a supervisão, o monitoramento e a avaliação dos processos de cadastramento, seja em postos específicos ou integradas as unidades da rede socioassistencial.


O gráfico abaixo (\Cref{fig:gestao_cad}) sinaliza que, no âmbito da gestão municipal, as ações de levantamento de famílias para atualização e inclusão cadastral são a mais realizada. A menor proporção se refere a ações de elaboração de análises utilizando dados do Cadastro Único (\Cref{fig:gestao_cad}).
\footnote{estas informações são do formulário de Gestão Municipal, assim se referem a informações gerais que a gestão informa realizar, destaca-se também que estas informações estão disponíveis a partir do ano de 2020}.


```{r gestao_cad, fig.cap = "Ações desenvolvidas no âmbito da Gestão do Cadastro Único - Brasil, 2021 e 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

gestao_cad= function(df, q, ano, cod_categoria){
  q <- enquo(q)
  ano <- quo_name(ano)
  cod_categoria <- quo_name(cod_categoria)

#2020
  categoria <- case_when(!! cod_categoria == "1"~"Levantamento do número de famílias que precisam ter seus cadastros incluídos ou atualizados",
                         !! cod_categoria == "2"~"Monitoramento das ações de gestão do Cadastro Único",
                         !! cod_categoria == "3"~"Elaboração de análises, sínteses e documentos utilizando os dados do Cadastro Único",
                         !! cod_categoria == "4"~"Recebimento e tratamento de denúncias de prestação de informação inverídica ao Cadastro Único")



  df %>%
    select(!! q) %>%
    filter(!is.na(!! q)) %>%
    group_by(!! q) %>%
    summarise(n=n()) %>%
    mutate(Percentual = n/sum(n)) %>%
    filter(!! q == "Sim") %>%
    mutate("Categoria" = categoria, "Ano" = !! ano)
}

 tabela <- gestao_cad(gm_2021,q52_1,"2021","1") %>%

  #bind_rows(gestao_cad(gm_2020,q52_1,"2020","1")) %>%
  #bind_rows(gestao_cad(gm_2020,q52_2,"2020","2")) %>%
  #bind_rows(gestao_cad(gm_2020,q52_3,"2020","3")) %>%
  #bind_rows(gestao_cad(gm_2020,q52_4,"2020","4")) %>%

   #base GM2020 númerica - comunicado DGSUAS e aguardar reposição sistema da base nominal
   #não foi possivel calcular para 2020 em decorrencia de problemas na base de dados - foi calculada nominalmente até q47_9


   #bind_rows(gestao_cad(gm_2021,q52_1,"2021","1")) %>%
   bind_rows(gestao_cad(gm_2021,q52_2,"2021","2")) %>%
   bind_rows(gestao_cad(gm_2021,q52_3,"2021","3")) %>%
   bind_rows(gestao_cad(gm_2021,q52_4,"2021","4")) %>%


  bind_rows(gestao_cad(gm_2022,q52_1,"2022","1")) %>%
  bind_rows(gestao_cad(gm_2022,q52_2,"2022","2")) %>%
  bind_rows(gestao_cad(gm_2022,q52_3,"2022","3")) %>%
  bind_rows(gestao_cad(gm_2022,q52_4,"2022","4")) %>%




  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=51))

ordenado<-tabela %>%
  filter(Ano == "2022") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  f_grafico_col_percent_flip(Categoria, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```


O gráfico (\Cref{fig:acoes_cad}) sinaliza que as ações de esclarecimento de dúvidas sobre serviços, programas entre outros são realizadas pela grande maioria das unidades do cadastro único (96,82%). Já as ações de agendamento para atendimento são realizadas por 64,35% das unidades, com redução ao longo dos anos\footnote{estas informações são dos postos que executam exclusivamente atividades do cadastro único}.

```{r acoes_cad, fig.cap = "Ações desenvolvidas pelos postos do Cadastro Único - Brasil, 2020, 2021 e 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

acoes_cad= function(df, q, ano, cod_categoria){
  q <- enquo(q)
  ano <- quo_name(ano)
  cod_categoria <- quo_name(cod_categoria)

#2020
  categoria <- case_when(!! cod_categoria == "1"~"Realização de parcerias com outros órgãos",
                         !! cod_categoria == "2"~"Ações de Busca Ativa",
                         !! cod_categoria == "3"~"Reuniões de acolhida",
                         !! cod_categoria == "4"~"Agendamento prévio",
                         !! cod_categoria == "5"~"Esclarecimento de dúvidas sobre Serviços, Programas entre outros")


  df %>%
    select(!! q) %>%
    filter(!is.na(!! q)) %>%
    group_by(!! q) %>%
    summarise(n=n()) %>%
    mutate(Percentual = n/sum(n)) %>%
    filter(!! q == "Sim") %>%
    mutate("Categoria" = categoria, "Ano" = !! ano)
}

 tabela <- acoes_cad (posto_cadunico_2020,q13_2,"2020","1") %>%
  bind_rows(acoes_cad(posto_cadunico_2020,q13_3,"2020","2")) %>%
  bind_rows(acoes_cad(posto_cadunico_2020,q13_4,"2020","3")) %>%
  bind_rows(acoes_cad(posto_cadunico_2020,q13_5,"2020","4")) %>%
  bind_rows(acoes_cad(posto_cadunico_2020,q13_10,"2020","5")) %>%
  bind_rows(acoes_cad(posto_cadunico_2021,q13_2,"2021","1")) %>%
  bind_rows(acoes_cad(posto_cadunico_2021,q13_3,"2021","2")) %>%
  bind_rows(acoes_cad(posto_cadunico_2021,q13_4,"2021","3")) %>%
  bind_rows(acoes_cad(posto_cadunico_2021,q13_5,"2021","4")) %>%
  bind_rows(acoes_cad(posto_cadunico_2021,q13_10,"2021","5")) %>%
  bind_rows(acoes_cad(posto_cadunico_2022,q13_2,"2022","1")) %>%
  bind_rows(acoes_cad(posto_cadunico_2022,q13_3,"2022","2")) %>%
  bind_rows(acoes_cad(posto_cadunico_2022,q13_4,"2022","3")) %>%
  bind_rows(acoes_cad(posto_cadunico_2022,q13_5,"2022","4")) %>%
  bind_rows(acoes_cad(posto_cadunico_2022,q13_10,"2022","5")) %>%




  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=51))

ordenado<-tabela %>%
  filter(Ano == "2020") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  f_grafico_col_percent_flip(Categoria, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```


Faz parte de procedimentos de qualificação do Cadastro Único ações de averiguação e revisão cadastral. A averiguação é um processo de verificação das informações registradas no Cadastro Único por meio da comparação dos dados declarados pelas famílias com outros dados e registros administrativos do governo federal. Já a revisão é um procedimento de atualização das famílias com registros desatualizados. O tempo considerado para um cadastro desatualizado é de 24 meses. O seguinte gráfico (\Cref{fig:ave_cad}) refere-se as informações de averiguação e revisão cadastral no âmbito dos postos dos Cadastro Único dos municípios. Nota-se que ao longo dos anos, essas ações aumentaram,sobretudo as ações de busca ativa e identificação do público de averiguação e revisão cadastral como público prioritário.


```{r ave_cad, fig.cap = "Ações de averiguação e revisão desenvolvidas pelas Unidades do Cadastro Único - Brasil, 2020, 2021 e 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

ave_cad= function(df, q, ano, cod_categoria){
  q <- enquo(q)
  ano <- quo_name(ano)
  cod_categoria <- quo_name(cod_categoria)

#2020
  categoria <- case_when(!! cod_categoria == "1"~"Realiza busca ativa às famílias",
                         !! cod_categoria == "2"~"Identifica às famílias como público prioritário para atendimento",
                         !! cod_categoria == "3"~"Realiza multirões especificos para atender famílias",
                         !! cod_categoria == "4"~"Realiza outras ações",
                         !! cod_categoria == "5"~"Não há ações específicas")


  df %>%
    select(!! q) %>%
    filter(!is.na(!! q)) %>%
    group_by(!! q) %>%
    summarise(n=n()) %>%
    mutate(Percentual = n/sum(n)) %>%
    filter(!! q == "Sim") %>%
    mutate("Categoria" = categoria, "Ano" = !! ano)
}

 tabela <- ave_cad (posto_cadunico_2020,q18_1,"2020","1") %>%
  bind_rows(ave_cad(posto_cadunico_2020,q18_2,"2020","2")) %>%
  bind_rows(ave_cad(posto_cadunico_2020,q18_3,"2020","3")) %>%
  bind_rows(ave_cad(posto_cadunico_2020,q18_99,"2020","4")) %>%
  bind_rows(ave_cad(posto_cadunico_2020,q18_0,"2020","5")) %>%

  bind_rows(ave_cad(posto_cadunico_2021,q18_1,"2021","1")) %>%
  bind_rows(ave_cad(posto_cadunico_2021,q18_2,"2021","2")) %>%
  bind_rows(ave_cad(posto_cadunico_2021,q18_3,"2021","3")) %>%
  bind_rows(ave_cad(posto_cadunico_2021,q18_99,"2021","4")) %>%
  bind_rows(ave_cad(posto_cadunico_2021,q18_0,"2021","5")) %>%

  bind_rows(ave_cad(posto_cadunico_2022,q18_1,"2022","1")) %>%
  bind_rows(ave_cad(posto_cadunico_2022,q18_2,"2022","2")) %>%
  bind_rows(ave_cad(posto_cadunico_2022,q18_3,"2022","3")) %>%
  bind_rows(ave_cad(posto_cadunico_2022,q18_99,"2022","4")) %>%
  bind_rows(ave_cad(posto_cadunico_2022,q18_0,"2022","5")) %>%




  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=51))

ordenado<-tabela %>%
  filter(Ano == "2022") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  f_grafico_col_percent_flip(Categoria, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```


Em relação as informações de unidades de Postos do Cadasto Único e o atendimento de Grupos Populacionais Tradicionais e Específicos - GPTEs, destaca-se através da (\Cref{fig:gptes-cadunico}) o percentual de unidades de postos do Cadastro Único que informam atender no período de 2020 a 2022.

```{r gptes-cadunico, fig.cap = "Unidades que realizam cadastramento de famílias pertencentes aos seguintes Grupos Tradicionais e Específicos - GPTEs - Brasil, 2020 - 2021 - 2022", fig.footer = "Fonte: MDS, Censo SUAS"}

grafico <- f_sim_nao(posto_cadunico_2020,q20_1,"2020") %>%
          bind_rows(f_sim_nao(posto_cadunico_2021,q20_1,"2021"))%>%
          bind_rows(f_sim_nao(posto_cadunico_2022,q20_1, "2022"))%>%
        #f_sim_nao(f_sim_nao(posto_cadunico_2022, q20_3, "2022"))%>%
        #f_sim_nao(f_sim_nao(posto_cadunico_2022, q20_3, "2022"))%>%
        #f_sim_nao(f_sim_nao(posto_cadunico_2022, q20_3, "2022"))%>%

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

O cadastramento domiciliar permite uma aproximação com aspectos do cotidiano das famílias, visto que a coleta das informações ocorre por meio do encontro da gestão até as famílias. Essa ação objetiva assegurar o acesso a inclusão ou atualização cadastral na residencia das pessoas. De acordo com informações da (\Cref{fig:visit_dom}) as situações mais frequentes para visita domiciliar são para averiguação cadastral e inclusão/atualização de dados do BPC (Benefício de Prestação Continuada - BPC).


```{r visit_dom, fig.cap = "Situações mais frequentes de entrevistas domiciliares no Cadastro Único - Brasil, 2020, 2021 e 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

visit_dom= function(df, q, ano, cod_categoria){
  q <- enquo(q)
  ano <- quo_name(ano)
  cod_categoria <- quo_name(cod_categoria)

#2020
  categoria <- case_when(!! cod_categoria == "1"~"Para a inclusão ou atualização cadastral",
                         !! cod_categoria == "2"~"Para apurar denúncias",
                         !! cod_categoria == "3"~"Para famílias incluídas em Averiguação Cadastral",
                         !! cod_categoria == "4"~"Para inclusão ou atualização de dados de famílias com BPC",
                         !! cod_categoria == "5"~"Para inclusão ou atualização de dados de famílias pertencentes à GPTEs",
                         !! cod_categoria == "6"~"Para inclusão ou atualização de dados de famílias que moram em locais de difícil acesso",
                         !! cod_categoria == "7"~"Outros")


  df %>%
    select(!! q) %>%
    filter(!is.na(!! q)) %>%
    group_by(!! q) %>%
    summarise(n=n()) %>%
    mutate(Percentual = n/sum(n)) %>%
    filter(!! q == "Sim, com frequência") %>%
    mutate("Categoria" = categoria, "Ano" = !! ano)
}

 tabela <- visit_dom (posto_cadunico_2020,q19_1,"2020","1") %>%
  bind_rows(visit_dom(posto_cadunico_2020,q19_2,"2020","2")) %>%
  bind_rows(visit_dom(posto_cadunico_2020,q19_3,"2020","3")) %>%
  bind_rows(visit_dom(posto_cadunico_2020,q19_4,"2020","4")) %>%
  bind_rows(visit_dom(posto_cadunico_2020,q19_5,"2020","5")) %>%
  bind_rows(visit_dom(posto_cadunico_2020,q19_6,"2020","6")) %>%
  bind_rows(visit_dom(posto_cadunico_2020,q19_99,"2020","7")) %>%

  bind_rows(visit_dom(posto_cadunico_2021,q19_1,"2021","1")) %>%
  bind_rows(visit_dom(posto_cadunico_2021,q19_2,"2021","2")) %>%
  bind_rows(visit_dom(posto_cadunico_2021,q19_3,"2021","3")) %>%
  bind_rows(visit_dom(posto_cadunico_2021,q19_4,"2021","4")) %>%
  bind_rows(visit_dom(posto_cadunico_2021,q19_5,"2021","5")) %>%
  bind_rows(visit_dom(posto_cadunico_2021,q19_6,"2021","6")) %>%
  bind_rows(visit_dom(posto_cadunico_2021,q19_99,"2021","7")) %>%

  bind_rows(visit_dom(posto_cadunico_2022,q19_1,"2022","1")) %>%
  bind_rows(visit_dom(posto_cadunico_2022,q19_2,"2022","2")) %>%
  bind_rows(visit_dom(posto_cadunico_2022,q19_3,"2022","3")) %>%
  bind_rows(visit_dom(posto_cadunico_2022,q19_4,"2022","4")) %>%
  bind_rows(visit_dom(posto_cadunico_2022,q19_5,"2022","5")) %>%
  bind_rows(visit_dom(posto_cadunico_2022,q19_6,"2022","6")) %>%
  bind_rows(visit_dom(posto_cadunico_2022,q19_99,"2022","7")) %>%





  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=51))

ordenado<-tabela %>%
  filter(Ano == "2022") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  f_grafico_col_percent_flip(Categoria, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```


Em relação as ações de complementariedade com a rede socioassistencial, destaca-se que a maioria destas unidades de cadastramento realizam encaminhamentos para rede socioassistencial de CRAS, CREAS, Centro Pop entre outros (\Cref{fig:redesuas}).




```{r redesuas, fig.cap = "Percentual de postos de Cadastro Único segundo relação com os outros equipamentos da rede socioassistencial - Brasil, 2020, 2021 e 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

rede_suas= function(df, q, ano, cod_categoria){
  q <- enquo(q)
  ano <- quo_name(ano)
  cod_categoria <- quo_name(cod_categoria)

#2022
  categoria <- case_when(!! cod_categoria == "1"~"Encaminha as famílias para a rede socioassistencial de referência para inclusão em serviços socioassistenciais",
                         !! cod_categoria == "2"~"Encaminha as famílias para a rede socioassistencial de referência para acesso a benefícios eventuais",
                         !! cod_categoria == "3"~"Atende famílias para inclusão e atualização cadastral encaminhadas pela rede socioassistencial",
                         !! cod_categoria == "4"~"Profissional da equipe do CadÚnico deste posto está alocado em outro equipamento para interlocução do CadÚnico com os programas,serviços e benefícios socioassistenciais",
                         !! cod_categoria == "5"~"Realiza Busca Ativa (cadastramento domiciliar, ações itinerantes, mutirões, etc) em conjunto com a rede socioassistencial",
                         !! cod_categoria == "6"~"Não se relaciona com outros equipamentos da rede socioassitencial")


  df %>%
    select(!! q) %>%
    filter(!is.na(!! q)) %>%
    group_by(!! q) %>%
    summarise(n=n()) %>%
    mutate(Percentual = n/sum(n)) %>%
    filter(!! q == "Sim") %>%
    mutate("Categoria" = categoria, "Ano" = !! ano)
}

 tabela <- rede_suas (posto_cadunico_2020,q32_1,"2020","1") %>%
  bind_rows(rede_suas(posto_cadunico_2020,q32_2,"2020","2")) %>%
  bind_rows(rede_suas(posto_cadunico_2020,q32_3,"2020","3")) %>%
  bind_rows(rede_suas(posto_cadunico_2020,q32_4,"2020","4")) %>%
  bind_rows(rede_suas(posto_cadunico_2020,q32_5,"2020","5")) %>%
  bind_rows(rede_suas(posto_cadunico_2020,q32_0,"2020","6")) %>%

  bind_rows(rede_suas(posto_cadunico_2021,q32_1,"2021","1")) %>%
  bind_rows(rede_suas(posto_cadunico_2021,q32_2,"2021","2")) %>%
  bind_rows(rede_suas(posto_cadunico_2021,q32_3,"2021","3")) %>%
  bind_rows(rede_suas(posto_cadunico_2021,q32_4,"2021","4")) %>%
  bind_rows(rede_suas(posto_cadunico_2021,q32_5,"2021","5")) %>%
  bind_rows(rede_suas(posto_cadunico_2021,q32_0,"2021","6")) %>%

  bind_rows(rede_suas(posto_cadunico_2022,q32_1,"2022","1")) %>%
  bind_rows(rede_suas(posto_cadunico_2022,q32_2,"2022","2")) %>%
  bind_rows(rede_suas(posto_cadunico_2022,q32_3,"2022","3")) %>%
  bind_rows(rede_suas(posto_cadunico_2022,q32_4,"2022","4")) %>%
  bind_rows(rede_suas(posto_cadunico_2022,q32_5,"2022","5")) %>%
  bind_rows(rede_suas(posto_cadunico_2022,q32_0,"2022","6")) %>%


  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=51))

ordenado<-tabela %>%
  filter(Ano == "2022") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  f_grafico_col_percent_flip(Categoria, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

O gráfico abaixo (\Cref{fig:igdbolsa}) sinaliza sobre a existência da participação das unidades do Cadastro único no planejamento
dos recursos recebidos no âmbito do IGD-PBF (Índice de Gestão Descentralizada da Gestão do Bolsa Família e Cadastro Único).
Trata-se de um recurso repassado aos estados e municípios para apoio a gestão do Cadastro Único e Bolsa Família. Esta informação é referente
a respostas do dormulário dos potos de cadastramento em âmbito dos municípios.


```{r igdbolsa, fig.cap = "Unidades de Postos do Cadastro Único quanto a participação no planejamento do IGD Bolsa Família - Brasil, 2020 - 2021 - 2022", fig.footer = "Fonte: MDS, Censo SUAS"}

igd_pbf  = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == "Não sabe informar"~"Não sabe informar",
                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("Não, o planejamento é realizado exclusivamente pelo órgão gestor municipal",
                                            "Sim, é ouvido e indica necessidades",
                                            "Sim, indica necessidades e consegue influenciar no processo decisório",
                                            "Não sabe informar"))) %>%
    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n))
}

grafico <- igd_pbf(posto_cadunico_2020, q29, "2020") %>%
   bind_rows(igd_pbf(posto_cadunico_2021, q29, "2021")) %>%
   bind_rows(igd_pbf(posto_cadunico_2022, q29, "2022")) %>%

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 4)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

<!-- colocar item abaixo coord_cadunico na gestão do trabalho.}). -->


Em relação a existência de coordenador(a) do Cadastro Único nos postos de atendimento, o gráfico (\Cref{fig:coord_cadunico}) sinaliza aumento nos últimos anos, em 2022, 31,8% dos postos do Cadastro Único possuem coordenador(a).



```{r coord_cadunico, fig.cap = "Percentual de Postos do Cadastro Único que possuem coordenador - Brasil, 2020 - 2021 - 2022", fig.footer = "Fonte: MDS, Censo SUAS"}

grafico <- f_sim_nao(posto_cadunico_2020, q39_1, "2020") %>%
  bind_rows(f_sim_nao(posto_cadunico_2021, q39_1, "2021"))%>%
  bind_rows(f_sim_nao(posto_cadunico_2022, q39_1, "2022"))%>%

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

## Considerações Finais (revisar)

A Assistência Social é uma política de previsibilidade constitucional reafirmadas por Lei, Normas, decretos, pactos. Assim, faz-se essencial padrões de gestão e comandos únicos em todos os entes federados. Os dados históricos sinalizam avanços e desafios para gestão do SUAS.

Os órgãos gestores da assistência social, tanto estaduais quanto municipais, são estruturas fundamentais para a execução deste política. O significado do direito caminham junto com o planejamento, ofertas continuadas, padrões de respostas, comandos unicos etc.

Assim, para consolidação desta política que faz-se universal nos territórios,é fundamental em todos entes federados estruturas administrativas indicadas nos pactos, Lei compatível com LOAS, conforme deliberação das conferencias nacionais, comando único do gestor da pasta entre outros.

Os dados sinalizam avanços, a respeito das subdivisões administrativas que apresentavam maior percentual de formalização nos órgãos gestores estaduais em 88,5% dos estados. As que apresentavam menores percentuais de formalização nos órgãos gestores estaduais eram as de Regulação do SUAS (38,5%) e de Gestão do Trabalho (57,7%). Nos municípios, destaca-se forte presença de formalização das gestões do Cadastro Único e Bolsa Família, bem como a proteção social básica, com respectivamente 80,68% e 77,90% respectivamente.

Os recursos recebidos via transação fundo-a-fundo, garantem maior qualidade na distribuição, já que estes são fiscalizados pelos órgãos de controle social e passam pelo crivo das Comissões Intergestores Bipartite e Tripartite. Sobre o repasse, destacam-se o avanço ao longo dos anos nesta forma repasse aliado ao cofinanciamento, sendo mais presente o cofinancimento a Proteção Social Especial.

Destaca-se também um tópico novo e de importancia para gestão de informação do SUAS. O cadatsro único é uma ferramenta que visa potencializar as funções de proteção socia, vigilancia socioassitencial e defesa de direitos, Para isso, os dados promovem acesso a serviços e progrmas, identificação das fmaílias e leitura dos territórios, bem como parcerias e ações intersetoriais.

# Unidades do SUAS

Essa seção apresenta informações sobre as unidades físicas do SUAS e sua evolução ao longo do tempo. Esse item contempla as seguintes informações: a) quantidade de unidades administrativas da rede socioassistencial, b) informações sobre acessibilidade, c) situação do imovél, d) disponibilidade de equipamentos como computador com acesso a internet.

## Centros de Referência de Assistência Social (CRAS)

Os Centros de Referência de Assistência Social (CRAS) são definidos pelo artigo 6º-C da Lei Orgânica de Assistência Social (LOAS) como unidades públicas municipais destinadas à prestação de serviços, programas de projetos da proteção social básica às famílias, devendo se localizar em áreas com maiores índices de vulnerabilidade e risco social.

No Censo SUAS de 2022 foram identificados 8.557 CRAS, em 5.535 municípios brasileiros, o que indica que há pelo menos um CRAS em 99,4% dos municípios brasileiros.

O quantitativo de CRAS dobrou entre 2007 e 2022, passando de 4.195 unidades para 8.557. O \Cref{fig:quantitativo-CRAS} apresenta a evolução do quantitativo de CRAS por grandes regiões de desenvolvimento.



```{r quantitativo-CRAS, fig.cap = "Evolução do quantitativo de CRAS, segundo grandes regiões; 2007, 2012, 2017 e 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

grafico <- f_quantitativo_regiao_ano(cras_2007, ibge, "2007") %>%
  # bind_rows(f_quantitativo_regiao_ano(cras_2008, Região, "2008")) %>%
  # bind_rows(f_quantitativo_regiao_ano(cras_2009, Região, "2009")) %>%
  # bind_rows(f_quantitativo_regiao_ano(cras_2010, Região, "2010")) %>%
  # bind_rows(f_quantitativo_regiao_ano(cras_2011, IBGE, "2011")) %>%
  bind_rows(f_quantitativo_regiao_ano(cras_2012, Região, "2012")) %>%
  # bind_rows(f_quantitativo_regiao_ano(cras_2013, Região, "2013")) %>%
  # bind_rows(f_quantitativo_regiao_ano(cras_2014, Região, "2014")) %>%
  # bind_rows(f_quantitativo_regiao_ano(cras_2015, Região, "2015")) %>%
  #bind_rows(f_quantitativo_regiao_ano(cras_2016, Região, "2016")) %>%
  bind_rows(f_quantitativo_regiao_ano(cras_2017, Região, "2017")) %>%
  # bind_rows(f_quantitativo_regiao_ano(cras_2018, IBGE, "2018")) %>%
  # bind_rows(f_quantitativo_regiao_ano(cras_2019, IBGE, "2019")) %>%
  # bind_rows(f_quantitativo_regiao_ano(cras_2020, IBGE, "2020")) %>%
  # bind_rows(f_quantitativo_regiao_ano(cras_2021, IBGE, "2021")) %>%
  bind_rows(f_quantitativo_regiao_ano(cras_2022, IBGE, "2022")) %>%
  f_grafico_col_group_numero(Região, n, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

A Expansão em todo território nacional do número de CRAS evidencia a consolidação de uma referencia de equipamento público de Assistêrncia Social em todo território nacional. De acordo com os dados 99,37% municípios possuem CRAS, ou seja apenas 34 municípios no Brasil não dispõe desta unidade pública.\footnote{estas informações são referentes ao preenchimento do Censo SUAS, é possível que no determinado período esta unidade pública não tenha preenchido o forumulário}.

```{r municipios-CRAS, fig.cap = "Evolução do percentual de municípios com pelo menos um CRAS, segundo grandes regiões - Brasil, 2007 a 2017", fig.footer = "Fonte: MDS, Censo SUAS", eval=FALSE}

grafico <- f_percentual_municipios_regiao_ano(cras_2007, ibge, "2007") %>%
 # bind_rows(f_percentual_municipios_regiao_ano(cras_2008, IBGE, "2008")) %>%
 # bind_rows(f_percentual_municipios_regiao_ano(cras_2009, IBGE, "2009")) %>%
 # bind_rows(f_percentual_municipios_regiao_ano(cras_2010, ibge, "2010")) %>%
 # bind_rows(f_percentual_municipios_regiao_ano(cras_2011, IBGE, "2011")) %>%
 bind_rows(f_percentual_municipios_regiao_ano(cras_2012, IBGE, "2012")) %>%
 # bind_rows(f_percentual_municipios_regiao_ano(cras_2013, IBGE, "2013")) %>%
 # bind_rows(f_percentual_municipios_regiao_ano(cras_2014, IBGE, "2014")) %>%
 # bind_rows(f_percentual_municipios_regiao_ano(cras_2015, CD_IBGE, "2015")) %>%
 # bind_rows(f_percentual_municipios_regiao_ano(cras_2016, IBGE, "2016")) %>%
 bind_rows(f_percentual_municipios_regiao_ano(cras_2017, IBGE, "2017")) %>%
 # bind_rows(f_percentual_municipios_regiao_ano(cras_2018, IBGE, "2018")) %>%
 # bind_rows(f_percentual_municipios_regiao_ano(cras_2019, IBGE, "2019")) %>%
 # bind_rows(f_percentual_municipios_regiao_ano(cras_2020, IBGE, "2020")) %>%
 # bind_rows(f_percentual_municipios_regiao_ano(cras_2021, IBGE, "2021")) %>%
 bind_rows(f_percentual_municipios_regiao_ano(cras_2022, IBGE, "2022")) %>%

  ggplot(aes(x = Região, y = Percentual, group = Ano)) +
  geom_col(aes(fill = Ano), position="dodge") +
  geom_text(aes(label = percent(Percentual), y=Percentual+0.04), position = position_dodge(width = 0.9), angle = 90, size = 2.5) +
  scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
  theme(legend.position="bottom",
        legend.title = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text.y = element_blank(),
        axis.line.x = element_line(),
        panel.background = element_blank()) +
  guides(fill=guide_legend(nrow=1,byrow=TRUE))

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Ao observar o número de CRAS por municípios, levando-se em conta o porte populacional, verifica-se que os 35 municípios do país que não possuem CRAS \footnote{é possível também que alguns deles não tenham respondido ao Censo SUAS} e estão concentrados em municípios de pequeno porte \Cref{fig:CRAS-porte}.

Em relação a concentração de quantidade de CRAS, para os municípios de pequeno porte I e pequeno porte II, dispõem, em sua maioria de uma unidade de CRAS como referencia do território, sendo respectivamente 95,2% e 71,5%. Os municípios de médio porte, cerca de 67,3% possuem de 2 a 3 CRAS. Ja entre os municípios de grande porte, o grupo majoritário de unidades são entre 4 a 6 CRAS - 52,5%.

<!-- Sobre o número de famílias referenciadas a PNAS\footnote{PNAS/2004 - Política Nacional de Assistência Social} deternima de acordo com portes populacionais dos municípios, são eles: PPI: 2.500 famílias referenciadas por CRAS, PPII: 3.500 famílias referenciadas, Médio/Grande/Metrópole: 5000 famílias referencia por CRAS.
CRAS -->

```{r CRAS-porte, fig.cap = "Percentual de municípios por número de CRAS no município, segundo porte populacional estimado do município - Brasil, 2017", fig.footer = "Fonte: MDS, Censo SUAS; e IBGE, estimativas da população residente para os municípios"}

cras_municipios <- cras_2017 %>%
  select(IBGE7) %>%
  group_by(IBGE7) %>%
  summarise(n_cras=n())

porte_municipios <- pop_municipios_2017 %>%
  f_porte_populacional(`POPULAÇÃO ESTIMADA`) %>%
  mutate(IBGE7 = as.numeric(paste0(`COD. UF`, `COD. MUNIC`))) %>%
  select(IBGE7, Porte)

dados <- cras_municipios %>%
  full_join(porte_municipios, by = c("IBGE7" = "IBGE7")) %>%
  mutate(grupo = case_when(is.na(n_cras)~"Nenhum CRAS",
                            n_cras == 0~"Nenhum CRAS",
                            n_cras == 1~"1 CRAS",
                            n_cras <= 3~"De 2 a 3 CRAS",
                            n_cras <= 6~"De 4 a 6 CRAS",
                            n_cras <= 10~"De 7 a 10 CRAS",
                            n_cras > 10~"Mais de 10 CRAS",
                            TRUE~as.character(n_cras))) %>%
  mutate(grupo = factor(grupo, levels = c("Nenhum CRAS",
                                            "1 CRAS",
                                            "De 2 a 3 CRAS",
                                            "De 4 a 6 CRAS",
                                            "De 7 a 10 CRAS",
                                            "Mais de 10 CRAS"))) %>%
  group_by(Porte, grupo) %>%
  summarise(n=n()) #%>%
#  complete(grupo, fill = list(n=0))

niveis_porte <- dados$Porte %>%
  levels() %>%
  append("Brasil")

grafico <- dados %>%
  spread(Porte, n, fill = 0) %>%
  mutate("Brasil" = rowSums(.[2:6])) %>%
  gather("Porte","n",-grupo) %>%
  mutate(Porte = factor(Porte, levels = niveis_porte)) %>%
  group_by(Porte) %>%
  mutate("Percentual" = n/sum(n)) %>%

  f_grafico_col_stack_percent(Porte, Percentual, grupo, 2)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Os dados de CRAS que funcionam com imóvel próprio evoluiu significativamente de 2008 a 2022. Destaca-se que o primeiro ano da série histórica abaixo possuia (\Cref{fig:CRAS-imovel}) 43,7%  CRAS com imóvel próprio, dado que chega em 2022 com 59,62%. Dados com CRAS que funcionam com imóveis alugados passam por redução de 48,2% para 32,2%.

Observa-se ainda aumento no percentual de CREAS que funcionam em imóveis cedidos: eram 6,8% em 2008, o maior valor da série histórica chega a 9,1% conforme (\Cref{fig:CRAS-imovel}).
\footnote{Para os anos de 2018 e 2019 esse dado não foi computado no censo suas}

```{r sit_imovel, fig.cap = "Evolução dos CRAS segundo situação do imóvel – Brasil, 2007 a 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

grafico <- f_equip_imovel(cras_2008, `situacao_imovel`, "2008") %>%
  #bind_rows(f_equip_imovel(cras_2007, v15, "2007")) %>%
  bind_rows(f_equip_imovel(cras_2009, `q5_situac_imovel`, "2009")) %>%
  bind_rows(f_equip_imovel(cras_2010, q5, "2010")) %>%
  bind_rows(f_equip_imovel(cras_2011, q5, "2011")) %>%
  bind_rows(f_equip_imovel(cras_2012, q5, "2012")) %>%
  bind_rows(f_equip_imovel(cras_2013, q5, "2013")) %>%
  bind_rows(f_equip_imovel(cras_2014, q4, "2014")) %>%
  bind_rows(f_equip_imovel(cras_2015, q4, "2015")) %>%
  bind_rows(f_equip_imovel(cras_2016, q4, "2016")) %>%
  bind_rows(f_equip_imovel(cras_2017, q4, "2017")) %>%
  #bind_rows(f_equip_imovel(cras_2018, q4, "2017")) %>%
  #bind_rows(f_equip_imovel(cras_2019, q4, "2017")) %>%
  bind_rows(f_equip_imovel(cras_2020, q3, "2020")) %>%
  bind_rows(f_equip_imovel(cras_2021, q3, "2021")) %>%
  bind_rows(f_equip_imovel(cras_2022, q3, "2022")) %>%

  #2018 não fazem essa pergunta
  #2019 não fazem essa pergunta
  #2020

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

A acessibilidade é importante para que os usuários da política consigam chegar até os serviços oferecidos pelos CRAS. Em 2016, 38,7% das unidades declararam ter rota acessível ao banheiro de acordo com a Norma da ABNT (NBR9050), enquanto que, em 37,8% havia rota acessível aos espaços do CRAS de acordo com a referida Norma. \footnote{foram considerados acesso adptado os imóveis que informam possui acessibildiade, de acordo com a norma ABNT ou não}. Embora nenhuma das adaptações de acordo com a Norma da ABNT tenha estado presente em mais de 40% das unidades, todas as categorias relativas à acessibilidade continuam crescendo percentualmente em relação aos anos anteriores (\Cref{fig:CRAS-acessibilidade}).

```{r CRAS-acessibilidade, fig.cap = "Evolução percentual de CRAS com condições de acessibilidade - Brasil; 2012, 2017 e 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

#tabela <- equip_acessibilidade(cras_2010, q10_1, "2010", "1") %>%
#  bind_rows(equip_acessibilidade(cras_2010, q10_2, "2010", "2")) %>%
#  bind_rows(equip_acessibilidade(cras_2010, q10_3, "2010", "3")) %>%
#  bind_rows(equip_acessibilidade(cras_2010, q10_4, "2010", "4")) %>%
#  bind_rows(equip_acessibilidade(cras_2011, q10a, "2011", "1")) %>%
#  bind_rows(equip_acessibilidade(cras_2011, q10b, "2011", "2")) %>%
#  bind_rows(equip_acessibilidade(cras_2011, q10c, "2011", "3")) %>%
#  bind_rows(equip_acessibilidade(cras_2011, q10d, "2011", "4")) %>%
tabela <- equip_acessibilidade(cras_2012, q10a, "2012", "1") %>%
  bind_rows(equip_acessibilidade(cras_2012, q10b, "2012", "2")) %>%
  bind_rows(equip_acessibilidade(cras_2012, q10c, "2012", "3")) %>%
  bind_rows(equip_acessibilidade(cras_2012, q10d, "2012", "4")) %>%
#  bind_rows(equip_acessibilidade(cras_2013, q10a, "2013", "1")) %>%
#  bind_rows(equip_acessibilidade(cras_2013, q10b, "2013", "2")) %>%
#  bind_rows(equip_acessibilidade(cras_2013, q10c, "2013", "3")) %>%
#  bind_rows(equip_acessibilidade(cras_2013, q10d, "2013", "4")) %>%
#  bind_rows(equip_acessibilidade(cras_2014, q9a, "2014", "1")) %>%
#  bind_rows(equip_acessibilidade(cras_2014, q9b, "2014", "2")) %>%
#  bind_rows(equip_acessibilidade(cras_2014, q9c, "2014", "3")) %>%
#  bind_rows(equip_acessibilidade(cras_2014, q9d, "2014", "4")) %>%
#  bind_rows(equip_acessibilidade(cras_2015, q9_1, "2015", "1")) %>%
#  bind_rows(equip_acessibilidade(cras_2015, q9_2, "2015", "2")) %>%
#  bind_rows(equip_acessibilidade(cras_2015, q9_3, "2015", "3")) %>%
#  bind_rows(equip_acessibilidade(cras_2015, q9_4, "2015", "4")) %>%
#  bind_rows(equip_acessibilidade(cras_2016, q9_1, "2016", "1")) %>%
#  bind_rows(equip_acessibilidade(cras_2016, q9_2, "2016", "2")) %>%
#  bind_rows(equip_acessibilidade(cras_2016, q9_3, "2016", "3")) %>%
#  bind_rows(equip_acessibilidade(cras_2016, q9_4, "2016", "4")) %>%
  bind_rows(equip_acessibilidade(cras_2017, q9.1, "2017", "1")) %>%
  bind_rows(equip_acessibilidade(cras_2017, q9.2, "2017", "2")) %>%
  bind_rows(equip_acessibilidade(cras_2017, q9.3, "2017", "3")) %>%
  bind_rows(equip_acessibilidade(cras_2017, q9.4, "2017", "4")) %>%
  bind_rows(equip_acessibilidade(cras_2022, q8_1, "2022", "1")) %>%
  bind_rows(equip_acessibilidade(cras_2022, q8_2, "2022", "2")) %>%
  bind_rows(equip_acessibilidade(cras_2022, q8_3, "2022", "3")) %>%
  bind_rows(equip_acessibilidade(cras_2022, q8_4, "2022", "4")) %>%
  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=34))

ordenado<-tabela %>%
  filter(Ano == "2022") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  f_grafico_col_percent_flip(Categoria, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Os CRAS são considerados a porta de entrada da Assistência Social, sendo uma referência para a população no território. Nesse sentido, podem se articular com a rede de proteção social e com demais serviços ofertados no município, de forma a garantir o acesso da população aos direitos sociais.

Em 2016, verificou-se que as condições de acessibilidade em CRAS localizados em imóveis próprios eram melhores que nas unidades situadas em imóveis alugados ou cedidos. Entre os 4.263 CRAS que estavam instalados em imóveis próprios, 51,9% (2.212 unidades) possuíam banheiro adaptado para pessoas com deficiência de acordo com a Norma ABNT (NBR9050) e 53,2% (2.267) rotas acessíveis ao banheiro. Dos 3.259 CRAS que funcionavam em imóveis alugados, 16,9% (522 unidades) possuíam banheiro adaptado para pessoas com deficiência e 21,3% (694 unidades) rota cessível ao banheiro. Entre os cedidos os percentuais eram 30,8 e 31,3, respectivamente, considerando o total de 718 Unidades (\Cref{fig:CRAS-acessibilidade-situacao}).

Considerando a totalidade dos CRAS (8.240), 27,5% dos CRAS que tinham rota acessível ao banheiro de acordo com a Norma ABNT estavam instalados em imóveis próprios, contra 8,4% em imóveis alugados.

De todos os CRAS em imóveis próprios, apenas 3,0% informaram não ter nenhuma condição de acessibilidade, ainda que em desacordo com a norma ABNT. Para os CRAS localizados em imóveis alugados esse percentual foi de 11,6% e em imóveis cedidos de 8,4%.


```{r CRAS-acessibilidade-situacao, fig.cap = "Percentual de CRAS com condições de acessibilidade por situação do imóvel – Brasil, 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

#tabela <- equip_acessibilidade_situacao(cras_2016, q4, q9_1, "1") %>%
#  bind_rows(equip_acessibilidade_situacao(cras_2016, q4, q9_2, "2")) %>%
#  bind_rows(equip_acessibilidade_situacao(cras_2016, q4, q9_3, "3")) %>%
#  bind_rows(equip_acessibilidade_situacao(cras_2016, q4, q9_4, "4")) %>%
#tabela <- equip_acessibilidade_situacao(cras_2017, q4, q9.1, "1") %>%
#  bind_rows(equip_acessibilidade_situacao(cras_2017, q4, q9.2, "2")) %>%
#  bind_rows(equip_acessibilidade_situacao(cras_2017, q4, q9.3, "3")) %>%
#  bind_rows(equip_acessibilidade_situacao(cras_2017, q4, q9.4, "4")) %>%
tabela <- equip_acessibilidade_situacao(cras_2022, q3, q8_1, "1") %>%
  bind_rows(equip_acessibilidade_situacao(cras_2022, q3, q8_2, "2")) %>%
  bind_rows(equip_acessibilidade_situacao(cras_2022, q3, q8_3, "3")) %>%
  bind_rows(equip_acessibilidade_situacao(cras_2022, q3, q8_4, "4"))

ordenado<-tabela %>%
  filter(Situacao == "Próprio") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = rev(ordenado))) %>%
  f_grafico_col_group_percent(Situacao, Percentual, Categoria, 4)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

O número absoluto e o percentual de CRAS com acesso à internet aumentam desde 2007 chegando no último ano desta série com mais de 99% das unidades com computadores com acesso a internet conforme (\Cref{fig:CRAS-internet-percentual}).


```{r CRAS-internet, fig.cap = "Distribuição dos CRAS com computadores com acesso à internet; 2007, 2012, 2017 e 2022", fig.footer = "Fonte: MDS, Censo SUAS.", eval = FALSE}

f_cras_internet = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! q) %>%
    group_by(!! q) %>%
    summarise(Total=n()) %>%
    mutate("Ano" = !! ano, Percentual = Total/sum(Total)*100) %>%
    filter(!! q == 1)
}

grafico <- f_cras_internet(cras_2007, `Acesso a Internet`, "2007") %>%
  bind_rows(f_cras_internet(cras_2012, q13b, "2012")) %>%
  bind_rows(f_cras_internet(cras_2017, q12.2, "2017")) %>%
  bind_rows(f_cras_internet(cras_2022, q11_2, "2022")) %>%

  ggplot(aes(x = Ano)) +
#  geom_col(aes(fill = Percentual)) +
  geom_col(aes(y = Percentual*24)) +
  geom_line(aes(y = Total)) +
  geom_point(aes(y = Total)) +
  geom_text(aes(label = percent(Percentual/100), y=(Percentual+1.5)*24)) +
  geom_text(aes(label = Total, y=Total+50)) +
  scale_y_continuous(expand = expand_scale(mult = c(0, .1)), sec.axis = sec_axis(~./24, name = "%")) +
  labs(y = "Total") +
  theme(legend.position="bottom",
        legend.title = element_blank(),
        axis.title.x = element_blank(),
        axis.ticks.x = element_blank(),
        axis.line.x = element_line(),
        axis.line.y = element_line(),
        panel.background = element_blank()) +
  guides(fill=guide_legend(nrow=1,byrow=TRUE))

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r CRAS-internet-quantitativo, fig.cap = "Evolução do quantitativo de CRAS com computadores com acesso à internet – Brasil, 2007 a 2017", fig.footer = "Fonte: MDS, Censo SUAS.", eval=FALSE}

#grafico <- f_selecao_regiao_ano(cras_2007, v17, "1", Gran_reg, "2007")
#  bind_rows(f_quantitativo_regiao_ano(cras_2008, Região, "2008")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cras_2009, Região, "2009")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cras_2010, Região, "2010")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cras_2011, IBGE, "2011")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cras_2012, Região, "2012")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cras_2013, Região, "2013")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cras_2014, Região, "2014")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cras_2015, Região, "2015")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cras_2016, Região, "2016")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cras_2017, Região, "2017")) %>%
#  ggplot(aes(x = Região, y = n, group = Ano)) +
#  geom_col(aes(fill = Ano), position="dodge") +
#  geom_text(aes(label = format(n, big.mark="."), y=n+300), position = position_dodge(width = 0.9), angle = 90, size = 2.5) #+
#  scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
#  theme(legend.position="bottom",
#        legend.title = element_blank(),
#        axis.title = element_blank(),
#        axis.ticks = element_blank(),
#        axis.text.y = element_blank(),
#        axis.line.x = element_line(),
#        panel.background = element_blank()) +
#  guides(fill=guide_legend(nrow=1,byrow=TRUE))

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r CRAS-internet-percentual, fig.cap = "Evolução percentual de CRAS com computadores com acesso à internet – Brasil; 2007, 2012, 2017 e 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

grafico <- f_maior0_regiao_ano(cras_2007, `Acesso a Internet`, ibge, "2007") %>%
  bind_rows(f_maior0_regiao_ano(cras_2012, q13b, Região, "2012")) %>%
  bind_rows(f_maior0_regiao_ano(cras_2017, q12.2, Região, "2017")) %>%
  bind_rows(f_maior0_regiao_ano(cras_2022, q11_2, IBGE, "2022")) %>%

  f_grafico_col_group_percent(Região, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Em relação a CRAS com locais para Cadastro Único, o dado abaixo trás o percentual destas informações e a disposição de equipes para esta finalidade. Nota-se o aumento ao longo dos anos com CRAS que possuem cadastro único com equipe exclusiva (\Cref{fig:equip-cadunico-cras}).

```{r equip-cadunico-cras, fig.cap = "Percentual de CRAS com locais para CadÚnico - 2017 - 2022", fig.footer = "Fonte: MDS, Censo SUAS"}

equip_cadunico  = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == "Sim, com equipe exclusiva para esta finalidade"~"Sim, com equipe exclusiva para esta finalidade",
                             Nível == "Não realiza"~"Não",
                              TRUE ~ Nível))%>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("Sim, com equipe exclusiva para esta finalidade",
                                            "Sim, com outra equipe",
                                            "Sim, com a equipe responsável pelo PAIF",
                                            "Não"))) %>%
    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n), Posição = (cumsum(n/sum(n)) - 0.5 * n/sum(n)))
}

grafico <- equip_cadunico(cras_2010, q43, "2010") %>%
   bind_rows(equip_cadunico(cras_2011, q47, "2011"))%>%
   bind_rows(equip_cadunico(cras_2012, q45, "2012"))%>%
   bind_rows(equip_cadunico(cras_2013, q40, "2013"))%>%
   bind_rows(equip_cadunico(cras_2014, q41, "2014"))%>%
   bind_rows(equip_cadunico(cras_2015, q37, "2015"))%>%
   bind_rows(equip_cadunico(cras_2016, q31, "2016")) %>%
   bind_rows(equip_cadunico(cras_2017, q35, "2017")) %>%
   bind_rows(equip_cadunico(cras_2018, q_40, "2018")) %>%
   bind_rows(equip_cadunico(cras_2019, q39, "2019")) %>%
   bind_rows(equip_cadunico(cras_2020, q39, "2020")) %>%
   bind_rows(equip_cadunico(cras_2021, q39, "2021")) %>%
   bind_rows(equip_cadunico(cras_2022, q39, "2022")) %>%

 #CRAS2020_base com códigos numericos

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 2)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

## Centros de Convivência

Os Centros de Convivência, juntamente com os Centros de Referência de Assistência Social (CRAS), são unidades que executam o Serviço de Convivência e Fortalecimento de Vínculos e compõem a Rede de Proteção Social Básica. Desde 2014 o número de Centros de Convivência no Brasil aumentou, passando de 7.882 unidades em 2014 para 8.454 em 2016, em um acréscimo de 572 unidades. A região Norte tem a menor quantidade de unidades (238 ou 2,8% do total), seguida do Centro-Oeste com 568 Unidades (ou 6,7% do total). A região Sudeste tem o maior número de Centros de Convivência, com 4.035 Unidades (47,7% do total)

```{r quantitativo-CentroConv, fig.cap = "Evolução do quantitativo de Centro de Convivência, segundo grandes regiões; 2014, 2018, 2020 e 2022", fig.footer = "Fonte: MDS, Censo SUAS",eval=FALSE}

grafico <- f_quantitativo_regiao_ano(ceconv_2014, Região, "2014") %>%
   bind_rows(f_quantitativo_regiao_ano(ceconv_2018, Regiao, "2018")) %>%
   #bind_rows(f_quantitativo_regiao_ano(ceconv_2020, IBGE, "2020")) %>%
   bind_rows(f_quantitativo_regiao_ano(ceconv_2022, IBGE, "2022")) %>%
   f_grafico_col_group_numero(Região, n, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Os Centros de Convivência podem ser unidades públicas ou vinculadas a entidades de assistência social, inscritas nos Conselhos de Assistência Social do município ou do DF. Em 2016, 44,7% dos Centros de Convivência eram governamentais (total de 3.781 unidades) e 55,3% das unidades eram não governamentais (4.672 unidades). Desde 2014, o percentual de unidades de natureza não governamental vem se reduzindo, passando de 57,4% (4.521 unidades) para 55,3% (4.672 unidades) em 2016 (Gráfico 29).

```{r centro-conv-natureza, fig.cap = "Quantitativo de Centros de Convivência por Natureza da Unidade - BRASIL; 2016 a 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

centro  = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == "Não Governamental"~"Não Governamental/Organização da Sociedade Civil",
                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("Governamental",
                                            "Não Governamental/Organização da Sociedade Civil"))) %>%
    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n))
}

grafico <- centro(ceconv_2016, q2, "2016") %>%
    bind_rows(centro(ceconv_2017, q2, "2017")) %>%
    bind_rows(centro(ceconv_2018, q_2, "2018")) %>%
    #bind_rows(centro(ceconv_2019, q2, "2019")) %>%
    bind_rows(centro(ceconv_2020, q27, "2020")) %>%
    bind_rows(centro(ceconv_2021, q27, "2021")) %>%
    bind_rows(centro(ceconv_2022, q27, "2022")) %>%

  #2019 - dado numerico

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)

```

Em 2016, 31,2% dos Centros de Convivência (2.636 unidades) possuíam rota acessível ao banheiro de acordo com a norma da ABNT (NBR9050), sendo a adaptação mais observada nas unidades. Todas as condições de acessibilidade melhoraram em relação aos anos anteriores, e o maior aumento foi verificado no percentual de Centros de Convivência com banheiros adaptados para pessoas com deficiência: estavam presentes em 24,3% das unidades em 2014 (1.918) e passaram a ser observados em 28,3% das unidades em 2016 (2.389) (Gráfico 30).


## Centro de Referência Especializada de Assistência Social -- CREAS

Os Centros de Referência Especializados de Assistência Social (CREAS) são unidades públicas estatais que ofertam serviços da Proteção Social Especial a pessoas e famílias em situação de risco pessoal ou social e/ou em situação de violação de direitos.

O Censo SUAS 2022 registrou 2.846 CREAS no país: um incremento de 679 novas unidades em relação aos últimos 10 anos. O gráfico abaixo \Cref{fig:creas-quantitativo} sinaliza esta evolução por Regiões do país.


```{r creas-quantitativo, fig.cap = "Evolução do quantitativo de CREAS, segundo grandes regiões; 2012, 2017 e 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

  grafico <- f_quantitativo_regiao_ano(creas_2012, IBGE, "2012") %>%
  bind_rows(f_quantitativo_regiao_ano(creas_2013, IBGE, "2013")) %>%
  bind_rows(f_quantitativo_regiao_ano(creas_2014, IBGE, "2014")) %>%
  #bind_rows(f_quantitativo_regiao_ano(creas_2015, IBGE, "2015")) %>%
  bind_rows(f_quantitativo_regiao_ano(creas_2016, IBGE7, "2016")) %>%
  bind_rows(f_quantitativo_regiao_ano(creas_2017, IBGE, "2017")) %>%
  bind_rows(f_quantitativo_regiao_ano(creas_2018, IBGE, "2018")) %>%
  bind_rows(f_quantitativo_regiao_ano(creas_2019, IBGE, "2019")) %>%
  bind_rows(f_quantitativo_regiao_ano(creas_2020, IBGE, "2020")) %>%
  bind_rows(f_quantitativo_regiao_ano(creas_2021, IBGE, "2021")) %>%
  bind_rows(f_quantitativo_regiao_ano(creas_2022, IBGE, "2022")) %>%
  f_grafico_col_group_numero(Região, n, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

De acordo com os dados do grafico \Cref{fig:CREAS-porte} na qual sinaliza o número de CREAS por município, levando-se em conta o porte populacional, verifica-se que 54% dos municípios não possuem CREAS. Eeles estão concetrados nos municípios de Pequeno Porte I e II respectivamente com 77% e 5,3% dos municípios que não possuem esta unidade especializada.


```{r CREAS-porte, fig.cap = "Percentual de municípios por número de CREAS, segundo porte populacional - Brasil, 2022", fig.footer = "Fonte: MDS, Censo SUAS; e IBGE, estimativas da população residente para os municípios"}

creas_municipios <- creas_2022 %>%
  select(IBGE7) %>%
  group_by(IBGE7) %>%
  summarise(n_creas=n())

porte_municipios <- pop_municipios_2017 %>%
  f_porte_populacional(`POPULAÇÃO ESTIMADA`) %>%
  mutate(IBGE7 = as.numeric(paste0(`COD. UF`, `COD. MUNIC`))) %>%
  select(IBGE7, Porte)

dados <- creas_municipios %>%
  full_join(porte_municipios, by = c("IBGE7" = "IBGE7")) %>%
  mutate(grupo = case_when(is.na(n_creas)~"Nenhum CREAS",
                            n_creas == 0~"Nenhum CREAS",
                            n_creas == 1~"1 CREAS",
                            n_creas <= 3~"De 2 a 3 CREAS",
                            n_creas <= 6~"De 4 a 6 CREAS",
                            n_creas <= 10~"De 7 a 10 CREAS",
                            n_creas > 10~"Mais de 10 CREAS",
                            TRUE~as.character(n_creas))) %>%
  mutate(grupo = factor(grupo, levels = c("Nenhum CREAS",
                                            "1 CREAS",
                                            "De 2 a 3 CREAS",
                                            "De 4 a 6 CREAS",
                                            "De 7 a 10 CREAS",
                                            "Mais de 10 CREAS"))) %>%
  group_by(Porte, grupo) %>%
  summarise(n=n()) #%>%
#  complete(grupo, fill = list(n=0))

niveis_porte <- dados$Porte %>%
  levels() %>%
  append("Brasil")

grafico <- dados %>%
  spread(Porte, n, fill = 0) %>%
  mutate("Brasil" = rowSums(.[2:6])) %>%
  gather("Porte","n",-grupo) %>%
  mutate(Porte = factor(Porte, levels = niveis_porte)) %>%
  group_by(Porte) %>%
  mutate("Percentual" = n/sum(n)) %>%

  f_grafico_col_stack_percent(Porte, Percentual, grupo, 2)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Ao observar a série histórica do \Cref{fig:creas-situacao}, é possível perceber que os imovéis próprios vem aumentando ao longo do tempo. Em 2012 eram 27% das unidades e, chegam em 2022 com 37%. Ao passo que os imóveis próprios aumentam em 10% pontos percentuais, os imovéis alugados descrecem neste mesmo ponto computado no censo suas de 2022 com 57% das undiades alugadas.Há também registros de imoveis cedidos na qual ao longo dos anos sinalziam um leva aumento.\footnote{Para os anos de 2018 e 2019 esse dado não foi computado no censo suas}

```{r creas-situacao, fig.cap = "Evolução dos CREAS segundo situação do imóvel – Brasil; 2012, 2017 e 2022",fig.footer = "Fonte: MDS, Censo SUAS."}

#grafico <- f_equip_imovel(creas_2012, q5, "2012") %>%
  #bind_rows(f_equip_imovel(creas_2008, situacao_imovel, "2008")) %>%
  #bind_rows(f_equip_imovel(creas_2009, q5_situac_imovel, "2009")) %>%
  #bind_rows(f_equip_imovel(creas_2010, q5, "2010")) %>%
  #bind_rows(f_equip_imovel(creas_2011, q5, "2011")) %>%
grafico <- f_equip_imovel(creas_2012, q5, "2012") %>%
  #bind_rows(f_equip_imovel(creas_2013, q5, "2013")) %>%
  bind_rows(f_equip_imovel(creas_2014, q4, "2014")) %>%
  bind_rows(f_equip_imovel(creas_2015, q4, "2015")) %>%
  bind_rows(f_equip_imovel(creas_2016, q4, "2016")) %>%
  bind_rows(f_equip_imovel(creas_2017, q4, "2017")) %>%
  #bind_rows(f_equip_imovel(creas_2018, q3, "2018")) %>%
  # bind_rows(f_equip_imovel(creas_2019, q4, "2019")) %>%
  bind_rows(f_equip_imovel(creas_2020, q3, "2020")) %>%
  bind_rows(f_equip_imovel(creas_2021, q3, "2021")) %>%
  bind_rows(f_equip_imovel(creas_2022, q3, "2022")) %>%

  # não há essa pergunta: 2018,2019

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

De acordo com os dados do Censo SUAS de 2012, 33% dos CREAS possuíam banheiro adaptado para pessoas com mobilidade reduzida. Em 2022 há um crescimento de 22 pontos percentuais em relação ao ano de 2012, com 55% dos CREAS com essa estrutura adptada.\footnote{foram considerados acesso adptado os imóveis que informam possui acessibildiade, de acordo com a norma ABNT ou não}

A presença de acesso principal adaptado com rota ascessível aos espaços (recepção, salas de atendimento e espaços de uso coletivo) é a mais presente nas unidades de CREAS com destaque para 83% no CENSO SUAS  de 2022.

O grafico \Cref{fig:creas-acessibilidade} referencia outras adpções como com rampas, rota acessível e calçada e de rota acessível ao banheiro. todas essas adaquações amliaram a acessibildiade ao longo dos anos.


```{r creas-acessibilidade, fig.cap = "Evolução percentual de CREAS com condições de acessibilidade - Brasil; 2012, 2017 e 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

#tabela <- equip_acessibilidade(creas_2010, q9_1, "2010", "1") %>%
#  bind_rows(equip_acessibilidade(creas_2010, q9_2, "2010", "2")) %>%
#  bind_rows(equip_acessibilidade(creas_2010, q9_3, "2010", "3")) %>%
#  bind_rows(equip_acessibilidade(creas_2010, q9_4, "2010", "4")) %>%
tabela <- equip_acessibilidade(creas_2012, q10a, "2012", "1") %>%
  bind_rows(equip_acessibilidade(creas_2012, q10b, "2012", "2")) %>%
  bind_rows(equip_acessibilidade(creas_2012, q10c, "2012", "3")) %>%
  bind_rows(equip_acessibilidade(creas_2012, q10d, "2012", "4")) %>%
  bind_rows(equip_acessibilidade(creas_2017, q9.1, "2017", "1")) %>%
  bind_rows(equip_acessibilidade(creas_2017, q9.2, "2017", "2")) %>%
  bind_rows(equip_acessibilidade(creas_2017, q9.3, "2017", "3")) %>%
  bind_rows(equip_acessibilidade(creas_2017, q9.4, "2017", "4")) %>%
  bind_rows(equip_acessibilidade(creas_2022, q9_1, "2022", "1")) %>%
  bind_rows(equip_acessibilidade(creas_2022, q9_2, "2022", "2")) %>%
  bind_rows(equip_acessibilidade(creas_2022, q9_3, "2022", "3")) %>%
  bind_rows(equip_acessibilidade(creas_2022, q9_4, "2022", "4")) %>%
  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=34))

ordenado<-tabela %>%
  filter(Ano == 2022) %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  f_grafico_col_percent_flip(Categoria, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```
O gráfico abaixo  \Cref{fig:CREAS-acessibilidade-situacao} através do Censo SUAS 2022 apurou a situação do imóvel com a presença das condições de acessibilidade. Os dados sinalizam que a acessibilidade é mais presente em imovéis próprios.

```{r CREAS-acessibilidade-situacao, fig.cap = "Evolução percentual de CREAS com condições de acessibilidade por situação do imóvel – Brasil, 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

tabela <- equip_acessibilidade_situacao(creas_2022, q3, q9_1, "1") %>%
  bind_rows(equip_acessibilidade_situacao(creas_2022, q3, q9_2, "2")) %>%
  bind_rows(equip_acessibilidade_situacao(creas_2022, q3, q9_3, "3")) %>%
  bind_rows(equip_acessibilidade_situacao(creas_2022, q3, q9_4, "4"))

ordenado<-tabela %>%
  filter(Situacao == "Próprio") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = rev(ordenado))) %>%
  f_grafico_col_group_percent(Situacao, Percentual, Categoria, 4)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```


A existência de computadores com acesso à internet é um importante aspecto a ser observado quando se avalia a infraestrutura dos CREAS. Em 2022, 99% dos CREAS possuem computadores com acesso à internet conforme \Cref{fig:CREAS-internet-percentual}. Números que avançou em todas as regiões, em especial, na Região Norte conforme linha histórica desta evolução apresentada no gráfico abaixo.

```{r CREAS-internet-percentual, fig.cap = "Evolução percentual de CREAS com computadores com acesso à internet – Brasil, 2012 - 2022", fig.footer = "Fonte: MDS, Censo SUAS."}



grafico <- f_maior0_regiao_ano(creas_2012, q14, Região, "2012") %>%
  bind_rows(f_maior0_regiao_ano(creas_2017, q13, IBGE, "2017")) %>%
  bind_rows(f_maior0_regiao_ano(creas_2022, q12_2, IBGE, "2022")) %>%

  f_grafico_col_group_percent(Região, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```



```{r creas-qtd_munic, fig.cap = "Evolução do quantitativo de CREAS; Brasil e grandes regiões; 2012, 2017 e 2022", fig.footer = "Fonte: MDS, Censo SUAS.", eval=FALSE}

#grafico <- f_percentual_municipios_regiao_ano(creas_2007, ibge, "2007") %>%
 #bind_rows(f_percentual_municipios_regiao_ano(creas_2008, IBGE, "2008")) %>%
 # bind_rows(f_percentual_municipios_regiao_ano(creas_2009, IBGE, "2009")) %>%
 # bind_rows(f_percentual_municipios_regiao_ano(creas_2010, ibge, "2010")) %>%
 #bind_rows(f_percentual_municipios_regiao_ano(creas_2011, IBGE, "2011")) %>%
grafico <- f_percentual_municipios_regiao_ano(creas_2012, IBGE, "2012") %>%
  bind_rows(f_percentual_municipios_regiao_ano(creas_2013, IBGE, "2013")) %>%
  bind_rows(f_percentual_municipios_regiao_ano(creas_2014, IBGE, "2014")) %>%
#  bind_rows(f_percentual_municipios_regiao_ano(creas_2015, IBGE, "2015")) %>%
  bind_rows(f_percentual_municipios_regiao_ano(creas_2016, IBGE7, "2016")) %>%
  bind_rows(f_percentual_municipios_regiao_ano(creas_2017, IBGE, "2017")) %>%
  bind_rows(f_percentual_municipios_regiao_ano(creas_2018, IBGE, "2018")) %>%
  bind_rows(f_percentual_municipios_regiao_ano(creas_2019, IBGE, "2019")) %>%
  bind_rows(f_percentual_municipios_regiao_ano(creas_2020, IBGE, "2020")) %>%
  bind_rows(f_percentual_municipios_regiao_ano(creas_2021, IBGE, "2021")) %>%
  bind_rows(f_percentual_municipios_regiao_ano(creas_2022, IBGE, "2022")) %>%

  ggplot(aes(x = Região, y = Percentual, group = Ano)) +
  geom_col(aes(fill = Ano), position="dodge") +
  geom_text(aes(label = percent(Percentual), y=Percentual+0.04), position = position_dodge(width = 0.9), angle = 90, size = 2.5) +
  scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
  theme(legend.position="bottom",
        legend.title = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text.y = element_blank(),
        axis.line.x = element_line(),
        panel.background = element_blank()) +
  guides(fill=guide_legend(nrow=1,byrow=TRUE))

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r CREAS-quantidade-municipios, fig.cap = "Evolução do quantitativo de municípios com CREAS, Brasil e grandes regiões - 2012, 2017 e 2022", fig.footer = "Fonte: MDS, Censo SUAS"}

grafico <- f_percentual_municipios_regiao_ano(creas_2012, IBGE, "2012") %>%
  bind_rows(f_percentual_municipios_regiao_ano(creas_2017, IBGE, "2017")) %>%
  bind_rows(f_percentual_municipios_regiao_ano(creas_2022, IBGE, "2022")) %>%
  f_grafico_col_group_numero(Região, n, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```


A oferta regionalizada de CREAS é uma estratégia que objetiva garantir a universalização do acesso e integralidade do antendimento da proteção socioassistencia especializada. Estar prevista através da Resolução 31/2013 do CNAS. Essa composição é organziada atarvés dos entes estaduais e o  \Cref{fig:creas-regionais} sinaliza a evolução dessa oferta.


```{r creas-regionais, fig.cap = "Evolução do quantitativo de CREAS Regionais, Brasil e grandes regiões - 2012, 2017 e 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

grafico <- f_selecao_regiao_ano(creas_2012, q2, "Regional", Região, "2012") %>%
  bind_rows(f_selecao_regiao_ano(creas_2017, q2, "Regional", Região, "2017")) %>%
#  bind_rows(f_selecao_regiao_ano(creas_2018, q1, "Regional", Região, "2018")) %>%
#  bind_rows(f_selecao_regiao_ano(creas_2019, q1, "Regional", Região, "2019")) %>%
#  bind_rows(f_selecao_regiao_ano(creas_2020, q1, "Regional", Região, "2020")) %>%
  bind_rows(f_selecao_regiao_ano(creas_2021, q1, "Regional", Regiao, "2021")) %>%
  bind_rows(f_selecao_regiao_ano(creas_2022, q1, "Regional", Região, "2022")) %>%
  f_grafico_col_group_numero(Região, n, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```


## Centro de Referência Especializado para População em Situação de Rua -- Centro POP

Os Centros de Referência Especializados para População em Situação de Rua (Centros POP) são unidades públicas que oferecem atendimento especializado para a população em situação de rua, no âmbito da proteção social especial de média complexidade.

Entre 2012 e 2022 o número de Centros POP cresceu, passando de 105 unidades para 237 no período. O \Cref{fig:quantitativo-CentroPop}sinaliza a essa evolução na escala de a cada 5 anos por Regiões do Brasil.


```{r quantitativo-CentroPop, fig.cap = "Evolução do quantitativo de Centro Pop, 2012 a 2022", fig.footer = "Fonte: MDS, Censo SUAS",eval=FALSE}

grafico <- f_quantitativo_regiao_ano(cpop_2012, Região, "2012") %>%
   #bind_rows(f_quantitativo_regiao_ano(cpop_2011, IBGE, "2011")) %>%)
   #bind_rows(f_quantitativo_regiao_ano(cpop_2013, Região, "2013")) %>%
   #bind_rows(f_quantitativo_regiao_ano(cpop_2014, IBGE, "2014")) %>%
   #bind_rows(f_quantitativo_regiao_ano(cpop_2015, IBGE, "2015")) %>%
   #bind_rows(f_quantitativo_regiao_ano(cpop_2016, IBGE, "2016")) %>%
   bind_rows(f_quantitativo_regiao_ano(cpop_2017, Região, "2017")) %>%
   #bind_rows(f_quantitativo_regiao_ano(cpop_2018, Região, "2018")) %>%
   #bind_rows(f_quantitativo_regiao_ano(cpop_2019, Região, "2019")) %>%
   #bind_rows(f_quantitativo_regiao_ano(cpop_2020, IBGE, "2020")) %>%
   #bind_rows(f_quantitativo_regiao_ano(cpop_2021, IBGE, "2021")) %>%
    bind_rows(f_quantitativo_regiao_ano(cpop_2022, IBGE, "2022")) %>%
  f_grafico_col_group_numero(Região, n, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```
Os Centro Pop estão presentes em municípios de grande porte e metrópoles, o \Cref{fig:cpop-porte} sinalzia que 59% dos municípios de grande poirte possui pelo menos uma unidade, e para metropoles 100% possuem unidades de centro pop, sendo 59% entre duas a três unidades, 24% uma unidade e 18% de 4 a 6 undiades de Centro Pop. Há presenta também em múnicípios de médio porte, com destaque para 5,9% dos municípios.

```{r cpop-porte, fig.cap = "Percentual de municípios por número de Centro POP, segundo porte populacional - Brasil, 2022", fig.footer = "Fonte: MDS, Censo SUAS; e IBGE, estimativas da população residente para os municípios"}

cpop_municipios <- cpop_2022 %>%
  select(IBGE7) %>%
  group_by(IBGE7) %>%
  summarise(n_centropop=n())

porte_municipios <- pop_municipios_2017 %>%
  f_porte_populacional(`POPULAÇÃO ESTIMADA`) %>%
  mutate(IBGE7 = as.numeric(paste0(`COD. UF`, `COD. MUNIC`))) %>%
  select(IBGE7, Porte)

dados <- cpop_municipios %>%
  full_join(porte_municipios, by = c("IBGE7" = "IBGE7")) %>%
  mutate(grupo = case_when(is.na(n_centropop)~"Nenhum Centro POP",
                            n_centropop == 0~"Nenhum Centro POP",
                            n_centropop == 1~"1 Centro POP",
                            n_centropop <= 3~"De 2 a 3 Centro POP",
                            n_centropop <= 6~"De 4 a 6 Centro POP",
                            n_centropop <= 10~"De 7 a 10 Centro POP",
                            n_centropop > 10~"Mais de 10 Centro POP",
                            TRUE~as.character(n_centropop))) %>%
  mutate(grupo = factor(grupo, levels = c("Nenhum Centro POP",
                                            "1 Centro POP",
                                            "De 2 a 3 Centro POP",
                                            "De 4 a 6 Centro POP",
                                            "De 7 a 10 Centro POP",
                                            "Mais de 10 Centro POP"))) %>%
  group_by(Porte, grupo) %>%
  summarise(n=n()) #%>%
#  complete(grupo, fill = list(n=0))

niveis_porte <- dados$Porte %>%
  levels() %>%
  append("Brasil")

grafico <- dados %>%
  spread(Porte, n, fill = 0) %>%
  mutate("Brasil" = rowSums(.[2:6])) %>%
  gather("Porte","n",-grupo) %>%
  mutate(Porte = factor(Porte, levels = niveis_porte)) %>%
  group_by(Porte) %>%
  mutate("Percentual" = n/sum(n)) %>%

  f_grafico_col_stack_percent(Porte, Percentual, grupo, 2)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Em relação a acessibilidade dos Centro Pop o \Cref{fig:cpop-acessibilidade-situacao} relaciona esta adaptação com a situação do imóvel. No geral todoas as adaptações de acessibildiade são superiores ao serem relacionadas com os imóveis alugados. Em relação aos imóveis cedidos, a adaptação de banheiro se sobressai em relação as demais situações dos imóveis.


```{r cpop-acessibilidade-situacao, fig.cap = "Percentual de Centros POP com condições de acessibilidade segundo situação do imóvel – Brasil, 2022", fig.footer = "Fonte: MDS, Censo SUAS.",eval=FALSE}

tabela <- equip_acessibilidade_situacao(cpop_2022, q1, q7_1, "1") %>%
  bind_rows(equip_acessibilidade_situacao(cpop_2022, q1, q7_2, "2")) %>%
  bind_rows(equip_acessibilidade_situacao(cpop_2022, q1, q7_3, "3")) %>%
  bind_rows(equip_acessibilidade_situacao(cpop_2022, q1, q7_4, "4"))

ordenado<-tabela %>%
  filter(Situacao == "Próprio") %>%
  arrange(Percentual) %>%
  select(Categoria)

ordenado<-factor(ordenado, levels = ordenado$Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = rev(levels(ordenado)))) %>%
  ggplot(aes(x = Situacao, y = Percentual, group = Categoria)) +
  geom_col(aes(fill = Categoria), position = "dodge") +
  geom_text(aes(label = label_percent(accuracy = 0.1, decimal.mark = ",")(Percentual)), vjust = -0.2, position = position_dodge(width = 0.9)) +
  scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
  theme(legend.position="bottom",
        legend.title = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text.y = element_blank(),
        axis.line.x = element_line(),
        panel.background = element_blank()) +
  guides(fill=guide_legend(nrow=4, byrow=TRUE))

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Em 2016,95% dos Centros Pop destacam computador com acesso à internet em 2022. O gráfico \Cref{fig:cpop-internet-percentual} referencia essa evolução por Regiões do Brasil, as regiões Centro Oeste e Sul possuem 100% das undiades com acesso a internet e a região Norte com maior desafio de acesso, com 75% das unidades de Centro Pop com acesso a internet.

```{r cpop-internet-percentual, fig.cap = "Percentual de Computadores nos Centro Pop com acesso a internet, 2012 a 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

grafico <- f_maior0_regiao_ano(cpop_2012, q14_2, Região, "2012") %>%
  bind_rows(f_maior0_regiao_ano(cpop_2017, q11.2, IBGE, "2017")) %>%
  bind_rows(f_maior0_regiao_ano(cpop_2022, q10_2, IBGE, "2022")) %>%

  f_grafico_col_group_percent(Região, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)


```


## Centro-Dia

Centro Dia são unidades públicas especializadas para qtender pessoas com deficiência e suas famílias. Ela estar inserida no ambito da proteção social espceial de média complexidade. No ano de 2015 identifica-se no Brasil 1.340 unidades. Em 2022 há um crescimento de 40,7% destas undiades conforme pdoe ser observada no grafico \Cref{fig:quantitativo-Centrodia}.



```{r quantitativo-Centrodia, fig.cap = "Evolução do quantitativo de Centro dia, segundo grandes regiões; 2015 a 2022", fig.footer = "Fonte: MDS, Censo SUAS.",eval=FALSE}

grafico <- f_quantitativo_regiao_ano(cedia_2015, Região, "2015") %>%
   bind_rows(f_quantitativo_regiao_ano(cedia_2016, Região, "2016")) %>%
   bind_rows(f_quantitativo_regiao_ano(cedia_2017, IBGE, "2017")) %>%
   bind_rows(f_quantitativo_regiao_ano(cedia_2018, IBGE, "2018")) %>%
   bind_rows(f_quantitativo_regiao_ano(cedia_2019, IBGE, "2019")) %>%
   #bind_rows(f_quantitativo_regiao_ano(cedia_2020, IBGE, "2020")) %>%
   bind_rows(f_quantitativo_regiao_ano(cedia_2021, IBGE, "2021")) %>%
   #bind_rows(f_quantitativo_regiao_ano(cedia_2022, IBGE, "2022")) %>%
  f_grafico_col_group_numero(Região, n, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Em relação a natureza destas unidades, o \Cref{fig:cdia-natureza} sinaliza a frequencia histórica de unidades referenciadas pelas Organizações da Sociedade Civil (OSCs). Das undiades destacadas no Censo SUAS 2022, 92,8% são ofertadas por OSCs.


```{r cdia-natureza, fig.cap = "Quantitativo de Centros Dia por Natureza da Unidade - BRASIL, 2015 a 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

centrodia  = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == "Não Governamental"~"Não Governamental/Organização da Sociedade Civil",
                             Nível == "Não-Governamental"~"Não Governamental/Organização da Sociedade Civil",
                             Nível == "Não-Governamental/Organização da Sociedade Civil"~"Não Governamental/Organização da Sociedade Civil",
                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("Governamental",
                                            "Não Governamental/Organização da Sociedade Civil"))) %>%
    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n))
}

grafico <- centrodia(cedia_2015, q6, "2015") %>%
  bind_rows(centrodia(cedia_2016, q4, "2016")) %>%
#  bind_rows(centrodia(cedia_2017, q4, "2017")) %>%
  bind_rows(centrodia(cedia_2018, q_4, "2018")) %>%
  bind_rows(centrodia(cedia_2019, q4, "2019")) %>%
  bind_rows(centrodia(cedia_2020, q4, "2020")) %>%
  bind_rows(centrodia(cedia_2021, q4, "2021")) %>%
#  bind_rows(centrodia(cedia_2022, q4, "2022")) %>%

  #2017 não identifiquei essa pergunta
  #2022 dados númericos

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)

```

Em relação a acessibilidade destas unidades, o banheiro acessivel é a adaptação mais presentes nestas unidades chegando nos registros do Censo SUAS de 2022 com 73%. Como trata-se de unidades especializadas para atenção a pessoas com deficiência, esse item é de funmental importância para assegurar acolhida e segurança a este público e suas famílias. O \Cref{fig:cdia-acessibilidade} sinaliza os locais e composição de acessibilidade, estes dados sinalizam um desafio para garantir as condições físicas de acesso ao público de pessoas com deficiência nas undiades de Centro Dia.


```{r cdia-acessibilidade, fig.cap = "Evolução percentual de Centro Dia com condições de acessibilidade - Brasil; 2015, 2018 e 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

tabela <- equip_acessibilidade(cedia_2015, q20_1, "2015", "1") %>%
  bind_rows(equip_acessibilidade(cedia_2015, q20_2, "2015", "2")) %>%
  bind_rows(equip_acessibilidade(cedia_2015, q20_3, "2015", "3")) %>%
  bind_rows(equip_acessibilidade(cedia_2015, q20_4, "2015", "4")) %>%
  bind_rows(equip_acessibilidade(cedia_2018, q_19_1, "2018", "1")) %>%
  bind_rows(equip_acessibilidade(cedia_2018, q_19_2, "2018", "2")) %>%
  bind_rows(equip_acessibilidade(cedia_2018, q_19_3, "2018", "3")) %>%
  bind_rows(equip_acessibilidade(cedia_2018, q_19_4, "2018", "4")) %>%
  bind_rows(equip_acessibilidade(cedia_2022, q15_1, "2022", "1")) %>%
  bind_rows(equip_acessibilidade(cedia_2022, q15_2, "2022", "2")) %>%
  bind_rows(equip_acessibilidade(cedia_2022, q15_3, "2022", "3")) %>%
  bind_rows(equip_acessibilidade(cedia_2022, q15_4, "2022", "4")) %>%
  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=34))

ordenado<-tabela %>%
  filter(Ano == 2022) %>%
  arrange(Percentual) %>%
  select(Categoria)

ordenado<-factor(ordenado, levels = ordenado$Categoria)

ordenado2<-tabela %>%
  select(Ano) %>%
  distinct() %>%
  arrange(Ano)

ordenado2<-factor(ordenado2, levels = ordenado2$Ano)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = levels(ordenado))) %>%
  mutate(Ano = factor(Ano, levels = rev(levels(ordenado2)))) %>%
  f_grafico_col_percent_flip(Categoria, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```



Além disto, há outras adaptações importantes netsas undiades, coo tecnologias assistidas, suportes com materiais em Braile, profissionais com conhecimento em Libras entre outros destacados no grafico abaixo:

<!-- preciso descobrir o erro -->


```{r cdia_adaptações, fig.cap = "Quantidade de Centro Dia, segundo outras adaptações - Brasil, 2015, 2018 e 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

cdia_adp= function(df, q, ano, cod_categoria){
  q <- enquo(q)
  ano <- quo_name(ano)
  cod_categoria <- quo_name(cod_categoria)

#2022
  categoria <- case_when(!! cod_categoria == "1"~"Sim, suporte de profissional com conhecimento em LIBRAS",
                         !! cod_categoria == "2"~"Sim, suporte de material em Braille",
                         !! cod_categoria == "3"~"Sim, suporte para leitores de telas de computador para pessoas com deficiência visual",
                         !! cod_categoria == "4"~"Sim, outras adaptações e tecnologias assistivas para deficiência física",
                         !! cod_categoria == "5"~"Sim, outras adaptações e tecnologias assistivas para deficiência intelectual e autismo",
                         !! cod_categoria == "6"~"Sim, pisos especiais com relevos para sinalização voltados pessoa com  deficiência visual",
                         !! cod_categoria == "7"~"Não há ações específicas")


  df %>%
    select(!! q) %>%
    filter(!is.na(!! q)) %>%
    group_by(!! q) %>%
    summarise(n=n()) %>%
    mutate(Percentual = n/sum(n)) %>%
    filter(!! q == "Sim") %>%
    mutate("Categoria" = categoria, "Ano" = !! ano)
}

 tabela <- cdia_adp (cedia_2015,q21_1,"2015","1") %>%
  bind_rows(cdia_adp(cedia_2015,q21_2,"2015","2")) %>%
  bind_rows(cdia_adp(cedia_2015,q21_3,"2015","3")) %>%
  bind_rows(cdia_adp(cedia_2015,q21_4,"2015","4")) %>%
  bind_rows(cdia_adp(cedia_2015,q21_5,"2015","5")) %>%
  bind_rows(cdia_adp(cedia_2015,q21_6,"2015","6")) %>%
  bind_rows(cdia_adp(cedia_2015,q21_7,"2015","7")) %>%


  bind_rows(cdia_adp(cedia_2018,q_20_1,"2018","1")) %>%
  bind_rows(cdia_adp(cedia_2018,q_20_2,"2018","2")) %>%
  bind_rows(cdia_adp(cedia_2018,q_20_3,"2018","3")) %>%
  bind_rows(cdia_adp(cedia_2018,q_20_4,"2018","4")) %>%
  bind_rows(cdia_adp(cedia_2018,q_20_5,"2018","5")) %>%
  bind_rows(cdia_adp(cedia_2018,q_20_6,"2018","4")) %>%
  bind_rows(cdia_adp(cedia_2018,q_20_0,"2018","5")) %>%


  bind_rows(cdia_adp(cedia_2022,q16_1,"2022","1")) %>%
  bind_rows(cdia_adp(cedia_2022,q16_2,"2022","2")) %>%
  bind_rows(cdia_adp(cedia_2022,q16_3,"2022","3")) %>%
  bind_rows(cdia_adp(cedia_2022,q16_4,"2022","4")) %>%
  bind_rows(cdia_adp(cedia_2022,q16_5,"2022","5")) %>%
  bind_rows(cdia_adp(cedia_2022,q16_6,"2022","6")) %>%
  bind_rows(cdia_adp(cedia_2022,q16_7,"2022","7")) %>%




  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=51))

ordenado<-tabela %>%
  filter(Ano == "2020") %>%
  arrange(Percentual) %>%
  select(Categoria)

ordenado<-factor(ordenado, levels = ordenado$Categoria)

ordenado2<-tabela %>%
  select(Ano) %>%
  distinct() %>%
  arrange(Ano)

ordenado2<-factor(ordenado2, levels = ordenado2$Ano)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = levels(ordenado))) %>%
  mutate(Ano = factor(Ano, levels = rev(levels(ordenado2)))) %>%
  f_grafico_col_percent_flip(Categoria, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```



## Serviços de Proteção Social Especial -- Alta Complexidade

Os serviços de Proteção Social Especial de Alta Complexidade são organizados em diferentes modalidades de equipamentos, conforme o público, e destinam-se a famílias e/ou indivíduos afastados temporariamente do núcleo familiar e/ou comunitários de origem. O Plano Individual de Atendimento (PIA) é um instrumento que norteia as ações a serem realizadas para viabilizar a proteção integral, a reinserção familiar e comunitária e a autonomia de crianças e adolescentes afastados dos cuidados parentais e sob proteção de serviços de acolhimento.

É uma estratégia de planejamento que, a partir do estudo aprofundado de cada caso, compreende a singularidade dos sujeitos e organiza as ações e atividades a serem desenvolvidas com a criança/adolescente e sua família durante o período de acolhimento.


As atividades que, segundo relato das 5.781 unidades de acolhimento existentes no país em 2016, tiveram maior percentual de unidades que as promoveram sistematicamente, foram: elaboração de relatórios técnicos sobre casos em acompanhamento, relatado por 85,9% das unidades; discussão de casos com outros profissionais da rede, relatado por 85,2% das unidades; encaminhamento para retirada de documentos, relatado por 82,9% das unidades e passeios com usuários, relatado por 82,5% das unidades. As atividades que tiveram menor percentual de unidades que relataram que as promoveram sistematicamente, foram: envio de relatório semestral para o judiciário (exclusivo para acolhimento de criança ou adolescente) e realização de reuniões com grupos de famílias dos usuários, relatadas por 49,0% e 45,1% das unidades, respectivamente. 0,9% das unidades relataram que não realizam nenhuma das atividades listadas (Gráfico 121). Gráfico 121 - Percentual de Unidades de Acolhimento segundo tipo de atividade promovida sistematicamente - Brasil, 2016 Fonte: MDS, Censo SUAS.

O Serviço de Acolhimento em Família Acolhedora "organiza o acolhimento de crianças e adolescentes, afastados da família por medida de proteção, em residência de famílias acolhedoras cadastradas. É previsto até que seja possível o retorno à família de origem ou, na sua impossibilidade, o encaminhamento para adoção. O serviço é o responsável por selecionar, capacitar, cadastrar e acompanhar as famílias acolhedoras, bem como realizar o acompanhamento da criança e/ou adolescente acolhido e sua família de origem." 22 Em todo Brasil, apenas 9,5% dos municípios possuíam, em 2016, serviço de acolhimento em família acolhedora para criança e adolescente, sendo que 7,9% dos municípios possuíam o serviço e ele era regulamentado por lei municipal. A região com maior percentual de municípios que possuíam esse serviço era a Sul, com 16,0%, sendo que em 15,0% o serviço era regulamentado por lei municipal, seguida da região Sudeste, também com percentuais de municípios que possuíam o serviço acima do percentual nacional. As regiões Nordeste e Centro-Oeste tinham os menores percentuais de municípios que possuíam o serviço, apenas 3,7% no Nordeste e 4,8% no Centro-Oeste, sendo que em ambas apenas 2,4% dos municípios possuíam o serviço tendo ele regulamentado por lei municipal (Gráfico 122). Gráfico 122 - Percentual de municípios que possuem Serviço de Acolhimento em Família Acolhedora para Criança e Adolescente, e que possuem esse serviço regulamentado por lei municipal, segundo grandes regiões - Brasil, 2016 Fonte: MDS, Censo SUAS.

522 municípios brasileiros em 2016 possuíam serviço de acolhimento em família acolhedora para criança e adolescente. Desses, um terço não tinha nenhuma família cadastrada pelo serviço e aptas a receber as crianças ou adolescentes com medidas protetivas. Quase a metade, 49,6%, desses 522 municípios tinham apenas de 1 a 5 famílias cadastradas e aptas a receber as crianças ou adolescentes. Apenas 0,6% dos 522 municípios tinham mais de 50 famílias cadastradas pelo serviço e aptas a receber as crianças ou adolescentes (Gráfico 123). Gráfico 123 - Percentual de municípios segundo quantidade de famílias no município cadastradas pelo Serviço de Acolhimento em Família Acolhedora para Criança e Adolescente e aptas a receber as crianças/adolescentes com medidas protetivas - Brasil, 2016 Fonte: MDS, Censo SUAS.

55,0% dos 522 municípios brasileiros que em 2016 possuíam serviço de acolhimento em família acolhedora para crianças e adolescentes não tinham nenhuma criança ou adolescente sendo acolhidas por meio do serviço no município. Quase um terço, ou 32,0% desses 522 municípios tinham apenas de 1 a 5 crianças ou adolescentes sendo acolhidas por meio do serviço. Apenas 0,8% dos 522 municípios tinham mais de 50 crianças ou adolescentes sendo acolhidas (Gráfico 124). Gráfico 124 - Percentual de municípios por quantidade de crianças/adolescentes que estão sendo acolhidas por meio do Serviço de Família Acolhedora no município - Brasil, 2016 Fonte: MDS, Censo SUAS.

Considerações Finais Os dados do Censo SUAS 2016 revelaram uma significativa aceleração no crescimento do percentual de CRAS que concederam benefícios eventuais (Gráfico 109), crescimento que vinha ocorrendo entre 2010 e 2015, mas em ritmo bem mais lento. Os maiores crescimentos observados foram no percentual de CRAS que concederam auxílio funeral, que cresceu 10,9 pontos percentuais, e que concederam auxílios relacionados à segurança alimentar, que cresceu 10,8 pontos percentuais. Por outro lado, foi observada queda no percentual de CRAS que executavam diretamente os Serviços de Convivência e Fortalecimento de Vínculos (Gráfico 102), que se aproximou dos menores percentuais da série histórica, observados em 2009 e 2010.

UNIDADES DE ACOLHIMENTO As Unidades de Acolhimento são equipamentos que prestam serviços de proteção social especial de alta complexidade, atendendo pessoas e/ou famílias com vínculos familiares rompidos ou fragilizados, ou que estejam em situação de abandono, ameaça ou violação de direitos, de forma a garantir sua proteção integral. As informações sobre as Unidades de Acolhimento começaram a ser coletadas pelo Censo Suas a partir do ano de 2012. Entre 2012 e 2016 foram criadas 1.254 novas Unidades, sendo 5.614 no total. A maior concentração de unidades no ano de 2016 é na região Sudeste do país, com 2.990 Unidades de Acolhimento.

<!-- preciso descobrir o erro -->

```{r unac-natureza, fig.cap = "Quantidade de Unidades de Acolhimento por Público Atendido  - 2014 - 2022", fig.footer = "Fonte: MDS, Censo SUAS."}





```


No que se refere a quantidade total destas unidades de acolhimento por porte populacional, destaca-se que há concentração nos municípios com porte populacional maiores. Todas as metrópoles possuem registro de mais de 10 unidades. O \Cref{fig:unac-porte} também sinaliza que 74% dos municípios de pequeno porte I não dispõem de serviços de alta complexidade.

Para os municípios menores a Resolução 31/2013 do CNAS sinaliza sobre a oferta regionalizada sobre a expansão qualificada dos serviços de Alta Complexidade para Criança e Adolescentes. Para esses municípios, faz-se importante diagnóstico para analise de oferta regionalziada desta unidade de alta complexidade.


```{r unac-porte, fig.cap = "Quantidade de Unidades de Acolhimento, segundo porte populacional - Brasil, 2022", fig.footer = "Fonte: MDS, Censo SUAS; e IBGE, estimativas da população residente para os municípios"}

unac_municipios <- unac_2022 %>%
  select(IBGE7) %>%
  group_by(IBGE7) %>%
  summarise(n_unac=n())

porte_municipios <- pop_municipios_2017 %>%
  f_porte_populacional(`POPULAÇÃO ESTIMADA`) %>%
  mutate(IBGE7 = as.numeric(paste0(`COD. UF`, `COD. MUNIC`))) %>%
  select(IBGE7, Porte)

dados <- unac_municipios %>%
  full_join(porte_municipios, by = c("IBGE7" = "IBGE7")) %>%
  mutate(grupo = case_when(is.na(n_unac)~"Nenhuma Unidade de Acolhimento",
                            n_unac == 0~"Nenhuma Unidade de Acolhimento",
                            n_unac == 1~"1 Unidade de Acolhimento",
                            n_unac <= 3~"De 2 a 3 Unidades de Acolhimento",
                            n_unac <= 6~"De 4 a 6 Unidades de Acolhimento",
                            n_unac <= 10~"De 7 a 10 Unidades de Acolhimento",
                            n_unac > 10~"Mais de 10 Unidades de Acolhimento",
                            TRUE~as.character(n_unac))) %>%
  mutate(grupo = factor(grupo, levels = c("Nenhuma Unidade de Acolhimento",
                                            "1 Unidade de Acolhimento",
                                            "De 2 a 3 Unidades de Acolhimento",
                                            "De 4 a 6 Unidades de Acolhimento",
                                            "De 7 a 10 Unidades de Acolhimento",
                                            "Mais de 10 Unidades de Acolhimento"))) %>%
  group_by(Porte, grupo) %>%
  summarise(n=n()) #%>%
#  complete(grupo, fill = list(n=0))

niveis_porte <- dados$Porte %>%
  levels() %>%
  append("Brasil")

grafico <- dados %>%
  spread(Porte, n, fill = 0) %>%
  mutate("Brasil" = rowSums(.[2:6])) %>%
  gather("Porte","n",-grupo) %>%
  mutate(Porte = factor(Porte, levels = niveis_porte)) %>%
  group_by(Porte) %>%
  mutate("Percentual" = n/sum(n)) %>%

  f_grafico_col_stack_percent(Porte, Percentual, grupo, 3)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

A maioria das Unidades de Acolhimento são executadas por Organizações da Sociedade Cívil (Osc). Esse percentual teve uma redução entre 2012 e 2022. Em 2012 estes dados sinalizam percentual de 66,4% das unidades de acolhimento com execução de OSC, registrando em 2022 63,4% conforme \Cref{fig:acolh_nat}


```{r acolh_nat, fig.cap = "Quantitativo de Acolhimento Institucional por Natureza da Unidade - BRASIL, 2012 a 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

acolh_nat  = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == "Não Governamental"~"Não Governamental/Organização da Sociedade Civil",
                             Nível == "Não-Governamental"~"Não Governamental/Organização da Sociedade Civil",
                             Nível == "Governamental Municipal ou do Distrito Federal"~"Governamental",
                             Nível == "Governamental Estadual"~"Governamental",
                             Nível == "Não-Governamental/Organização da Sociedade Civil"~"Não Governamental/Organização da Sociedade Civil",
                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("Governamental",
                                            "Não Governamental/Organização da Sociedade Civil"))) %>%
    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n), Posição = (cumsum(n/sum(n)) - 0.5 * n/sum(n)))
}

grafico <- acolh_nat(unac_2012, q4, "2012") %>%
      bind_rows(acolh_nat(unac_2013, q4, "2013")) %>%
      bind_rows(acolh_nat(unac_2014, q5, "2014")) %>%
      bind_rows(acolh_nat(unac_2015, q5, "2015")) %>%
      bind_rows(acolh_nat(unac_2016, q4, "2016")) %>%
      bind_rows(acolh_nat(unac_2017, q3, "2017")) %>%
      bind_rows(acolh_nat(unac_2018, q_3, "2018")) %>%
      bind_rows(acolh_nat(unac_2019, q3, "2019")) %>%
      bind_rows(acolh_nat(unac_2020, q3, "2020")) %>%
      bind_rows(acolh_nat(unac_2021, q3, "2021")) %>%
      bind_rows(acolh_nat(unac_2022, q3, "2022")) %>%




  ggplot(aes(x = Categoria, y = Percentual, group = Nível)) +
#  geom_col(aes(fill = Nível), position = "dodge") +
#  geom_text(aes(label = percent(Percentual), y=Percentual+.07), position = position_dodge(width = 0.9), angle = 90) +
  geom_col(aes(fill = Nível), position = position_stack(reverse = TRUE)) +
  geom_text_repel(aes(y=Posição, label = percent(Percentual)), point.padding = NA) +
  scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
  theme(legend.position="bottom",
        legend.title = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text.y = element_blank(),
        axis.line.x = element_line(),
        panel.background = element_blank()) +
  guides(fill=guide_legend(nrow=1,byrow=TRUE))

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)

```


No que se refere às condições de acessibilidade, é possível notar melhorias no percentual dos quatro quesitos de acessibilidade. A adaptação mais observada é a rota acessível ao banheiro, presente em 50,9% das Unidades, e a menos observada é o acesso principal adaptado com rampas e rota acessível desde a calçada até o interior da unidade, presentes em 49,2% das Unidades. O banheiro adaptado para pessoas com deficiência e/ou mobilidade reduzida, presente em 47,9% das unidades em 2022 e no que se refere ao acesso principal adaptado com rampas e e rota acessivel para o censo suas 2022 observa-se presente em 45,6% das unidades conforme \Cref{fig:unac_acessibilidade}.


```{r unac_acessibilidade, fig.cap = "Evolução percentual de Unidades de Acolhimento Municipais com condições de acessibilidade - Brasil; 2017 e 2022", fig.footer = "Fonte: MDS, Censo SUAS",eval=FALSE}

# Em 2012 não tem a informação sobre se a acessibilidade é de acordo com a Norma ABNT, esse detalhamento só tem a partir de 2015.
tabela <- equip_acessibilidade(unac_2015, q42_1, "2015", "1") %>%
  bind_rows(equip_acessibilidade(unac_2015, q42_2, "2015", "2")) %>%
  bind_rows(equip_acessibilidade(unac_2015, q42_3, "2015", "3")) %>%
  bind_rows(equip_acessibilidade(unac_2015, q42_4, "2015", "4")) %>%
  bind_rows(equip_acessibilidade(unac_2017, q37.1, "2017", "1")) %>%
  bind_rows(equip_acessibilidade(unac_2017, q37.2, "2017", "2")) %>%
  bind_rows(equip_acessibilidade(unac_2017, q37.3, "2017", "3")) %>%
  bind_rows(equip_acessibilidade(unac_2017, q37.4, "2017", "4")) %>%
  bind_rows(equip_acessibilidade(unac_2022, q41_1, "2022", "1")) %>%
  bind_rows(equip_acessibilidade(unac_2022, q41_2, "2022", "2")) %>%
  bind_rows(equip_acessibilidade(unac_2022, q41_3, "2022", "3")) %>%
  bind_rows(equip_acessibilidade(unac_2022, q41_4, "2022", "4")) %>%
  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=34))

ordenado<-tabela %>%
  filter(Ano == "2022") %>%
  arrange(Percentual) %>%
  select(Categoria)

ordenado<-factor(ordenado, levels = ordenado$Categoria)

ordenado2<-tabela %>%
  select(Ano) %>%
  distinct() %>%
  arrange(Ano)

ordenado2<-factor(ordenado2, levels = ordenado2$Ano)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = levels(ordenado))) %>%
  mutate(Ano = factor(Ano, levels = rev(levels(ordenado2)))) %>%
  ggplot(aes(x = Categoria, y = Percentual, group = Ano)) +
  geom_col(aes(fill = Ano), position = "dodge") +
  geom_text(aes(label = label_percent(accuracy = 0.1, decimal.mark = ",")(Percentual)), hjust = -0.05, position = position_dodge(width = 0.9)) +
  scale_y_continuous(expand = expand_scale(mult = c(0, .15))) +
  coord_flip() +
  theme(legend.position="bottom",
        legend.title = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text.x = element_blank(),
        axis.line.y = element_line(),
        panel.background = element_blank()) +
  guides(fill=guide_legend(nrow=1, byrow=TRUE, reverse=TRUE))

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```
Em relação ao acesso a internet, observa-se uma evolução nos últimos 10 anos. Em 2012 62,2% das unidades possuem acesso a internet, o censo suas de 2022 destaca que 100% dos computadores das undiades possuem acesso a internet conforme \Cref{fig:unac-internet}.

```{r unac-internet, fig.cap = "Percentual de Computadores nas unidades de Acolhimento com acesso a internet, 2012, 2017 e 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

grafico <- f_maior0_regiao_ano(unac_2012, q34a_2, Região, "2012") %>%
  bind_rows(f_maior0_regiao_ano(unac_2017, q36.20, IBGE, "2017")) %>%
  bind_rows(f_maior0_regiao_ano(unac_2022, q40_25, IBGE, "2022")) %>%

  f_grafico_col_group_percent(Região, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)


```

## Cadastro Único

Quanto a presença das unidades do Cadastro Único, os dados do censo suas 2022 sinaliza xxx postos do Cadastro Único




```{r postos-cadunico, fig.cap = "Evolução de Postos do Cadastro Único - 2020 - 2021 - 2022", fig.footer = "Fonte: MDS, Censo SUAS.",eval=FALSE}

grafico <- f_quantitativo_regiao_ano(posto_cadunico_2020, Regiao, "2020") %>%
# bind_rows(f_quantitativo_regiao_ano(posto_cadunico_2021, IBGE, "2021")) %>%)
  bind_rows(f_quantitativo_regiao_ano(posto_cadunico_2022, IBGE, "2022")) %>%
  f_grafico_col_group_numero(Região, n, Ano, 1)

  #ano 2021 não quer gerar, acho que pode ser erro no código do ibge

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```
Em relação ao local onde estão estas undiades, o grafico abaixo \Cref{fig:posto_cadunico}. A maioria destas unidades, 60,9% encontra-se na secretaria de assistencia social. A segunda proporção são postos exclusivos, com detaque para algumas undiades presentes em escolas, conselhos e OSCS.


```{r posto_cadunico, fig.cap = "Distribuição dos Postos do Cadastro Único - Brasil, 2020 a 2022", fig.footer = "Fonte: MDS, Censo SUAS.", eval=FALSE}

posto_cadunico = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == "Sede da Secretaria da Assistência Social ou congênere;"~"Sede da Secretaria da Assistência Social ou congênere;",
                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("Sede da Secretaria da Assistência Social ou congênere;",
                                            "Posto exclusivo para atendimento do Cadastro Único;",
                                            "Outra unidade administrativa (Sede da Prefeitura, Sede de Outra Secretaria, Administração Regional, Sub-Prefeituras, Un",
                                            "Escola",
                                            "Entidade privada, Associação Comunitária ou ONG;",
                                            "Conselho Municipal de Assistência Social, Conselho Tutelar ou outro conselho municipal;",
                                            "Outro."))) %>%

    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n), Posição = (cumsum(n/sum(n)) - 0.5 * n/sum(n)))
}

grafico <- posto_cadunico (posto_cadunico_2020, q1_0, "2020") %>%
   bind_rows(posto_cadunico(posto_cadunico_2021, q1, "2021")) %>%
   bind_rows(posto_cadunico(posto_cadunico_2022, q1, "2022")) %>%





  ggplot(aes(x = Categoria, y = Percentual, group = Nível)) +
#  geom_col(aes(fill = Nível), position = "dodge") +
#  geom_text(aes(label = percent(Percentual), y=Percentual+.07), position = position_dodge(width = 0.9), angle = 90) +
  geom_col(aes(fill = Nível), position = position_stack(reverse = TRUE)) +
  geom_text_repel(aes(y=Posição, label = percent(Percentual)), point.padding = NA) +
  scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
  theme(legend.position="bottom",
        legend.title = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text.y = element_blank(),
        axis.line.x = element_line(),
        panel.background = element_blank()) +
  guides(fill=guide_legend(nrow=5,byrow=TRUE))

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```
A acessibildiade possui um leve avanço nos últimos anos, com execeção da rota ascessivel aos principais espaços os demais itens de acessbilidade avançaram conforme pode ser observado através \Cref{fig:postcad-acessibilidade}.



```{r postcad-acessibilidade, fig.cap = "Evolução percentual de postos do Cadastro Único com condições de acessibilidade - Brasil; 2020, 2021 e 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

tabela <- equip_acessibilidade(posto_cadunico_2020, q7_1, "2020", "1") %>%
  bind_rows(equip_acessibilidade(posto_cadunico_2020, q7_2, "2020", "2")) %>%
  bind_rows(equip_acessibilidade(posto_cadunico_2020, q7_3, "2020", "3")) %>%
  bind_rows(equip_acessibilidade(posto_cadunico_2020, q7_4, "2020", "4")) %>%

  bind_rows(equip_acessibilidade(posto_cadunico_2021, q7_1, "2021", "1")) %>%
  bind_rows(equip_acessibilidade(posto_cadunico_2021, q7_2, "2021", "2")) %>%
  bind_rows(equip_acessibilidade(posto_cadunico_2021, q7_3, "2021", "3")) %>%
  bind_rows(equip_acessibilidade(posto_cadunico_2021, q7_4, "2021", "4")) %>%

  bind_rows(equip_acessibilidade(posto_cadunico_2022, q7_1, "2022", "1")) %>%
  bind_rows(equip_acessibilidade(posto_cadunico_2022, q7_2, "2022", "2")) %>%
  bind_rows(equip_acessibilidade(posto_cadunico_2022, q7_3, "2022", "3")) %>%
  bind_rows(equip_acessibilidade(posto_cadunico_2022, q7_4, "2022", "4")) %>%

  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=34))


ordenado<-tabela %>%
  filter(Ano == "2022") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  f_grafico_col_percent_flip(Categoria, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Em relação aos espaços de acessibilidade comparada a situação do imóvel, destaca-se que os postos do Cadastro Único próprios ou cedidos, possuem significativamente mais ascessibilidade que os imóveis alugados (\Cref{fig:postcad-acessibilidade-situacao}).

```{r postcad-acessibilidade-situacao, fig.cap = "Percentual de Postos do Cadastro Único com condições de acessibilidade segundo situação do imóvel – Brasil, 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

tabela <- equip_acessibilidade_situacao(posto_cadunico_2022, q5, q7_1, "1") %>%
  bind_rows(equip_acessibilidade_situacao(posto_cadunico_2022, q5, q7_2, "2")) %>%
  bind_rows(equip_acessibilidade_situacao(posto_cadunico_2022, q5, q7_3, "3")) %>%
  bind_rows(equip_acessibilidade_situacao(posto_cadunico_2022, q5, q7_4, "4"))

ordenado<-tabela %>%
  filter(Situacao == "Próprio") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = rev(ordenado))) %>%
  f_grafico_col_group_percent(Situacao, Percentual, Categoria, 4)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Em relação a computadores com acesso a internet, os dados do censo suas 2022 sinaliza que 99% das unidades dispõe de equipamentos com esta estrutura conforme pode ser observado \Cref{fig:postcad-internet-percentual}.

```{r postcad-internet-percentual, fig.cap = "Evolução percentual de Postos do Cadastro Único com computadores com acesso à internet – Brasil;  2020, 2021 e 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

grafico <- f_maior0_regiao_ano(posto_cadunico_2020, q10_2, IBGE, "2020") %>%
  bind_rows(f_maior0_regiao_ano(posto_cadunico_2021, q10_2, IBGE, "2021")) %>%
  bind_rows(f_maior0_regiao_ano(posto_cadunico_2022, q10_2, IBGE, "2022")) %>%

  f_grafico_col_group_percent(Região, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

# Serviços e Benefícios ofertados pelo SUAS

## Proteção Social

A assistência social organiza-se por dois tipos de proteção: a proteção social básica, definida no artigo 6º-A da Lei Orgânica da Assistência Social (LOAS) como um "conjunto de serviços, programas, projetos e benefícios da assistência social que visa a prevenir situações de vulnerabilidade e risco social por meio do desenvolvimento de potencialidades e aquisições e do fortalecimento de vínculos familiares e comunitários" e a proteção social especial, definida como "conjunto de serviços, programas e projetos que tem por objetivo contribuir para a reconstrução de vínculos familiares e comunitários, a defesa de direito, o fortalecimento das potencialidades e aquisições e a proteção de famílias e indivíduos para o enfrentamento das situações de violação de direitos"\footnote{Lei nº 8.742, de 7 de dezembro de 1993 (Lei Orgânica da Assistência Social): Dispõe sobre a organização da Assistência Social e dá outras providências (\url{http://www.planalto.gov.br/ccivil_03/Leis/L8742compilado.htm}).}.

Nesse contexto, este eixo de equipamentos, serviços e benefícíos da Assistência Social tem o objetivo de apresentar informações sobre a oferta dos equipamentos da Proteção Social Básica e Especial do SUAS integrada aos serviços e benefícios desta política.

Para isso, os dados históricos desta publicação nos ajudam a identificar os avanços e tendências ao longo dos anos em relação a estrutura física destes equipamentos, oferta dos serviços e benefícios, demanda e perfis de públicos atendidos, oferta regionalizada a partir da resolução CIT 33/2013, integração com Cadastro Único para programas sociais, natureza da oferta das unidades. Este conteúdo está dividido por proteções a saber:

-   **Proteção Social Básica:** PAIF (Serviço de Proteção e Atendimento Integral à Família), SCFV (Serviços de Convivência e Fortalecimento de Vínculos), Proteção Social Básica no Domicílio para pessoas idosas e com deficiência,

-   **Proteção Social Especial Média Complexidadade:** PAEFI (Serviço de Atendimento Especializado a Famílias e Indivíduos),Proteção Social Especial no Domicílio para pessoas idosas e com Deficiência, Abordagem Social, MSE (Medidas Socioeducativas em meio aberto), Serviço para situações de emergência e/ou calamidade pública.

-   **Proteção Social Especial Alta Complexidade:** Tipos de unidades de Serviço de Acolhimento Institucional, oferta de Serviços de Família Acolhedora, bem como do Programa de Família Guardiã ou Extensa, Serviçso ofertado em Centro Dia.

## Proteção Social Básica

### Serviço de Proteção e Atendimento Integral à Família (PAIF)

### Serviços de Convivência e Fortalecimento de Vínculos (SCFV)

```{r CRAS-SCFV, fig.cap = "Percentual de CRAS que executavam diretamente os Serviços de Convivência e Fortalecimento de Vínculos - Brasil, 2014 a 2022", fig.footer = "Fonte: MDS, Censo SUAS"}

grafico <- f_sim_nao(cras_2014, q19, "2014") %>%
  bind_rows(f_sim_nao(cras_2015, q16, "2015")) %>%
  bind_rows(f_sim_nao(cras_2016, q15, "2016")) %>%
  bind_rows(f_sim_nao(cras_2017, q16, "2017")) %>%
  bind_rows(f_sim_nao(cras_2018, q_16, "2018")) %>%
  bind_rows(f_sim_nao(cras_2019, q15, "2019")) %>%
  #bind_rows(f_sim_nao(cras_2020, q17, "2020")) %>%
  bind_rows(f_sim_nao(cras_2021, q17, "2021")) %>%
  bind_rows(f_sim_nao(cras_2022, q17, "2022")) %>%

 # em 2020 CRAS base estar númerica

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Em 2016, 2.334 CRAS informaram que havia povos e comunidades tradicionais em seu território de abrangência (28,3% do total de CRAS). Desses, apenas 127 (5,4%) indicaram não ter realizado atendimento a esse público. Esse percentual é inferior a 2015, quando o percentual foi de 6,7% (147 unidades dos 2.191 CRAS com povos e comunidades tradicionais em seu território de abrangência).

Dos 2.334 CRAS que informaram que havia povos e comunidades tradicionais em seu território de abrangência, 896 informaram ter atendido Comunidades Quilombolas (38,4%), seguidos por 615 CRAS que informaram ter atendido Comunidades Ribeirinhas (26,3%) e 611 que informaram ter atendido Povos Indígenas (26,2%) (Gráfico 27).

Os CRAS são considerados a porta de entrada da Assistência Social, sendo uma referência para a população no território. Nesse sentido, podem se articular com a rede de proteção social e com demais serviços ofertados no município, de forma a garantir o acesso da população aos direitos sociais.

Em 2016, apenas 0,6% dos CRAS informaram não ter articulação com serviços de educação, e 0,2% informaram que o serviço não existia no município. Assim, 99,2% dos CRAS informaram manter alguma articulação com serviços de educação, sendo os maiores percentuais referentes à existência de dados atualizados dos parceiros com quem o CRAS mantém articulação (94,8%) e ao encaminhamento de usuários ao CRAS pelos serviços de educação (90,9%). No mesmo ano, 0,3% dos CRAS informaram não ter articulação com serviços de saúde e 0,1% informaram que o serviço não existe no município. Dessa forma, 99,6% dos CRAS informaram ter articulação com serviços de saúde, sendo os maiores percentuais referentes ao recebimento de usuários encaminhados pelo CRAS (96,4%).

```{r CRAS-PSB, fig.cap = "Percentual de CRAS que executavam diretamente os Serviços de Proteção Social Básica nos domicílios - Brasil, 2014 a 2022", fig.footer = "Fonte: MDS, Censo SUAS"}

grafico <- f_sim_nao(cras_2018, q_24, "2018") %>%
  bind_rows(f_sim_nao(cras_2019, q23, "2019")) %>%
  #bind_rows(f_sim_nao(cras_2020, q24, "2020")) %>%
   bind_rows(f_sim_nao(cras_2021, q24, "2021")) %>%
   bind_rows(f_sim_nao(cras_2022, q24, "2022")) %>%

  # essa pergunta  SURGE A PARTIR DE 2018
  # CRAS 2020 a base estar númerica - solicitei ;Dionara a atualziação no site

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

## Serviços de Proteção Social Especial -- Média Compexidade

A Proteção Social Especial de Média Complexidade organiza a oferta de serviços, programas e projetos de caráter especializado que requerem maior estruturação técnica e operativa, com competências e atribuições definidas, destinados ao atendimento a famílias e indivíduos em situação de risco pessoal e social, por violação de direitos. É ofertada pelos Centros de Referência Especializados de Assistência Social (CREAS), pelos Centros de Referência Especializados para População em Situação de Rua (Centro POP), e pelos Centro-Dia. No nível de Média Complexidade, são ofertados o Serviço de Proteção e Atendimento Especializado a Famílias e Indivíduos (PAEFI); o Serviço de Proteção Social a Adolescentes em Cumprimento de Medida Socioeducativa de Liberdade Assistida e de Prestação de Serviços à Comunidade; o Serviço Especializado em Abordagem Social; o Serviço de Proteção Social Especial para Pessoas com Deficiência, Idosos e suas Famílias e o Serviço Especializado para Pessoas em Situação de Rua. O PAEFI é definido na Tipificação Nacional de Serviços Socioassistenciais18 como sendo o "serviço de apoio, orientação e acompanhamento a famílias com um ou mais de seus membros em situação de ameaça ou violação de direitos. Compreende atenções e orientações direcionadas para a promoção de direitos, a preservação e o fortalecimento de vínculos familiares, comunitários e sociais e para o fortalecimento da função protetiva das famílias diante do conjunto de condições que as vulnerabilizam e/ou as submetem a situações de risco pessoal e social." As situações de violência ou de violação de direitos para as quais teve mais CREAS oferecendo atendimento pelo PAEFI em 2016, contando separadamente o atendimento de cada CREAS a cada ciclo de vida do usuário (atendimento a crianças e adolescentes, atendimento a mulheres adultas, atendimento a homens adultos e atendimento a idosos), foram as situações de violência psicológica, de violência física e de pessoas com deficiência vítimas de violência ou de violação de direitos. Para as crianças e adolescentes, a situação para a qual teve mais CREAS oferecendo atendimento foi a de abuso sexual ou de violência sexual: 2464 de um total de 2521 CREAS ofereceram atendimento pelo PAEFI a essa situação. No atendimento a mulheres adultas, as situações de violência física e violência psicológica foram as que tiveram maior número de CREAS oferecendo atendimento. Já para os homens adultos, a situação que teve o maior número de CREAS oferecendo atendimento foi a de pessoas com deficiência vítimas de violência ou de violação de direitos. Violência psicológica foi a situação, em número de CREAS, com maior oferta de atendimento para idosos. As situações que tiveram o maior número de CREAS que não oferecem atendimento para elas foram as de tráfico de pessoas, de famílias com adolescentes em cumprimento de medida socioeducativa e de famílias com pessoas egressas do sistema prisional (Gráfico 112). Gráfico 112 - Número de CREAS que oferecem atendimento pelo PAEFI, segundo situações e ciclos de vida do usuário em situação de violência/violação de direitos - Brasil, 2016 Fonte: MDS, Censo SUAS.

Do total de 2521 unidades de CREAS existentes em 2016 no Brasil, de 99,0% a 99,5% delas realizaram as seguintes ações e atividades no âmbito do PAEFI: visitas domiciliares, acompanhamento individual ou familiar, encaminhamento para o CRAS, encaminhamento para serviços da rede de saúde e encaminhamento de famílias ou indivíduos para a rede de serviço socioassistencial. As ações e atividades que tiveram menor número de CREAS realizando-as foram as de orientação jurídico-social e de grupo ou oficina com famílias ou indivíduos, realizadas por 75,2% e 72,5% das unidades, respectivamente (Gráfico 113). Gráfico 113 - Percentual de CREAS segundo ações e atividades realizadas no âmbito do PAEFI - Brasil, 2016 Fonte: MDS, Censo SUAS.

O Serviço Especializado em Abordagem Social consiste na identificação, por equipes de educadores sociais, de pessoas e famílias em situação de risco pessoal nos ambientes públicos. Dentre as situações de risco enquadram-se o trabalho infantil, situação de rua, uso abusivo de drogas, exploração sexual de crianças e adolescentes, dentre outras. A abordagem é realizada em praças, feiras, locais de intensa circulação de pessoas e com existência de comércio, ruas, prédios abandonados, dentre outros espaços, e tem por objetivo garantir direitos por meio de inclusão em rede de serviços socioassistenciais e em outras políticas públicas. Ao analisar a oferta de serviço especializado em abordagem social pelos municípios em 2016, temos que 3.663 municípios, ou, 66,8% dos 5.481 municípios que participaram do Censo, declararam não ofertar o serviço, um grande crescimento em relação a 2015, quando 2.831 municípios (51,5%) haviam declarado não ofertar o serviço. O local onde o maior número de municípios oferta o serviço é no(s) CREAS, onde 1.319 municípios (24,1%) declararam ofertá-lo (em 2015, 28,9% dos municípios haviam declarado ofertar o serviço no(s) CREAS). Na sede ou no órgão gestor do município era o local onde 955 municípios (17,4%) ofertavam o serviço em 2015, caindo esse número em 2016 para apenas 421 (7,7%). Houve queda também no número de municípios que ofertavam o serviço especializado em abordagem social nos locais menos frequentes: no(s) Centro POP, em outra unidade pública e em entidade conveniada (Gráfico 114). Gráfico 114 -- Quantidade de Municípios segundo oferta e local de oferta de serviço especializado em abordagem social - Brasil, 2015 e 2016 Fonte: MDS, Censo SUAS.

De acordo com o Censo SUAS 2016, 1.537 CREAS (61,0%) realizaram a abordagem social, sendo 374 (14,8%) com equipes exclusivas para abordagem e 1.163 (46,1%) sem equipe exclusiva. Outras 185 (7,3%) unidades não realizaram o serviço com sua própria equipe. Nestes casos, o serviço é referenciado ao CREAS, mas ofertado por outra entidade. Em relação a 2015, houve redução nos percentuais de CREAS que realizaram a abordagem social com equipe exclusiva, sem equipe exclusiva e por outra entidade referenciada ao CREAS. Portanto, houve um aumento no percentual e também no número absoluto de CREAS que não realizavam e não possuíam serviço de abordagem referenciado, passando de 28,1% dos CREAS em 2015 para 31,7% em 2016. Nas regiões, só na região Sul não houve queda no percentual de CREAS que realizaram a abordagem social com equipe exclusiva, mas ainda assim essa região continua tendo o menor percentual entre as regiões, com 12,0%. A região Sul foi também a única que teve aumento no percentual de CREAS que não realizavam o serviço de abordagem com equipe do CREAS, mas que tinham outra entidade referenciada ao CREAS realizando o serviço. Nas regiões Centro-Oeste e Nordeste houve aumento no percentual de CREAS que realizaram a abordagem social sem equipe exclusiva, de 55,3% em 2015 para 57,8% em 2016 no Centro-Oeste e de 49,9% em 2015 para 50,3% em 2016 no Nordeste. Finalmente, apenas na região Centro-Oeste não houve aumento no percentual de CREAS que não realizavam nem possuíam o serviço de abordagem referenciado a eles (Tabela 9). Tabela 9 - Quantidade de CREAS que realizam o Serviço Especializado em Abordagem Social segundo grandes regiões -- Brasil, 2016

2016 "Sim, com equipe exclusiva para Abordagem" "Sim, sem equipe exclusiva para Abordagem" "Não realiza com a equipe deste CREAS, mas no município existe Serviço de Abordagem referenciado a este CREAS" "Não realiza nem possui Serviço de Abordagem referenciado a este CREAS" Norte 40 109 4 74 Nordeste 165 486 25 291 Sudeste 93 295 103 221 Sul 47 144 34 167 Centro-Oeste 29 129 19 46 Brasil 374 1.163 185 799 Fonte: MDS, Censo SUAS.

O Serviço de Proteção Social a Adolescentes em Cumprimento de Medida Socioeducativa de Liberdade Assistida (LA) e de Prestação de Serviços à Comunidade (PSC), segundo definido na Tipificação Nacional de Serviços Socioassistenciais, "tem por finalidade prover atenção socioassistencial e acompanhamento a adolescentes e jovens em cumprimento de medidas socioeducativas em meio aberto, determinadas judicialmente. Deve contribuir para o acesso a direitos e para a resignificação de valores na vida pessoal e social dos adolescentes e jovens. Para a oferta do serviço faz-se necessário a observância da responsabilização face ao ato infracional praticado, cujos direitos e obrigações devem ser assegurados de acordo com as legislações e normativas específicas para o cumprimento da medida." 19 Em 2016, 37,5% dos municípios atendiam a adolescentes em cumprimento de Medida Socioeducativa de Liberdade Assistida (LA) e de Prestação de Serviços à Comunidade (PSC) no CREAS do município, enquanto 35,7% dos municípios encaminhava o atendimento desses adolescentes para o CRAS. Constatou-se ainda que 16,3% dos municípios atendiam esses adolescentes pela equipe de referência da proteção social especial do município (órgão gestor) e que 9,9% dos municípios não atendiam adolescentes em cumprimento de LA e de PSC (Gráfico 115). Gráfico 115: Percentual de municípios segundo forma de atendimento a adolescentes em cumprimento de Medida Socioeducativa de Liberdade Assistida (LA) e de Prestação de Serviços à Comunidade (PSC) - Brasil, 2016 Fonte: MDS, Censo SUAS.

O número de CREAS que realizam o Serviço de Proteção Social a Adolescentes em Cumprimento de Medida Socioeducativa de Liberdade Assistida (LA) e de Prestação de Serviços à Comunidade (PSC) vem crescendo desde 2010, passando de 1.099 unidades de CREAS naquele ano para 2.018 unidades em 2016. O percentual de CREAS que realizam esse serviço também cresceu, passando de 69,1% dos CREAS em 2010 para 80,0% em 2016, percentual quase igual ao de 2015 (81,0%) (Gráfico 116). Gráfico 116 - Número e percentual de CREAS que realizam o Serviço de Proteção Social a Adolescentes em Cumprimento de Medida Socioeducativa de Liberdade Assistida (LA) e de Prestação de Serviços à Comunidade (PSC) - Brasil, 2010 a 2016 Fonte: MDS, Censo SUAS.

O "Serviço de Proteção Social Especial para Pessoas com Deficiência e Pessoas Idosas e suas famílias" é definido na Tipificação Nacional de Serviços Socioassistenciais20 como sendo o "serviço para a oferta de atendimento especializado a famílias com pessoas com deficiência e idosos com algum grau de dependência, que tiveram suas limitações agravadas por violações de direitos, tais como: exploração da imagem, isolamento, confinamento, atitudes discriminatórias e preconceituosas no seio da família, falta de cuidados adequados por parte do cuidador, alto grau de estresse do cuidador, desvalorização da potencialidade/capacidade da pessoa, dentre outras que agravam a dependência e comprometem o desenvolvimento da autonomia." As ações e atividades mais desenvolvidas pelos 1.342 Centros-Dia do país no âmbito do "Serviço de Proteção Social Especial para Pessoas com Deficiência e Pessoas Idosas e suas famílias", em 2016, foram a acolhida e escuta inicial, o encaminhamento para os serviços da rede de saúde, o encaminhamento para a rede de serviços socioassistenciais e a orientação sobre acesso ao BPC e outros benefícios, ações e atividades estas que foram desenvolvidas por 94,0% a 96,6% dos Centros-Dia. Na outra ponta, apenas 23,7% dos Centros-Dia fizeram provimento de bens materiais, e 22,8% fizeram provisão de órteses e próteses (Gráfico 117) Gráfico 117 - Percentual de Centros-Dia segundo ações e atividades desenvolvidas no âmbito do "Serviço de Proteção Social Especial para Pessoas com Deficiência e Pessoas Idosas e suas famílias" - Brasil, 2016 Fonte: MDS, Censo SUAS.

Durante o mês de agosto de 2016, 66.251 adultos com deficiência foram atendidos em 85,7% das 1.342 unidades Centro-Dia do país. No mesmo mês foram atendidas 45.021 crianças de 7 a 14 anos com deficiência, atendimento realizado em 77,5% das unidades. Um percentual menor de unidades, 50,4%, realizaram atendimento de idosos com deficiência, atendendo 7.883 idosos nessa condição, e apenas 16,5% das unidades Centro-Dia atenderam naquele mesmo mês 5.268 idosos sem deficiência, mas dependentes pela idade (Gráfico 118). Gráfico 118 - Número de pessoas com deficiência e/ou dependência atendidas nas Unidades Centro-Dia durante o mês de agosto de 2016, segundo faixa etária e situação de deficiência ou dependência - Brasil, agosto de 2016 Fonte: MDS, Censo SUAS.

O Centro POP é uma unidade pública voltada para o atendimento especializado à população em situação de rua. Deve ofertar, obrigatoriamente, o Serviço Especializado para Pessoas em Situação de Rua, que realiza atendimentos individuais e coletivos, oficinas e atividades de convívio e socialização, além de ações que incentivem o protagonismo e a participação social das pessoas em situação de rua. Em 2016, assim como em 2015, no conjunto de 22 atividades realizadas pelos Centros POP e pesquisadas pelo Censo SUAS, 13 atividades eram realizadas por mais de 90% desses Equipamentos. Neste ano, o apoio para obtenção de documentação pessoal chegou a ser realizado por 100% dos 230 Centros POP do país (eram 235 Centro POP no país em 2015). Também como em 2015, as atividades menos realizadas no conjunto de unidades foram a orientação sociojurídica, agora realizada em 44,3% dos Centros POP, e a avaliação para concessão de aluguel social, cujo percentual caiu de 36,6% das unidades pesquisadas em 2015 para 33,5% em 2016 (Gráfico 119). Gráfico 119 - Percentual de Centros POP segundo atividades realizadas - Brasil, 2016 Fonte: MDS, Censo SUAS.

```{r CREAS-MSE, fig.cap = "Percentual de CREAS que realizam o Serviço de Proteção Social a Adolescentes em um cumprimento  Medida Socioeducativa de Liberdade Assistida (LA) e de Prestação de Serviços à Comunidade (PSC) - Brasil, 2010 a 2022", fig.footer = "Fonte: MDS, Censo SUAS", eval=FALSE}

grafico <- f_sim_nao(creas_2017, q20, "2017") %>%
  bind_rows(f_sim_nao(creas_2018, q16, "2018")) %>%
  bind_rows(f_sim_nao(creas_2019, q15, "2019")) %>%
  bind_rows(f_sim_nao(creas_2020, q20, "2020")) %>%
  bind_rows(f_sim_nao(creas_2021, q20, "2021")) %>%
  bind_rows(f_sim_nao(creas_2022, q20, "2022")) %>%

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

<!-- GRAFICO ABAIXO A PARTIR DE 2018 MUDA AS RESPOSTAS padronizar a partir de 2018 (shirley) -->

```{r CREAS-PSE-Domicilio, fig.cap = "Percentual de CREAS que realizam Serviço de proteção social Especial para Pessoas com Deficiência, Idosas e suas Famílias, 2016 a 2022"}

grafico <- f_sim_nao(creas_2016, q38, "2016") %>%
  bind_rows(f_sim_nao(creas_2017, q43, "2017")) %>%
  #bind_rows(f_sim_nao(creas_2018, q35, "2018")) %>%
  #bind_rows(f_sim_nao(creas_2019, q33, "2019")) %>%
  #bind_rows(f_sim_nao(creas_2020, q38, "2020")) %>%
  #bind_rows(f_sim_nao(creas_2021, q39, "2021")) %>%
  #bind_rows(f_sim_nao(creas_2022, q38, "2022")) %>%

 # partir de 2018 muda as respostas, padronizar

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r CREAS-abordagem-social, fig.cap = "Quantidade de CREAS que realizam o Serviço Especializado em Abordagem Social, 2018 - 2020 e 2022", fig.footer = "Fonte: MDS, Censo SUAS"}

creas_psee  = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == "Sim, sem equipe específica para o serviço"~"Sim, sem equipe específica para o serviço",
                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("Sim, sem equipe específica para o serviço",
                                            "Sim, com equipe específica para o serviço",
                                            "Não realiza com a equipe deste CREAS, mas no município existe o Serviço",
                                            "Não realiza, nem possui o Serviço no município"))) %>%

    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n))
}

grafico <- creas_psee(creas_2018, q35, "2018") %>%
  #bind_rows(creas_psee(creas_2019, q33, "2019")) %>%
  bind_rows(creas_psee(creas_2020, q38, "2020")) %>%
  #bind_rows(creas_pseecreas_2021, q39, "2021")) %>%
  bind_rows(creas_psee(creas_2022, q38, "2022")) %>%

 #antes de 2018 as respostas é sim e não;
 #em 2021 é alterada as categorias das respostas

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 4)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Os CREAS atendem a população que se encontra em risco pessoal ou social ou que teve seus direitos violados e atuam na orientação e encaminhamento das pessoas e famílias para os demais serviços da assistência social ou de outras áreas. Assim, a articulação com serviços, programas ou instituições no município para encaminhamento de famílias e indivíduos que estejam em atendimento nos CREAS é fundamental. <!-- Em 2016, apenas 0,3% dos CREAS não tinham nenhuma articulação com os CRAS e 0,1% informaram não ter a instituição no município. Assim, 99,6% dos CREAS mantinham alguma articulação com os CRAS, sendo os maiores percentuais observados em relação à existência de dados atualizados dos parceiros com quem o CREAS mantém articulação (98,1%), ao recebimento de usuários encaminhados pelos CREAS (97,9%) e ao recebimento de usuários encaminhados para os CREAS (97,0%). --> <!-- Sobre a articulação com o Conselho Tutelar, 0,6% dos CREAS informaram não ter nenhuma articulação e 0,2% informaram que não havia a instituição no município. Dessa forma, 99,2% dos CREAS informaram ter alguma articulação com o Conselho Tutelar, sendo os maiores percentuais observados em relação à posse de dados atualizados (97,9%) e o encaminhamento de usuários para os CREAS (96,2%). --> <!-- Os menores percentuais de articulação foram observados em relação aos Centros-Dia (80,8% dos CREAS informaram não haver o serviço no município e 5,6% que não se articulam com essas Unidade) e aos Centros POP (74,5% dos CREAS informaram que não havia serviço ou instituição no município e 3,5% que não se articulavam com essas unidades). --> <!-- 19,9% dos CREAS informaram não ter nenhuma articulação com serviços/ programas de segurança alimentar e 18,0% não se articular com Instituições de Ensino e Pesquisa (Tabela 6). -->

## Proteção Social Especial de Alta Complexidade

```{r unac-natureza-publico, fig.cap = "Percentual de Unidades de Acolhimento segundo natureza da unidade - Brasil, 2014 a 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

```

Em 2016, 50,4% das Unidades de Acolhimento prestavam serviços de acolhimento a crianças e adolescentes (2.831 unidades). Desde 2014, cerca de 28% das unidades acolheram idosos. Do total de 5.614 Unidades de Acolhimento do país em 2016, 80,1% (4.498 unidades) tinham como principal público crianças e adolescentes ou pessoas idosas. No mesmo ano, 12,6% das Unidades atendiam como principal público adultos e famílias (705 unidades) e 1,6% (91 unidades) mulheres em situação de violência. O percentual de unidades de acolhimento que atendiam exclusivamente pessoas adultas com deficiência em 2016 era de 4,6%, o que representava o total de 258 unidades, enquanto 0,6% das unidades destinavam-se ao atendimento exclusivo de crianças e adolescentes com deficiência (35 Unidades). Em menor quantidade, 0,5% das unidades acolhiam jovens egressos de serviço de acolhimento (27). Quando observados os anos 2014 a 2016, não foram observadas variações expressivas entre a proporção de unidades em relação ao público atendido (Gráfico 52). Gráfico 52: Percentual de Unidades de Acolhimento segundo público atendido. Brasil, 2014 a 2016 Fonte: MDS, Censo SUAS.

Em 2016 existiam 163.364 vagas para atendimento nas Unidades de Acolhimento, considerando a capacidade máxima das 5.612 Unidades respondentes. Das 3.390 Unidades que tinham entre 0 e 20 vagas de capacidade máxima (60,4% do total), 2.497 (44,5% do total de unidades) eram voltadas ao atendimento de crianças e adolescentes. Das 1.667 Unidades voltadas ao acolhimento de pessoas idosas, 708 possuíam de 21 a 40 vagas. Foram identificadas 1.237 Unidades de Acolhimento que tinham entre 21 e 40 vagas para atendimento. Das 27 Unidades voltadas ao atendimento a jovens egressos de serviços de acolhimento, 21 tinham até 20 vagas. Entre as 91 Unidades que atendiam mulheres em situação de violência, 72 tinham até 20 vagas. Das 123 unidades que tinham acima de 100 vagas, 4 eram voltadas ao atendimento de crianças e adolescentes, 54 a pessoas idosas, 60 a adultos e famílias e 5 exclusivas para pessoas adultas com deficiência (Gráfico 53). Gráfico 53: Número de Unidades de Acolhimento segundo capacidade máxima e público atendido - Brasil, 2016 Fonte: MDS, Censo SUAS.

Em 2016, 2.108 Unidades (37,6%) tinham capacidade máxima (número de vagas) de acolhimento entre 11 a 20 pessoas, a maior concentração de unidades entre as categorias relacionadas. 3.390 Unidades de Acolhimento (60,4%) tinham capacidade máxima para atendimento (número de vagas) de até 20 pessoas e 1.237 (22,0%) tinham capacidade máxima para atendimento de 21 a 40 pessoas. Apenas 123 Unidades (2,2%) tinham capacidade para atendimento de mais de 100 pessoas. Sobre as vagas ocupadas, 3.699 Unidades (65,9%) acolhiam até 20 pessoas, 1.137 (20,3%) entre 21 e 40 pessoas e 80 (1,4%) acolhiam mais de 100 pessoas (Gráfico 54). 156 Unidades (2,8% do total) informaram não acolher nenhuma pessoa no momento do levantamento. Em média as Unidades de Acolhimento tinham, em 2016, 29 vagas de capacidade máxima e 22 vagas ocupadas. Gráfico 54: Número de Unidades de Acolhimento segundo capacidade máxima e quantidade de pessoas acolhidas - Brasil, 2016 Fonte: MDS, Censo SUAS.

Em 2016 existiam 5.614 Unidades de Acolhimento no país. Dessas, 2.217 eram Abrigos institucionais (39,5% do total de unidades), e 1.564 Abrigos institucionais (Instituição de Longa Permanência para Idosos - ILPI), que representavam 27,9% do total. As 23 repúblicas para jovens representavam 0,4% do total de Unidades, os 18 Abrigos para famílias desabrigadas/desalojadas vítimas de desastres eram 0,3% e as 12 repúblicas eram 0,2% total (Gráfico 55). Gráfico 55: Distribuição das Unidades de Acolhimento segundo tipo de instituição -- Brasil, 2016 Fonte: MDS, Censo SUAS.

```{r unac-txocupacao, fig.cap = "Taxa de ocupação das unidades de acolhimento por público atendido - Região - 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

```

As Unidades de Acolhimento podem se articular com outros serviços, programas ou instituições no município. Em 2016, 5,1% das Unidades de Acolhimento informaram não ter nenhuma articulação com os CRAS, e 0,2% informaram que não havia CRAS no município, enquanto 4,8% e 28,3% informaram não ter nenhuma articulação com CREAS e Conselho Tutelar, respectivamente. 12,7% das Unidades de Acolhimento indicaram que não havia CREAS no município e 0,5% informaram não haver Conselho Tutelar. Os menores percentuais referentes à articulação foram observados em relação aos Centros-Dia (55,2% das Unidades de Acolhimento informaram não haver o equipamento no município e 27,3% que não se articulam com esse equipamento) e aos Centros POP: 51,4% das Unidades de Acolhimento informaram que não há Centro Pop no município e 21,4% que não se articulam com essas unidades (Tabela 8). Tabela 8: Articulação das Unidades de Acolhimento com serviços, programas ou instituições existentes no município - Brasil, 2016

Serviços, programas ou instituições com os quais a Unidade de Acolhimento mantém articulação Possui dados da localização (endereço, telefone etc.) Recebe usuários encaminhados por esta Unidade Encaminha usuários para esta Unidade Acompanha os encaminhamentos Realiza reuniões periódicas Troca Informações Realiza estudos de caso em conjunto Desenvolve atividades em parceria Não tem nenhuma articulação Serviço ou instituição não existente no município Conselho Tutelar 68,8% 44,4% 35,6% 32,5% 25,1% 54,5% 31,8% 26,6% 28,3% 0,5% CRAS 88,4% 43,6% 55,5% 49,1% 34,2% 77,3% 42,0% 46,7% 5,1% 0,2% CREAS 76,3% 48,3% 52,3% 52,0% 41,8% 70,7% 50,6% 42,5% 4,8% 12,7% Centro-Dia 15,7% 3,0% 4,2% 2,8% 1,6% 7,2% 2,5% 3,5% 27,3% 55,2% Centro de Referência Especializado para População em Situação de Rua -- Centro POP 25,0% 11,1% 9,6% 8,0% 6,9% 16,6% 8,6% 7,0% 21,4% 51,4% Outras Unidades de Acolhimento 51,8% 22,3% 21,2% 14,2% 17,3% 42,9% 19,8% 22,0% 18,6% 23,9% Fonte: MDS, Censo SUAS.

ANÁLISE CONJUNTA Alguns equipamentos de prestação de serviços socioassistenciais estão instalados em imóveis compartilhados com outras unidades públicas de assistência social, unidades de saúde e outras diversas instituições. Em 2016, 27,8% dos Centros de Convivência estavam situados em imóveis compartilhados, destes, 551 das unidades dividiam imóvel com escolas. Entre os CRAS, menos de 10% usam imóveis compartilhados, o que representa uma diminuição de 0,8% em relação ao ano de 2015. O percentual de Centros POP instalados em imóveis compartilhados era de 22,1% em 2015, aumentando mais de 2 pontos percentuais no ano de 2016. Entre os CREAS, 17,9% dividiam espaço em 2016 (Gráfico 56). Gráfico 56: Percentual de Equipamentos instalados em imóvel compartilhado - Brasil, 2015 e 2016 Fonte: MDS, Censo SUAS.

O atendimento a povos e comunidades tradicionais no SUAS deve respeitar suas tradições e cultura para garantir o acesso dessa parcela da população a serviços, benefícios e direitos sociais. O atendimento a esse público se dá em mais de um tipo de equipamento da assistência social. Em 2016, 29,1% dos CREAS, 26,8% dos CRAS e 16,3% dos Centros de Convivência prestaram atendimento a povos e comunidades tradicionais. O atendimento a povos indígenas foi prestado por 10,6% dos CREAS, 7,4% dos CRAS e 2,6% dos Centros de Convivência. Já o atendimento a quilombolas foi realizado por 10,9% dos CRAS, 9,7% dos CREAS e 3,2% dos Centros de Convivência (Gráfico 57). Gráfico 57: Percentual de Unidades de Assistência Social que atenderam povos e comunidades tradicionais - Brasil, 2016 Fonte: MDS, Censo SUAS.

Em 2016, mais de 92% dos Centros POP e dos Centros-Dia ofereciam alimentação ou facilitavam o acesso ao público atendido. Nos Centros POP, 95,7% ofereciam ou facilitavam o acesso à alimentação aos usuários, 90,4% das Unidades (208) ofereciam lanche/ café da manhã, enquanto 23,5% (54) ofereciam jantar e 8,7% (20) o lanche/ café da noite. Nos Centros-Dia, 92,6% das unidades ofertavam alimentação. Em termos absolutos esse percentual representa 1.246 unidades. Considerando as refeições oferecidas, 83,9% das Unidades ofertavam lanche/ café da tarde, e 82,5% ofertavam lanche/ café da manhã. Assim como nos Centros POP os menores percentuais foram observados em relação à oferta de jantar (9,7%) e o lanche/ café da noite (1,9%) (Gráfico 58). Gráfico 58: Percentual de Centros POP e Centros DIA que facilitam o acesso ou oferecem alimentação aos usuários - Brasil, 2016 Fonte: MDS, Censo SUAS.

A distribuição de equipamentos da Assistência Social segundo localização mostra que em 2016, mais da metade dos CRAS estava localizado em áreas urbanas centrais (53,0% ou 4.368 unidades), enquanto 42,8% (3.530 unidades) estavam em áreas urbanas periféricas e 4,2% (342 unidades) em áreas rurais. O equipamento com maior percentual de unidades localizadas em áreas urbanas centrais é o CREAS (81,8% do total, o que corresponde a 2.062 unidades). Apenas 0,5% dos CREAS (12 unidades) funcionam em área rural. Os Centros de Convivência, por sua vez, têm mais da metade de suas unidades localizadas em áreas urbanas periféricas (51,0% do total, o que corresponde a 4.308 unidades) e 12,1% de suas unidades (1020) localizadas em área rural (Gráfico 59). Gráfico 59: Distribuição de Equipamentos da Assistência Social segundo localização - Brasil, 2016 Fonte: MDS, Censo SUAS.

Considerações Finais Conforme apresentado ao longo desse capítulo, em 2016 foram analisados pelo Censo SUAS 8.240 CRAS, 2.521 CREAS, 230 Centros POP, 8.454 Centros de Convivência, 5.614 Unidades de Acolhimento e 1345 Centro Dia. Os dados mostraram que equipamentos como CRAS estão presentes em quase todos os municípios brasileiros e que as Unidades de Acolhimento mantêm sua trajetória de expansão em todo território nacional. Um resultado positivo é que o percentual de CRAS funcionando em imóvel próprio cresceu para 51,7% e caiu para 39,6% o percentual dos que se encontravam funcionando em imóveis alugados no ano de 2016. As condições de acessibilidade, a despeito da melhora contínua ao longo dos anos em alguns tipos de equipamentos, seguem sendo um desafio importante a ser superado para todos os equipamentos do SUAS. Com relação aos CRAS, o aspecto que apresentou maior adequação foi rota acessível ao banheiro, presente em 38,7% das unidades do país. Quanto aos CREAS, os percentuais para todos os quesitos foram ainda menores, sendo o destaque positivo para o acesso principal adaptado com rampas e rota acessível desde a calçada do equipamento, presente em 26,8% desses equipamentos.

```{r fam-guardia, fig.cap = "O município possui programa de apoio à família guardiã na família extensa (guarda subsidiada)", fig.footer = "Fonte: MDS, Censo SUAS."}

#GM 2017:q.28.0 / 2018:q_30_99 / 2019: q_30_99 / 2020: não possui / 2021 e 2022: q37


```

```{r munic-calamidade, fig.cap = "Percentual de Municípios que entraram situação de emergencias e calamidades públicas", fig.footer = "Fonte: MDS, Censo SUAS."}

#Form Gestão Municipal
#Percentual de municípios que tiveram alojamentos provisórios para pessoas atingidas por situações de emergência e/ou calamidade pública no ano anterior

# 2017: q66 / 2018: q34 / 2019: q32 / 2020: q38 / 2021: q38 / 2022: q38
```

```{r uf-calamidade, fig.cap = "Ações desenvolvidas pelos estados para situação de calamidades públicas", fig.footer = "Fonte: MDS, Censo SUAS."}

#Form Gestão Municipal
#Percentual de municípios que tiveram alojamentos provisórios para pessoas atingidas por situações de emergência e/ou calamidade pública no ano anterior

# 2022: q14_1 , q14_2 , q14_3, q14_4, q14_5, q14_6, q14_7, q14_8, q14_9, q14_10, q14_99, q14_0, q14_99_1
```


```{r munic-migrantes, fig.cap = "Percentual de Municípios em relação a apoio a migrantes e refugiados", fig.footer = "Fonte: MDS, Censo SUAS."}

#Form Gestão Municipal
#Em 2021, a Assistência Social do município ofertou programa(s)/serviço(s) para o apoio e proteção a pessoas e famílias imigrantes/refugiados?

# 2017: q66 / 2018: q34 / 2019: q32 / 2020: q38 / 2021: q38 / 2022: q38
```

## Povos Tradicionais

```{r povos-tradicionais_cras, fig.cap = "Percentual de CRAS que atendem povos e grupos e comunidades tradicionais especificos -  por grupos , Região - 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

grafico <- f_sim_nao(cras_2022, q65_1_1, "2022") %>%
  #bind_rows(f_sim_nao(creas_2018, q16, "2018")) %>%
  #bind_rows(f_sim_nao(creas_2019, q15, "2019")) %>%
  #bind_rows(f_sim_nao(creas_2020, q20, "2020")) %>%
  #bind_rows(f_sim_nao(creas_2021, q20, "2021")) %>%
  #bind_rows(f_sim_nao(creas_2022, q20, "2022")) %>%

  #tentar computar a parte em branco ou colocar em quantidade

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r povos-tradicionais, fig.cap = "Percentual de CREAS que atendem povos e comunidades tradicionais -  por grupos , Região - 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

grafico <- f_selecao_regiao_ano (creas_2022, q52_1, "Sim", Região, "Povos Indígenas") %>%
    bind_rows(f_selecao_regiao_ano(creas_2022, q52_2, "Sim", Região, "Comunidade Quilombola")) %>%
    #bind_rows(f_selecao_regiao_ano(creas_2022, q52_3, "Sim", Regiao, "Povos Ciganos")) %>%
    bind_rows(f_selecao_regiao_ano(creas_2022, q52_4, "Sim", Região, "Comunidade Ribeirinha")) %>%
    bind_rows(f_selecao_regiao_ano(creas_2022, q52_6, "Sim", Região, "Povos de Matriz Africana e de terreiro")) %>%
    bind_rows(f_selecao_regiao_ano(creas_2022, q52_6, "Sim", Região, "Comunidades Extrativistas")) %>%
    #bind_rows(f_selecao_regiao_ano(creas_2022, q52_99, "Sim", Região, "outros povos e comunidades tradicionais")) %>%

  f_grafico_col_group_percent(Região, Percentual, Ano, 2)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

## Benefícios Eventuais

Entre os benefícios assistenciais, parte da Política de Assistência Social, estão os Benefícios Eventuais, que são concedidos em casos de nascimento, morte, situações de vulnerabilidade provisória e de calamidade pública. Em 2016, 97,0% dos 5.481 municípios que responderam ao Censo SUAS concederam Auxílio Funeral, 93,2% concederam outros benefícios eventuais para famílias em situação de vulnerabilidade temporária, 75,5% concederam benefício eventual para a situação de calamidade pública e 70,7% concederam Auxílio Natalidade (Gráfico 108). Gráfico 108: Percentual de municípios que concederam benefícios eventuais, segundo tipo de benefício ofertado - Brasil, 2016 Fonte: MDS, Censo SUAS.

Em 2016 houve um crescimento no percentual de CRAS que concederam benefícios eventuais maior do que o crescimento que já vinha ocorrendo desde 2010. O percentual de CRAS que concederam auxílios relacionados à segurança alimentar, que já tinha subido de 45,1% em 2010 para 62,8% em 2015, chegou em 2016 a 73,6%. O percentual de CRAS que concederam Auxílio Funeral, que já tinha crescido de 31,0% em 2010 para 45,8% em 2015, chegou em 2016 a 56,7%. Também cresceu significativamente o percentual de CRAS que concederam Auxílio Natalidade, de 38,4% em 2015 para 44,7% em 2016, e que concederam passagens, de 32,0% em 2015 para 39,8% em 2016. O percentual de CRAS que concederam outros benefícios chegou em 2016 a 30,4%, ante 25,7% em 2015 (Gráfico 109). Gráfico 109: Percentual de CRAS que concederam benefícios eventuais, segundo tipo de benefício - Brasil, 2010 a 2016 Fonte: MDS, Censo SUAS.

```{r be-munic, fig.cap = "Percentual de municípios que concedem Benefícios Eventuais - 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

tabela<-gm_2022 %>%
# Questionário 2022:
  select("Situação de Morte"=q56_1_1,
         "Situação de Natalidade"=q56_2_1,
         "Situação de Calamidade Pública"=q56_3_1,
         "Situação de Vulnerabilidade Temporária"=q56_4_1) %>%
#-------------------
  gather("Categoria","Nível") %>%
  mutate(Categoria=str_wrap(Categoria,width=39)) %>%
  mutate(Nível = case_when(Nível=="Sim"~"Concede no Município",
                           Nível=="Não"~"Não Concede no Município",
                           is.na(Nível)~"Não informou",
                           TRUE ~ Nível)) %>%
  group_by(Categoria, Nível) %>%
  summarise(n=n()) %>%
  group_by(Categoria) %>%
  mutate(Percentual = n/sum(n))

ordenado<-tabela %>%
  filter(Nível == "Concede no Município") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  ungroup() %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  mutate(Nível=str_wrap(Nível,width=22)) %>%
  f_grafico_col_stack_percent_flip(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r be-local-qtd, fig.cap = "Local de concessão dos Benefícios Eventuais - 2014-2022", fig.footer = "Fonte: MDS, Censo SUAS."}

```

```{r be-local, fig.cap = "Percentual de local onde os benefícios eventuais são concedidos nos municípios - 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

grafico <- gm_2022 %>%
# Questionário 2022:
  select("Situação de Morte"=q56_1_3,
         "Situação de Natalidade"=q56_2_3,
         "Situação de Calamidade Pública"=q56_3_3,
         "Situação de Vulnerabildiade Temporária"=q56_4_3) %>%

#-------------------
  gather("Categoria","Nível", na.rm=TRUE, factor_key=TRUE) %>%
  mutate(Nível = case_when(Nível=="Em ambas"~"Em ambas",
                           Nível=="Na sede"~"Na sede do órgão gestor",
                           Nível=="Unidades"~"Em unidades da rede socioassistencial",
                           TRUE ~ Nível)) %>%
  mutate(Nível = factor(Nível, levels = c("Na sede do órgão gestor",
                                          "Em unidades da rede socioassistencial",
                                          "Em ambas"))) %>%
  group_by(Categoria, Nível) %>%
  summarise(n=n()) %>%
  group_by(Categoria) %>%
  mutate(Percentual = n/sum(n)) %>%

  f_grafico_col_stack_percent_flip(fct_rev(Categoria), Percentual, Nível, 2)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

# Gestão do Trabalho e Recursos Humanos no SUAS

A qualidade da oferta de serviços, programas e benefícios da assistência social está diretamente ligada a uma adequada gestão do trabalho no âmbito do SUAS. O dimensionamento das equipes, a capacitação dos profissionais e a estruturação das condições de trabalho são fundamentais nesse sentido. Um importante normativo para a gestão do trabalho é Norma Operacional Básica de Recursos Humanos do SUAS (NOB-RH/SUAS)13, que traz orientações e diretrizes, além de detalhamentos importantes sobre as equipes de referência, planos de carreira, cargos e salários, cofinanciamento, educação permanente, entre outros aspectos relevantes. Esta seção apresenta um panorama geral da situação das trabalhadoras e trabalhadores do SUAS, tanto nos equipamentos da assistência social quanto nas gestões municipais e estaduais, apresentando informações sobre quantitativo, tipo de vínculo trabalhista, escolaridade, entre outros aspectos referentes à gestão do trabalho, e sua evolução ao longo dos anos. Em 2016, as Gestões Municipais informaram ter 239.815 trabalhadoras e trabalhadores exercendo funções/atividades ligadas à assistência social (inclusive aqueles lotados nas unidades públicas), o menor número desde 2012. Observando a série histórica é possível verificar que o número máximo de trabalhadores foi registrado no ano de 2014, após sucessivos crescimentos desde 2010. Desde de 2015 esse número se reduziu, registrando em 2016 cerca de 17.000 trabalhadores a menos que em 2014 (Gráfico 60). Gráfico 60: Evolução da quantidade de trabalhadores nas Secretarias Municipais de Assistência Social - Brasil, 2010 a 2016 Fonte: MDS, Censo SUAS.

A quantidade de trabalhadores nas Secretarias Estaduais de Assistência Social em 2016 era de 10.359 profissionais, considerando trabalhadores lotados na sede do órgão gestor e nas unidades públicas que ofertam serviços socioassistenciais. Esse quantitativo vem caindo desde 2010, ano em que foram registrados 19.785 trabalhadores. Entre 2015 e 2016 foi observada redução de 3.258 trabalhadores nas Secretarias Estaduais (Gráfico 66).

```{r qtd-trab-uf, fig.cap ="Evolução da quantidade de trabalhadores nas Secretarias Estaduais de Assistência Social - Brasil e grandes regiões, 2012, 2017 e 2022", fig.footer = "Fonte: MDS, Censo SUAS."}

grafico <- f_soma_regiao_ano(ge_2012, q55e_4, Região, "2012") %>%
  bind_rows(f_soma_regiao_ano(ge_2017, q11_5_4, Região, "2017")) %>%
  bind_rows(f_quantitativo_regiao_ano(gerh_2022, IBGE, "2022")) %>%
  f_grafico_col_group_numero(Região, n, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r qtd_trab_munic, fig.cap ="Evolução da quantidade de trabalhadores nas Secretarias Estaduais de Assistência Social - Brasil, 2012 a 2022" }

```

Em 2016, 48,2% dos trabalhadores das Secretarias Estaduais de Assistência Social eram estatutários (4.997 trabalhadores). Esse percentual é superior ao observado em 2015. Foi observada redução na proporção de celetistas (queda de 5,6 pontos percentuais em relação a 2015) e de trabalhadores com outros vínculos (redução de 4,5 pontos percentuais). Houve aumento de 6,6 pontos percentuais da proporção de trabalhadores comissionados em relação a 2015. Em relação ao total da série histórica, verifica-se a maior proporção de trabalhadores estatutários foi observada em 2011 (54,8% do total de trabalhadores) e a menor em 2015 (44,8% do total). Entre os anos de 2011 a 2013 mais de 50% dos trabalhadores eram estatutários (Gráfico 67). Gráfico 67: Percentual de trabalhadores nas Secretarias Estaduais de Assistência Social, segundo tipo de vínculo -- Brasil, 2010 a 2016 Fonte: MDS, Censo SUAS.

```{r uf_trab_vin, fig.cap ="Percentual de trabalhadores nas Secretarias Estaduais de Assistência Social, segundo tipo de vínculo - Brasil, 2010 a 2022" }

grafico <- f_nomex_somay_nomegrupo(ge_2010, "2010", q34_1_4, "Estatutários") %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2010, "2010", q34_2_4, "Celetistas")) %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2010, "2010", q34_3_4, "Somente Comissionados")) %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2010, "2010", q34_4_4, "Outros Vínculos")) %>%

  bind_rows(f_nomex_somay_nomegrupo(ge_2011, "2011", q55a4, "Estatutários")) %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2011, "2011", q55b4, "Celetistas")) %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2011, "2011", q55c4, "Somente Comissionados")) %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2011, "2011", q55d4, "Outros Vínculos")) %>%

  f_calcula_percentual(Eixo_x, Grupo, Eixo_y) %>%

  f_grafico_col_stack_percent(Eixo_x, Percentual, Grupo, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Os trabalhadores estatutários na gestão municipal representavam 38,1% do total em 2016, o maior percentual entre as quatro categorias representadas. O percentual de estatutários em 2016 foi o maior desde 2011: houve um aumento de 1,9 pontos percentuais em relação a 2015 e 4,1 em relação a 2011. Foi observada queda nos percentuais da força de trabalho comissionada e com outros vínculos em relação a 2015: em 2016 eles representavam 15,7% e 34,6% dos trabalhadores, respectivamente (Gráfico 61). Gráfico 61: Percentual de trabalhadores nas Secretarias Municipais de Assistência Social, segundo tipo de vínculo -- Brasil, 2010 a 2016 Fonte: MDS, Censo SUAS.

Em 2016, 15,2% dos trabalhadores da gestão municipal tinham nível fundamental de escolaridade (36.494 pessoas), 47,2% nível médio (113.112) e 37,6% nível superior (90.209). Da totalidade de servidores com nível fundamental de escolaridade, 43,1% eram estatutários. Entre os que tinham nível superior, 42,8% eram estatutários, e entre os trabalhadores de nível médio 40,5% eram de outros vínculos (Gráfico 62). Gráfico 62: Percentual de trabalhadores nas Secretarias Municipais de Assistência Social, segundo tipo de vínculo e escolaridade -- Brasil, 2016 Fonte: MDS, Censo SUAS.

```{r uf_trab_form, fig.cap ="Percentual de trabalhadores nas Secretarias Estaduais de Assistência Social, segundo escolaridade - Brasil; 2012, 2017 e 2022" }

grafico <- f_nomex_somay_nomegrupo(ge_2012, "2012", q55e_1, "Nível Fundamental") %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2012, "2012", q55e_2, "Nível Médio")) %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2012, "2012", q55e_3, "Nível Superior")) %>%

  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "2017", q11_5_1, "Nível Fundamental")) %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "2017", q11_5_2, "Nível Médio")) %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "2017", q11_5_3, "Nível Superior")) %>%

  bind_rows(f_nomex_grupos_quantitativo(gerh_2022, "2022", d_51_9)) %>%

  f_nivel_ensino(Grupo) %>%

  f_calcula_percentual(Eixo_x, Grupo, Eixo_y) %>%

  f_grafico_col_stack_percent(Eixo_x, Percentual, Grupo, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r munic_trab_form, fig.cap =" Percentual de trabalhadores nas Secretarias municipais de Assistência Social, segundo escolaridade e profissão - Brasil, 2012 a 2022" }

```

Em 2016, 43,8% dos trabalhadores das Secretarias Estaduais de Assistência Social tinham nível superior (4.536 pessoas). Foi a primeira vez desde 2010 que o percentual de profissionais de nível superior superou o percentual de nível médio. Em 2010 mais da metade dos trabalhadores tinham nível médio de escolaridade (52,7%), passando a 39,4% em 2016 (redução de 13,3 pontos percentuais). Também foi observada redução nos percentuais de trabalhadores de nível fundamental: eram 21,6% do total em 2010 e 16,8% em 2016 (redução de 4,8 pontos percentuais) (Gráfico 68). Gráfico 68: Percentual de trabalhadores nas Secretarias Estaduais de Assistência Social, segundo escolaridade-- Brasil, 2010 a 2016 Fonte: MDS, Censo SUAS.

Dos 3.407 trabalhadores das Secretarias Estaduais de Assistência Social que informaram sua formação superior em 2016, 999 (29,3%) eram assistentes sociais, 344 eram psicólogos (10,1%), 310 eram pedagogos (9,1%) e 274 eram advogados (8,0%). Existiam 863 trabalhadores de outras formações de nível superior além das listadas (25,3%) (Gráfico 69). Gráfico 69: Formação profissional dos trabalhadores de nível superior nas Secretarias Estaduais de Assistência Social -- Brasil, 2016 Fonte: MDS, Censo SUAS.

```{r uf_trab_prof, fig.cap ="Percentual de trabalhadores de nível superior nas Secretarias Estaduais de Assistência Social, segundo área de formação - Brasil; 2012, 2017 e 2022" }

f_total_para_outros = function(df, grupo){
  grupo <- quo_name(grupo)

  informados <- df %>%
    filter(Grupo == !! grupo & Eixo_x != "Total" & Eixo_x != "Outros") %>%
    pull(Eixo_y) %>%
    sum()

  total <- df %>%
    filter(Grupo == !! grupo & Eixo_x == "Total") %>%
    pull(Eixo_y)

  df %>%
    mutate(Eixo_y = ifelse(Grupo == !! grupo & Eixo_x == "Total", total - informados, Eixo_y)) %>%
    mutate(Eixo_x = ifelse(Grupo == !! grupo & Eixo_x == "Total", "Outros ou não informado", Eixo_x)) %>%
    filter(Grupo != !! grupo | Eixo_x != "Outros")
}

f_profissao = function(df, profissao){
  profissao <- enquo(profissao)

  df %>%
    mutate(!! profissao := case_when(!! profissao == "Advogado"~"Advogada/o",
                                     !! profissao == "Antropólogo"~"Antropóloga/o",
                                     !! profissao == "Outro profissional de nivel superior"~"Outros ou não informado",
                                     !! profissao == "Pedagogo"~"Pedagoga/o",
                                     !! profissao == "Psicólogo"~"Psicóloga/o",
                                     TRUE ~ as.character(!! profissao)))
}

tabela <- f_nomex_somay_nomegrupo(ge_2012, "Assistente Social", q56a, "2012") %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2012, "Psicóloga/o", q56b, "2012")) %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2012, "Pedagoga/o", q56c, "2012")) %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2012, "Advogada/o", q56d, "2012")) %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2012, "Antropóloga/o", q56e, "2012")) %>%
#  bind_rows(f_nomex_somay_nomegrupo(ge_2012, "Socióloga/o", q56f, "2012")) %>%
#  bind_rows(f_nomex_somay_nomegrupo(ge_2012, "Terapeuta Ocupacional", q56g, "2012")) %>%
#  bind_rows(f_nomex_somay_nomegrupo(ge_2012, "Contador/a", q56h, "2012")) %>%
#  bind_rows(f_nomex_somay_nomegrupo(ge_2012, "Administrador/a", q56i, "2012")) %>%
#  bind_rows(f_nomex_somay_nomegrupo(ge_2012, "Economista", q56j, "2012")) %>%
#  bind_rows(f_nomex_somay_nomegrupo(ge_2012, "Economista Doméstico", q56k, "2012")) %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2012, "Total", q55e_3, "2012")) %>%
  f_total_para_outros("2012") %>%

  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "Assistente Social", q12_1, "2017")) %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "Psicóloga/o", q12_2, "2017")) %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "Pedagoga/o", q12_3, "2017")) %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "Advogada/o", q12_4, "2017")) %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "Antropóloga/o", q12_5, "2017")) %>%
#  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "Socióloga/o", q12_6, "2017")) %>%  #
#  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "Terapeuta Ocupacional", q12_7, "2017")) %>%  #
#  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "Contador/a", q12_8, "2017")) %>%  #
#  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "Estatístico", q12_9, "2017")) %>%  #
#  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "Economista", q12_10, "2017")) %>%  #
#  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "Economista Doméstico", q12_11, "2017")) %>%  #
#  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "Musicoterapeuta", q12_12, "2017")) %>%  #
#  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "Geógrafo", q12_13, "2017")) %>%  #
#  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "Administrador/a", q12_14, "2017")) %>%  #
#  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "Administrador Público/Gestão Pública", q12_15, "2017")) %>%  #
#  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "Profissional de Educação Física", q12_16, "2017")) %>%  #
#  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "Outros", q12_17, "2017")) %>%
  bind_rows(f_nomex_somay_nomegrupo(ge_2017, "Total", q11_5_3, "2017")) %>%
  f_total_para_outros("2017")

tabela_2022 <- gerh_2022 %>%
  select(Eixo_x = d_51_10) %>%
  group_by(Eixo_x) %>%
  summarise(Eixo_y=n()) %>%
  filter(Eixo_x != "Profissional de nível médio") %>%
  f_profissao(Eixo_x) %>%
  mutate(Grupo = "2022")

tabela <- tabela %>%
  bind_rows(tabela_2022) %>%
  f_calcula_percentual(Grupo, Eixo_x, Eixo_y)

ordenado<-tabela %>%
  filter(Grupo == "2022") %>%
  arrange(Eixo_y) %>%
  pull(Eixo_x)

grafico <- tabela %>%
  mutate(Eixo_x = factor(Eixo_x, levels = ordenado)) %>%
  f_grafico_col_percent_flip(Eixo_x, Percentual, Grupo, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Dos 85.011 trabalhadores das Secretarias Municipais de Assistência Social que informaram sua formação superior em 2016, 33.559 (39,5%) eram assistentes sociais, 15.702 eram psicólogos (18,5%) e 10.069 eram pedagogos (11,8% do total). Existiam 14.992 profissionais de outras formações de nível superior além das listadas (17,6% do total) (Gráfico 63). Gráfico 63: Formação profissional dos trabalhadores de nível superior nas Secretarias Municipais de Assistência Social -- Brasil, 2016 Fonte: MDS, Censo SUAS.

```{r munic_trab_prof, fig.cap ="Percentual de trabalhadores nas Secretarias municipais de Assistência Social, segundo escolaridade e profissão - Brasil, 2012 a 2022" }

```

O Artigo 6º da Lei Orgânica de Assistência Social (LOAS) estabelece que os recursos do cofinanciamento do SUAS poderão ser aplicados no pagamento dos profissionais que integrarem as equipes de referência.

Em 2016 havia 89.038 trabalhadores nos CRAS. Embora nesse ano existissem 37.346 trabalhadores a mais que em 2010 nos CRAS, foi observada redução na quantidade desses em relação aos dois anos anteriores: 2.927 profissionais a menos em relação a 2015 e 6.287 em relação a 2014, ano no qual foi registrado o maior número de trabalhadoras e trabalhadores nos CRAS (Gráfico 70). Gráfico 70: Evolução da quantidade de trabalhadores dos CRAS - Brasil, 2010 a 2016 Fonte: MDS, Censo SUAS.

Em 2016, dos 89.038 trabalhadores do CRAS, 34,3% eram servidores estatutários, 6,6% celetistas e 9,4% comissionados. A categoria "Outros Vínculos", que representa 49,8% do total, incluiu Servidores temporários (30,9% do total), terceirizados (4,8%), trabalhador de empresa/ cooperativa/ entidade prestadora de serviços (1,7%), trabalhadores sem vínculo (1,2%), voluntários (0,1%), além de outros vínculos não permanentes (11,1%). O percentual de trabalhadores estatutários cresceu desde 2014 e o de servidores de outros vínculos se reduziu no mesmo período (Gráfico 71). Gráfico 71: Percentual de trabalhadores nos CRAS, segundo tipo de vínculo -- Brasil, 2012 a 2016 Fonte: MDS, Censo SUAS.

```{r munic_unidades, fig.cap =" Evolução da quantidade de trabalhadores dos CRAS, CREAS, Centro Pop, Centro Pop - Brasil, 2012 a 2022" }

```

O percentual de trabalhadores de nível fundamental tem caído desde 2012, passando de 12,5% em 2012 para 10,1% em 2016. A maior proporção de profissionais de nível superior foi observada em 2012 (49,3% do total), que se reduziu até 2014, atingindo 44,1% e passou a aumentar em 2015 e em 2016. Em 2016, 46,3% dos trabalhadores tinham nível superior completo, sendo que 40,2% tinham apenas ensino superior, 5,8% especialização, e 0,4% mestrado ou doutorado. Os trabalhadores de nível fundamental eram 10,1% do total, sendo 0,2% sem escolaridade, 3,7% com nível fundamental incompleto, 3,7% fundamental completo e 2,5% com ensino médio incompleto (Gráfico 72). Gráfico 72: Percentual de trabalhadores nos CRAS, segundo escolaridade-- Brasil, 2012 a 2016 Fonte: MDS, Censo SUAS.

Em 2016, o grupo sem formação profissional seguiu como a maior categoria de trabalhadores nos Centros de Referência de Assistência Social (CRAS), totalizando 22.618 pessoas, seguido de profissionais de nível médio (22.543) e assistentes sociais (17.551). O número de assistentes sociais e de psicólogos permaneceu praticamente estável desde 2014, enquanto o de profissionais de nível médio e de trabalhadores sem formação profissional caiu desde o mesmo ano. A categoria "Outras formações de nível superior" totalizou 7.548 profissionais em 2016, sendo: 127 terapeutas ocupacionais, 11 antropólogos, 691 administradores, 45 economistas, 54 analistas de sistemas, 4 programadores, 76 sociólogos, 119 fisioterapeutas, 88 nutricionistas, 78 enfermeiros, 4 médicos, 3 cientistas políticos e 6.248 profissionais de outras formações superiores (Gráfico 73). Gráfico 73: Formação profissional dos trabalhadores dos CRAS - Brasil, 2012 a 2016 Fonte: MDS, Censo SUAS. (\*) A categoria engloba os outros profissionais de nível superior, incluindo terapeuta ocupacional, antropólogo, administrador, economista, analista de sistema, programador, sociólogo, fisioterapeuta, nutricionista, enfermeiro, médico e cientista político.

Em 2016, no que se refere à quantidade de trabalhadores segundo a função que exerciam nos CRAS, 24.886 profissionais atuavam como Técnicos de nível superior (27,9% do total) e 18.124 como Educadores Sociais (20,4% do total). Entre as funções categorizadas, as menos observadas foram a de estagiário, com 1.830 trabalhadores (2,1% do total) e de cadastrador, com 2.430 trabalhadores (2,7% do total). A função de coordenador(a) era exercida por 7.907 profissionais em 2016 (8,9% do total) (Gráfico 74). Em 70,1% dos CRAS, o Coordenador exercia exclusivamente a função, enquanto em 18,6% das unidades o coordenador acumulava as funções com outra atividade da Secretaria Municipal de Assistência Social, e em 18,6% acumulavam as funções de coordenador e de técnico no CRAS. Em 3,3% das unidades não havia coordenador. Gráfico 74: Quantidade de funcionários por CRAS segundo a função exercida - Brasil, 2016 Fonte: MDS, Censo SUAS.

Em 2016, foram registrados 65.233 trabalhadoras/es nos Centros de Convivência. Entre 2014 e 2015 houve uma redução de 33.884 trabalhadores nas unidades. Já em 2016 foi observado um aumento de 5.009 profissionais em relação ao ano anterior, quando foram registrados 60.224 trabalhadores (Gráfico 75). Gráfico 75: Evolução da quantidade de trabalhadores dos Centros de Convivência - Brasil, 2014 a 2016 Fonte: MDS, Censo SUAS.

Em 2016, 28.234 trabalhadores dos Centros de Convivência eram empregados celetistas do setor privado (43,3% do total), 7.646 eram servidores estatutários (11,7%) e 3.692 eram empregados públicos celetistas (5,7%). Dos 5.008 profissionais a mais registrados em 2016 em relação a 2015, 2.378 (47,5%) eram empregados celetistas do setor privado, e 704 (14,1%) servidores estatutários (Gráfico 76). Gráfico 76: Quantidade de trabalhadores dos Centros de Convivência segundo tipo de vínculo - Brasil, 2015 e 2016 Fonte: MDS, Censo SUAS.

Dos profissionais dos Centros de Convivência no ano de 2016, 40,2% tinham nível superior: 34,4% (22.467 trabalhadores) tinham ensino superior completo, 5,1% (3.345) especialização, 0,5% (339) mestrado e 0,1% (74) doutorado. Os trabalhadores de nível fundamental eram 17,4% do total (11.344 trabalhadores), sendo 0,5% (353) sem escolaridade, 6,5% (4.224) com nível fundamental incompleto, 6,5% (4.269) com nível fundamental completo e 3,8% (2.498) com nível médio incompleto. A maior porcentagem foi observada para profissionais de nível médio (42,4% do total de trabalhadores): 31,1% tinham ensino médio completo e 11,3% ensino superior incompleto (Gráfico 77). Gráfico 77: Percentual de trabalhadores dos Centros de Convivência segundo escolaridade - Brasil, 2015 e 2016 Fonte: MDS, Censo SUAS.

No que se refere às profissões dos trabalhadores nos Centros de Convivência, 18.517 (28,4%) não tinham formação profissional e 17.362 (26,6%) eram profissionais de nível médio. A formação de nível superior com maior número de trabalhadores foi de pedagogo, com 6.378 profissionais (que representavam 9,8% do total), seguidos de assistentes sociais (4.463 ou 6,8% do total) e de psicólogos (2.626 ou 4,0%) (Gráfico 78). Não houve variações expressivas em relação ao ano de 2015. Gráfico 78: Formação profissional dos trabalhadores dos Centros de Convivência - Brasil, 2015 e 2016 Fonte: MDS, Censo SUAS.

Quanto a função exercida pelos trabalhadores dos Centros de Convivência em 2016, 19.184 desempenhavam a função de educador(a) social (29,4% do total), e 9.961 de serviços gerais (15,3%). Havia 5.164 coordenadores(as), o que representava 7,9% do total de trabalhadores. A função com o menor número de trabalhadores foi a de estagiário (1.130 trabalhadores, ou 1,7% do total) (Gráfico 79). Gráfico 79: Quantidade de trabalhadores dos Centros de Convivência segundo a função exercida - Brasil, 2016 Fonte: MDS, Censo SUAS.

Quanto a equipe de recursos humanos dos CREAS observa-se desde 2010 que o número de profissionais vem aumentando progressivamente, passando de 14.575 para 22.680 em 2016, o que representa um acréscimo de 8.105 trabalhadores ao longo do período e 392 a mais em relação ao ano anterior (Gráfico 80). Gráfico 80: Evolução da quantidade de trabalhadores dos CREAS - Brasil, 2010 a 2016 Fonte: MDS, Censo SUAS.

Desde 2012 observou-se um aumento na quantidade de trabalhadores estatutários nos CREAS, que passaram de 6.549 em 2012 (32,9% do total) para 9.233 em 2016 (40,7% do total), uma diferença de 2.684 estatutários a mais no período, o que corresponde a 95,7% do acréscimo de 2.804 ao total de trabalhadores observado entre os anos de 2012 e 2016. Em 2016, os 9.233 servidores estatutários representavam 40,7% do total, sendo o grupo mais numeroso. Eram seguidos dos 5.906 temporários (26,0%), e de 2.061 trabalhadores de outros vínculos não permanentes (9,1%). Os grupos menos numerosos eram voluntários (24 trabalhadores ou 0,1%) e sem vínculo (219 trabalhadores ou 1,0%) (Gráfico 81). Gráfico 81: Quantidade de trabalhadores nos CREAS segundo tipo de vínculo - Brasil, 2012 a 2016 Fonte: MDS, Censo SUAS.

Desde 2012, a maior parte dos trabalhadores dos CREAS tinha nível superior: naquele momento eram 62,9% dos trabalhadores (12.511), passando a 65,5% em 2016 (14.863). Foi observada queda na proporção de trabalhadores de nível fundamental, de 8,3% do total de trabalhadores em 2012 (1.654) para 7,5% em 2016 (1.705) (Gráfico 82). Gráfico 82: Percentual de trabalhadores dos CREAS segundo escolaridade - Brasil, 2012 a 2016 Fonte: MDS, Censo SUAS.

Ao longo da série histórica, observou-se um aumento no quantitativo de assistentes sociais, que era a formação profissional com o maior número de trabalhadores nos CREAS em todos os anos observados. Em 2016, existiam 6.064 assistentes sociais (26,7% dos trabalhadores dos CREAS). Na sequência aparecem os psicólogos, que totalizavam 4.376 profissionais (19,3% do total), seguidos de profissionais de nível médio, que totalizavam 3.865 pessoas (17,0% do total). Pode-se observar também que a quantidade de profissionais sem formação profissional vem se reduzindo desde 2012, atingindo o quantitativo de 3.893 pessoas em 2016 (17,2% do total de trabalhadores) (Gráfico 83). Gráfico 83: Quantidade de trabalhadores dos CREAS segundo formação profissional - Brasil, 2012 a 2016 Fonte: MDS, Censo SUAS. (\*) A categoria engloba os outros profissionais de nível superior, incluindo terapeuta ocupacional, antropólogo, economista, analista de sistema, programador, sociólogo, fisioterapeuta, nutricionista, enfermeiro, médico e cientista político.

A maior parte dos trabalhadores dos CREAS era de técnicos de nível superior: esses representavam 8.919 trabalhadores (44,9% do total) em 2012 e 10.636 (46,9%) em 2016. Neste ano a função de educador social era exercida por 2.620 trabalhadores (11,6% do total), a função apoio administrativo era exercida por 2.415 trabalhadores (10,6%), enquanto a função Coordenador por 2.366 (10,4%). As funções exercidas pelos menores quantitativos de trabalhadores em 2016 eram a de técnico de nível médio (322 trabalhadores ou 1,4% do total) e de estagiário (500 trabalhadores ou 2,2% do total) (Gráfico 84). Gráfico 84: Quantidade de trabalhadores dos CREAS segundo a função exercida -- Brasil, 2012 a 2016 Fonte: MDS, Censo SUAS.

Entre 2011 e 2016, o quantitativo de trabalhadores atuando nos Centros de Referência Especializados em População em Situação de Rua (Centro POP) aumentou continuamente, com acréscimo de 1.929 trabalhadores no período, apesar de entre os anos de 2015 e 2016 ter sido registrado o menor aumento, com acréscimo de 8 trabalhadores (Gráfico 85). Gráfico 85: Evolução da quantidade de trabalhadores dos Centros POP - Brasil, 2011 a 2016 Fonte: MDS, Censo SUAS.

```{r uf-cras-form, fig.cap ="Quantidade de Trabalhadores segundo a formação profissional - CRAS - Brasil, 2012 a 2022" }

```

```{r uf-creas-form, fig.cap ="Quantidade de Trabalhadores segundo a formação profissional - CREAS - Brasil, 2012 a 2022" }

```

```{r uf-cpop-form, fig.cap ="Quantidade de Trabalhadores segundo a formação profissional - Centro Pop - Brasil, 2012 a 2022" }

```

```{r uf-equip-vol, fig.cap ="Percentual de unidades de CRAS que possuem equipe volante  - Brasil, 2012 a 2022" }

```

```{r unid-acol, fig.cap ="Evolução da quantidade de trabalhadores (as) das Unidades de Acolhimento - Brasil, 2012 a 2022" }

```

```{r trab-sexo-estadual, fig.cap ="Percentual de trabalhadores (as) quanto ao sexo - estadual " }

```

```{r trab-sexo-municipal, fig.cap ="Percentual de trabalhadores (as) quanto ao sexo - municipal " }

```

Em 2016, 41,4% dos trabalhadores eram estatutários (1.290 pessoas), a maior proporção entre as categorias selecionadas. Na sequência apareceram os servidores temporários (524 pessoas ou 16,8% do total) e os terceirizados (378 trabalhadores, ou 12,1% do total). Em 2016, foi observada a maior proporção de trabalhadores estatutários desde 2012: passaram de 39,5% do total de trabalhadores em 2012 (646) para 41,4% em 2016 (1.290 trabalhadores). Também aumentaram entre 2012 e 2016 o percentual e o número absoluto de trabalhadores temporários, que passaram de 12,2% do total de trabalhadores 2012 (199) para 16,8% 2016 (524), embora a proporção venha se reduzindo desde 2014, quando os trabalhadores temporários eram 20,6% do total (625). As categorias com menores percentuais em 2016 eram as de trabalhadores sem vínculo (1,0% do total) e de voluntários (0,2%) (Gráfico 86). Gráfico 86: Percentual de trabalhadores dos Centros POP segundo tipo de vínculo - Brasil, 2012 a 2016 Fonte: MDS, Censo SUAS.

Quanto ao nível de escolaridade dos profissionais dos Centros POP em 2016, 47,6% (1.482) tinham nível superior de escolaridade, um acréscimo de 3 pontos percentuais em relação a 2012. Foi observada redução na proporção de trabalhadores de nível fundamental ao longo do período chegando a 11,2% em 2016 (Gráfico 87). Gráfico 87: Percentual de trabalhadores dos Centros POP segundo nível de escolaridade - Brasil, 2012 a 2016 Fonte: MDS, Censo SUAS.

Em 2016, dos 3.116 trabalhadores dos Centros POP, 1.392 (44,7% do total) estavam na categoria "sem formação profissional/ sem informação", enquanto 296 (9,5%) eram profissionais de nível médio. Entre as formações profissionais de nível superior detalhadas, havia 598 assistentes sociais, (19,2% do total), 325 psicólogos (10,4%) e 99 pedagogos (3,2%). No comparativo entre os anos, observou-se queda no número de profissionais de nível médio entre 2015 e 2016 (661 trabalhadores a menos) e aumento na quantidade de trabalhadores sem formação profissional/ sem informação. As demais categorias não sofreram alterações expressivas (Gráfico 88). Gráfico 88: Quantidade de trabalhadores dos Centros POP segundo formação profissional -- Brasil, 2012 a 2016 Fonte: MDS, Censo SUAS. (\*) A categoria "Outro profissional de nível superior" inclui administradores, sociólogos, terapeutas ocupacionais, fisioterapeutas, enfermeiros, nutricionistas, economistas, analistas de sistemas, cientistas políticos, programadores, antropólogos e profissionais de outras formações de nível superior.

Entre 2012 e 2016, as funções de técnico de nível de ensino superior e Educador Social eram as exercidas pelo maior número de trabalhadores dos Centros de Referência Especializados para População em Situação de Rua (Centro POP). Em 2012, havia 467 educadores sociais (28,5% dos trabalhadores) e 425 técnicos de nível superior (26,0%). Em 2016 os números eram 883 (28,3%) e 838 (26,9%), respectivamente. Os coordenadores eram, em 2016, 223 trabalhadores (7,2% do total) (Gráfico 89). Gráfico 89: Número de trabalhadores dos Centros POP segundo a função exercida -- Brasil, 2012 a 2016 Fonte: MDS, Censo SUAS.

Em 2016 foram registrados 25.151 trabalhadores nos Centros-Dia, 2.667 a mais que em 2015. Ao observar a distribuição de trabalhadores por grandes regiões, verifica-se que em 2016 havia 14.800 trabalhadores na região Sudeste (58,8% do total), 5.053 na região Sul (20,1%), 2.603 na região Nordeste (10,3%), 2.469 na região Centro-Oeste (9,8%) e 227 na região Norte (0,9%). Entre 2015 e 2016 foi verificado aumento de 995 trabalhadores na região Nordeste (Gráfico 90). Gráfico 90: Evolução da quantidade de trabalhadores dos Centros-Dia, segundo grandes regiões - Brasil, 2015 e 2016 Fonte: MDS, Censo SUAS.

A maior parte dos trabalhadores nos Centros-Dia eram empregados celetistas do setor privado: em 2015 eram 12.844, representando 57,1% do total, e em 2016 eram 14.104 pessoas, representando 56,1% do total. O tipo de vínculo com o segundo maior percentual de trabalhadores foi o de servidores estatutários: eram 13,8% do total (3.093 trabalhadores) em 2015 e 12,9% (3.248 trabalhadores) em 2016 (Gráfico 91). Gráfico 91: Percentual de trabalhadores dos Centros-Dia segundo tipo de vínculo - Brasil, 2015 e 2016 Fonte: MDS, Censo SUAS.

Quanto ao nível de escolaridade, em 2016 15.263 trabalhadores dos Centros-Dia (60,7% do total) tinham nível superior. Embora tenha sido observado aumento de 1.330 trabalhadores de nível superior entre 2015 e 2016, proporcionalmente esta categoria foi reduzida de 62,0% dos 22.484 trabalhadores em 2015 para 60,7% dos 25.151 trabalhadores em 2016. Em 2016 houve aumento de 893 trabalhadores de nível médio em relação a 2015 (Gráfico 92). Gráfico 92: Quantidade de trabalhadores segundo nível de escolaridade nos Centros-Dia - Brasil, 2015 e 2016 Fonte: MDS, Censo SUAS.

Já em relação a formação profissional dos 25.151 trabalhadores dos Centros-Dia em 2016, 3.315 profissionais tinham a formação profissional de pedagogo (13,2% do total), o maior número entre as formações de nível superior categorizadas. Na sequência aparecem os profissionais de nível médio (2.584 pessoas, representando 10,3% do total), os psicólogos (1.267 trabalhadores, ou 5,0% do total) e os assistentes sociais (1.096 trabalhadores, o que representa 4,4% do total). Em comparação ao ano de 2015, foi observado aumento na categoria "não informado": eram 764 trabalhadores em 2015 (3,4% do total) e passaram a 6.819 (27,1% do total), a categoria mais numerosa em 2016 (Gráfico 93). Gráfico 93: Quantidade de trabalhadores dos Centros-Dia segundo formação profissional -- Brasil, 2015 e 2016 Fonte: MDS, Censo SUAS. (\*) A categoria "Outra formação de nível superior" inclui advogados, antropólogos, economistas, analistas de sistemas, programadores, sociólogos, cientistas políticos, e profissionais de outras formações de nível superior.

Em 2016, 8.493 trabalhadores dos Centros-Dia exerciam a função de técnico de nível superior (33,8% do total de trabalhadores), 2.916 a função de orientadores/educadores sociais (11,6%), 2.718 tinham função de serviços gerais (10,8%), 2.034 trabalhadores tinham função de apoio administrativo (8,1%), 1.198 profissionais eram cuidadores (4,8%), 918 eram coordenadores (3,8%), 297 eram estagiários (1,2%) e 253 eram auxiliares de cuidador (1,0%). Já a categoria "outros" foi a segunda mais numerosa, com 6.324 trabalhadores (25,1%). Em todas as regiões a categoria mais numerosa foi a de técnicos de nível superior, com exceção da região Centro-Oeste, na qual a categoria mais numerosa foi "outros" (804 trabalhadores ou 32,6% dos trabalhadores da região) (Gráfico 94). Gráfico 94: Quantidade de trabalhadores dos Centros-Dia segundo função e grandes regiões -- Brasil, 2016 Fonte: MDS, Censo SUAS.

Em 2016 foram registrados 89.384 trabalhadores nas Unidades de Acolhimento, o maior número desde 2012. Nesse período, foi observado aumento de 22.358 trabalhadores nas Unidades. Houve queda na quantidade entre 2012 e 2013, mas desde então o número segue crescendo. Entre 2015 e 2016 foi registrado aumento de 5.560 trabalhadores (Gráfico 95). Gráfico 95: Evolução da quantidade de trabalhadores das Unidades de Acolhimento - Brasil, 2012 a 2016 Fonte: MDS, Censo SUAS.

Em relação ao tipo de vínculo dos trabalhadores, o maior percentual observado em 2016 foi de empregados celetistas do setor privado, que representavam 31,8% do total de trabalhadores (28.388 trabalhadores). Em seguida apareceram os empregados públicos celetistas (16,5% do total, o que representa 14.767 trabalhadores) e servidores estatutários (13,4% do total ou 12.017 trabalhadores). Os menores percentuais foram de trabalhadores sem vínculo (1% do total ou 871 trabalhadores) e voluntários (2,6% do total ou 2.281) (Gráfico 96). Gráfico 96: Percentual de trabalhadores nas Unidades de Acolhimento segundo tipo de vínculo - Brasil, 2016 Fonte: MDS, Censo SUAS.

Em 2016, 47,8% dos trabalhadores das Unidades de Acolhimento tinham nível médio de escolaridade (42.683 trabalhadores), a categoria mais numerosa entre as três observadas. Os menores percentuais eram referentes aos trabalhadores de nível superior, que representavam em 2016 24,6% do total (22.022 trabalhadores). Foi observada redução de 1,9 pontos percentuais na proporção de trabalhadores de nível fundamental entre 2013 e 2016. Os percentuais de trabalhadores com nível superior oscilaram pouco ao longo da série histórica (Gráfico 97). Gráfico 97: Percentual de trabalhadores das Unidades de Acolhimento segundo nível de escolaridade - Brasil, 2013 a 2016 Fonte: MDS, Censo SUAS.

Quanto a formação profissional, em 2016 43.669 trabalhadores das Unidades de Acolhimento (48,9% do total) eram profissionais de nível médio. O número de trabalhadores com essa formação cresceu desde 2014, tanto em números absolutos quanto proporcionalmente: passou de 20.853 trabalhadores em 2014 (27,6% do total) para 43.669 (48,9%) em 2016. O contrário foi observado em relação aos trabalhadores sem formação profissional, segunda maior categoria: em 2014 eram 34.458 trabalhadores (45,6% do total) e em 2016 eram 24.692 trabalhadores (27,6% do total). Em 2016, as duas categorias somadas representavam 76,5% do total de trabalhadores (68.381). A formação de nível superior com o maior número de trabalhadores foi a de assistente social, com 5.810 trabalhadores, que representavam 8,5% do total em 2016, seguida de psicólogos (3.896 trabalhadores ou 4,4% do total). Ambas formações profissionais de nível superior foram as mais observadas também nos anos de 2014 e 2015 (Gráfico 98). Gráfico 98: Quantidade de trabalhadores das Unidades de Acolhimento segundo formação profissional -- Brasil, 2014 a 2016 Fonte: MDS, Censo SUAS. (\*) A categoria "Outra formação de nível superior" inclui advogados, administradores, analistas de sistemas, antropólogos, cientistas políticos, economistas, fisioterapeutas, médicos, nutricionistas, programadores, sociólogos, terapeutas ocupacionais e profissionais de outras formações de nível superior.

Com relação a função profissional dos trabalhadores nas unidades de acolhimento, em 2016 a função com o maior número de trabalhadores foi a de cuidador (20.657 profissionais ou 23,1% do total de trabalhadores). Em seguida apareceram as funções de serviços gerais (17.941 trabalhadores ou 20,1% do total) e técnicos de nível superior (13.011 ou 14,6%). Entre 2015 e 2016 houve aumento de 3.937 pessoas na categoria "outros". Dentre as funções indicadas, o maior aumento na quantidade de trabalhadores foi observado para a função de cozinheiro, com acréscimo de 1.219 pessoas. A maior redução foi observada na função de serviços gerais, com redução de 1.380 trabalhadores no período (Gráfico 99). Gráfico 99: Quantidade de trabalhadores das Unidades de Acolhimento segundo função profissional -- Brasil, 2015 e 2016 Fonte: MDS, Censo SUAS.

Em 2016, havia mais profissionais do sexo feminino que profissionais do sexo masculino nos equipamentos da assistência social. Nos Centros-Dia, 84,5% (21.255) eram do sexo feminino, enquanto 15,5% (3.896) eram do sexo masculino, percentuais próximos aos observados nos CRAS, CREAS e Unidades de Acolhimento. Nos CRAS 81,8% dos profissionais (72.853) eram do sexo feminino, assim como 81,0% nos CREAS (18.380) e 80,7% nas Unidades de Acolhimento (72.097). Os menores percentuais foram observados nos Centros POP: 65,3% (2.036) eram do sexo feminino, enquanto 34,7% eram do sexo masculino (1.080). Nos Centros de Convivência 77,4% (50.459) eram do sexo feminino e 22,6% (14.774) do sexo masculino) (Gráfico 100). Gráfico 100: Percentual de profissionais dos equipamentos de assistência social segundo sexo -- Brasil, 2016 Fonte: MDS, Censo SUAS.

Considerações Finais Em 2016 foram registrados pelo Censo SUAS os seguintes quantitativos de trabalhadores: 89.038 nos CRAS, 22.680 nos CREAS, 3.116 nos Centros POP, 89.384 nas Unidades de Acolhimento e 65.233 nos Centros de Convivência. Para o mesmo ano, foram contabilizados 239.815 trabalhadores nas Secretarias Municipais de Assistência Social no país. A maior parte da força de trabalho da assistência social nos órgãos gestores estaduais e municipais é composta de servidores estatutários. Além disso, observa-se uma evolução positiva ao longo da série histórica no quantitativo de profissionais atuando nos Centros POP: em 2011, havia 1.187 e em 2016, 3.116 trabalhadores. Quanto à escolaridade dos trabalhadores das Secretarias Estaduais de Assistência Social, percebe-se que a maioria deles (43,8%) possui ensino superior, tendo esse percentual aumentado em relação a 2015 e sendo o maior percentual desde o início da série histórica, em 2010. Por sua vez, o percentual de trabalhadores com ensino médio atingiu em 2016 o menor valor da série histórica, 39,4%. Os Centros de Convivência seguiram a tendência das demais unidades, contando com 40,2% de profissionais de nível superior e 42,4% com nível médio. Já as Unidades de Acolhimento, quando comparadas aos demais equipamentos, ainda apresentam um alto percentual de trabalhadores apenas com nível fundamental, 27,6% Em que pese a expansão no número de trabalhadores, e aumento da escolaridade, a melhoria na qualidade dos atendimentos e serviços permanece como desafio para a gestão dos recursos humanos da assistência social no País.

Capítulo 5 -- Serviços ofertados pelo SUAS Os programas e serviços prestados no âmbito da política pública de Assistência Social buscam garantir o acesso a direitos sociais a quem necessita. As famílias são as unidades de referência para a prestação de serviços socioassistenciais, que visam a fortalecer sua autonomia e seus vínculos externos e internos. Esses serviços buscam atender as necessidades básicas da população, por meio de atividades que promovam melhoria nas condições de vida. No âmbito do SUAS, a Proteção Social é dividida em Básica e Especial, de média ou alta complexidade, com foco nas famílias, indivíduos e grupos que necessitem. A Proteção Social Básica busca a prevenção dos riscos sociais, enquanto a Especial tem natureza mais protetiva, destinada a indivíduos que já se encontram em situação de risco. A concepção e a implementação dos serviços socioassistenciais são fundamentadas na centralidade da família. Os benefícios assistenciais, também parte da Política de Assistência Social, constituem direito dos cidadãos e dividem-se entre Benefícios de Prestação Continuada (BPC), que garante renda a maiores de 65 anos ou à pessoa com deficiência, e Benefícios Eventuais, concedidos em casos de nascimento, morte, situações de vulnerabilidade provisória e de calamidade pública. A gestão participativa e a descentralização político-administrativa são diretrizes centrais do SUAS. A União, os estados e os municípios possuem responsabilidades estabelecidas para a gestão e prestação dos serviços de assistência social, em um contexto de cooperação e articulação conjunta de ações, conforme atribuições previstas na Lei Orgânica da Assistência Social (LOAS) e na Política Nacional de Assistência Social (PNAS). Os serviços de caráter regional e os benefícios assistenciais que compõem a política de assistência social se enquadram nesse modelo de gestão. A PNAS é aplicada de forma integrada a outras políticas públicas sempre que as ações fugirem do escopo da Assistência Social. Este capítulo apresenta informações a respeito dos benefícios e dos serviços prestados ao público-alvo da Assistência Social. SERVIÇOS DE PROTEÇÃO SOCIAL BÁSICA Os Serviços da Proteção Social Básica são compostos pelo Serviço de Proteção e Atendimento Integral à Família (PAIF), Serviço de Convivência e Fortalecimento de Vínculos e pelo Serviço de Proteção Social Básica no domicílio para pessoas com deficiência e idosas. Os Serviços da Proteção Social Básica buscam a prevenção de vulnerabilidades e riscos sociais. O PAIF, segundo a Tipificação Nacional de Serviços Socioassistenciais14, "consiste no trabalho social com famílias, de caráter continuado, com a finalidade de fortalecer a função protetiva das famílias, prevenir a ruptura dos seus vínculos, promover seu acesso e usufruto de direitos e contribuir na melhoria de sua qualidade de vida. Prevê o desenvolvimento de potencialidades e aquisições das famílias e o fortalecimento de vínculos familiares e comunitários, por meio de ações de caráter preventivo, protetivo e proativo. O trabalho social do PAIF deve utilizar-se também de ações nas áreas culturais para o cumprimento de seus objetivos, de modo a ampliar universo informacional e proporcionar novas vivências às famílias usuárias do serviço. As ações do PAIF não devem possuir caráter terapêutico". O PAIF é ofertado nos Centros de Referência de Assistência Social (CRAS). Dentre os 8.240 CRAS em funcionamento em 2016, 99,4% realizaram visitas domiciliares, 99,1% fizeram acompanhamento de famílias e 98,4% encaminharam as famílias para inserção ou atualização no Cadastro Único. A atividade executada pelo menor percentual de CRAS em 2016 foi a elaboração de Plano de Acompanhamento Familiar, atividade realizada por 68,6% dos CRAS (Gráfico 101). Gráfico 101 - Percentual de CRAS que desenvolveram ações e atividades no âmbito do Serviço de Proteção e Atendimento Integral à Família (PAIF) - Brasil, 2016 Fonte: MDS, Censo SUAS.

Por sua vez, o Serviço de Convivência e Fortalecimento de Vínculos (SCFV), também segundo a Tipificação Nacional de Serviços Socioassistenciais15, é o "serviço realizado em grupos, organizado a partir de percursos, de modo a garantir aquisições progressivas aos seus usuários, de acordo com o seu ciclo de vida, a fim de complementar o trabalho social com famílias e prevenir a ocorrência de situações de risco social. Forma de intervenção social planejada que cria situações desafiadoras, estimula e orienta os usuários na construção e reconstrução de suas histórias e vivências individuais e coletivas, na família e no território. Organiza-se de modo a ampliar trocas culturais e de vivências, desenvolver o sentimento de pertença e de identidade, fortalecer vínculos familiares e incentivar a socialização e a convivência comunitária. Possui caráter preventivo e proativo, pautado na defesa e afirmação dos direitos e no desenvolvimento de capacidades e potencialidades, com vistas ao alcance de alternativas emancipatórias para o enfrentamento da vulnerabilidade social". Dentre os CRAS em funcionamento em 2016, 85,9% prestavam diretamente serviços de Convivência e Fortalecimento de Vínculos (SCFV), o menor percentual desde 2011. O maior percentual foi registrado em 2013, com 92,6% dos CRAS executando diretamente os SCFV (Gráfico 102). Gráfico 102 - Percentual de CRAS que executavam diretamente os Serviços de Convivência e Fortalecimento de Vínculos - Brasil, 2008 a 201616 Fonte: MDS, Censo SUAS.

Ao analisar por público alvo dos serviços, verifica-se que 78,9% dos CRAS atenderam idosos, número que ficou 2,8 pontos percentuais abaixo do que foi registrado em 2015. Quedas similares, entre 2,2 e 3,0 pontos percentuais ocorreram em todas as faixas etárias de público alvo (Gráfico 103). Gráfico 103 - Percentual de CRAS que executavam diretamente os Serviços de Convivência e Fortalecimento de Vínculos, segundo faixa etária atendida - Brasil, 2015 e 201617 Fonte: MDS, Censo SUAS.

Ao analisar a oferta de Serviços de Convivência e Fortalecimento de Vínculos (SCFV) por região, verifica-se que a região Norte apresenta os maiores percentuais de CRAS que o executam, seguida da região Nordeste e da região Centro-Oeste. Essa ordem se repete nas faixas etárias dos idosos e das pessoas de 0 a 17 anos. Nas faixas etárias de 18 a 59 anos ocorre uma inversão entre as regiões, e a região Sudeste é a que apresenta os maiores percentuais de CRAS que atenderam esse público, seguida da região Sul (Gráfico 104). Gráfico 104: Percentual de CRAS que executam diretamente os serviços de Convivência e Fortalecimento de Vínculos, segundo grandes regiões - Brasil, 2016 Fonte: MDS, Censo SUAS.

Os CRAS, Centros de Referência de Assistência Social, podem executar diretamente os Serviços de Convivência e Fortalecimento de Vínculos (SCFV), ou através de rede referenciada ao CRAS. Em 2016, houve queda no número de CRAS que possuíam rede referenciada para oferta desses serviços, em todas as faixas etárias de público atendido (Gráfico 105). Gráfico 105: Quantidade de CRAS cuja rede referenciada oferta Serviço de Convivência e Fortalecimento de Vínculos, segundo faixa etária atendida - Brasil, 2015 e 2016 Fonte: MDS, Censo SUAS.

Os Serviços de Convivência e Fortalecimento de Vínculos podem ser ofertados nos CRAS ou nos Centros de Convivência. O percentual de Centros de Convivência que executaram diretamente esses serviços em cada faixa etária de público atendido se manteve praticamente estável entre 2014 e 2016. O público de 7 a 14 foi o que teve o maior percentual de atendimento em 2016, 72,0% dos 8.453 Centros de Convivência atenderam a essa faixa etária. Os públicos menos atendidos foram os das faixas etárias de 18 a 29 anos e de 30 a 59 anos, que foram atendidos em apenas 22,9% e 23,8% dos Centros de Convivência, respectivamente (Gráfico 106). Gráfico 106: Percentual de Centros de Convivência que executaram diretamente os Serviços de Convivência e Fortalecimento de Vínculos, segundo faixa etária atendida - Brasil, 2014 a 2016 Fonte: MDS, Censo SUAS.

O percentual das 8.444 unidades de Centros de Convivência que promoveram sistematicamente oficinas em 2016 foi de 91,3%. As atividades recreativas, palestras e reuniões com grupos de famílias dos usuários ocorrem em mais de 80% das unidades. Apenas 19,8% relataram ter promovido sistematicamente atividades de reforço escolar. Menos de 1% não realizam nenhuma atividade do Serviço de Convivência (Gráfico 107). Gráfico 107: Percentual de unidades de Centros de Convivência que promoveram atividades do Serviço de Convivência - Brasil, 2016 Fonte: MDS, Censo SUAS.

Em 2016, caiu em todas as regiões o percentual (e também o número absoluto) de unidades de CRAS que possuem equipe volante, que é uma equipe técnica adicional (além do número previsto pela NOB-RH/SUAS) específica para deslocamento visando o atendimento à população em territórios extensos e áreas isoladas. A região Norte é a que tinha o maior percentual de unidades de CRAS que possuem equipe volante, com 35,2%, seguida da região Centro-Oeste, com 28,4% (Gráfico 111). Gráfico 111 - Percentual de unidades de CRAS que possuem equipe técnica adicional (além do número previsto pela NOB-RH/SUAS) específica para deslocamento visando o atendimento à população em territórios extensos e áreas isoladas, segundo grandes regiões - Brasil, 2011 a 2016 Fonte: MDS, Censo SUAS.

Em relação a realização de concurso público para trabalhadores (as) de nível superior, percebe-se que os anos de 2013 e 2015 foram os anos com maior número de municípios realizaram, 26,7% e 17,2% respectivamente.

Em 2016, 468 Municípios informaram ter realizado concurso público para a Secretaria Municipal de Assistência Social no ano de 2015 (8,5% do total de respondentes). Desses, 270 realizaram concurso para profissionais de nível médio e superior (4,9% do total), 164 apenas para nível superior (3,0%) e 34 apenas para nível médio (0,6%) (Gráfico 64). Foram ofertadas 1.823 vagas de nível superior e 2.152 de nível médio. Os municípios informaram que 1.492 trabalhadores tomaram posse no concurso de nível superior (81,8% das vagas foram ocupadas) e 1.592 tomaram posse no concurso de nível médio (74,0% das vagas foram ocupadas). Gráfico 64: Número de municípios segundo realização de concurso público para Secretarias Municipais de Assistência Social -- Brasil, 2016 Fonte: MDS, Censo SUAS.

O (\Cref{fig:conc_munic}) referencia a linha histórica dos últimos 10 anos.

```{r conc_munic, fig.cap = "Percentual de municípios que realizaram concursos para trabalhadores nível superior do SUAS - Brasil, - Brasil, 2012 a 2022", fig.footer = "Fonte: MDS, Censo SUAS"}

grafico <- f_sim_nao(gm_2012, q43a_1, "2012") %>%
  bind_rows(f_sim_nao(gm_2013, q36_8, "2013")) %>%
  bind_rows(f_sim_nao(gm_2014, q51_1_1, "2014")) %>%
  bind_rows(f_sim_nao(gm_2015, q38_1a, "2015")) %>%
  bind_rows(f_sim_nao(gm_2016, q19_1, "2016")) %>%
  bind_rows(f_sim_nao(gm_2017, q30.1.1, "2017")) %>%
  bind_rows(f_sim_nao(gm_2018, q_50_1, "2018")) %>%
  bind_rows(f_sim_nao(gm_2019, q51_1_1, "2019")) %>%
  #bind_rows(f_sim_nao(gm_2020, q72_1_1, "2020")) %>%
  bind_rows(f_sim_nao(gm_2021, q72_1_1, "2021")) %>%
  bind_rows(f_sim_nao(gm_2022, q72_1_1, "2022")) %>%



  #ano de 2020 não é possivel calcular por problemas na base de dados.

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

O (\Cref{fig:conc_estado}) mostra a linha histórica quanto a realização de concurso para trablhadores de nível superior do SUAS pelos entes estaduais. Por pelos menos 5 anos neste periodo, nenhum estado realizadou concurso para nível superior no SUAS. Este dado mostra os desafios da gestão do trabalho.

```{r conc_estado, fig.cap = "Percentual de estados que realizaram concursos para trabalhadores nível superior do SUAS - Brasil, 2013 a 2022", fig.footer = "Fonte: MDS, Censo SUAS"}

grafico <- f_sim_nao(ge_2013, q68a_1, "2013") %>%
    bind_rows(f_sim_nao(ge_2014, q22a_1, "2014")) %>%
    bind_rows(f_sim_nao(ge_2015, q15a_1, "2015")) %>%
    bind_rows(f_sim_nao(ge_2016, q11_1_1, "2016")) %>%
    bind_rows(f_sim_nao(ge_2017, q16_1_1, "2017")) %>%
    bind_rows(f_sim_nao(ge_2018, q_36_1_1, "2018")) %>%
    bind_rows(f_sim_nao(ge_2019, q36_1_1, "2019")) %>%
    bind_rows(f_sim_nao(ge_2020, q46_1_1, "2020")) %>%
    bind_rows(f_sim_nao(ge_2021, q46_1_1, "2021")) %>%
    bind_rows(f_sim_nao(ge_2022, q46_1_1, "2022")) %>%

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

# Participação Social e Controle Social no SUAS

A participação social é uma das diretrizes estabelecidas pela Constituição Federal de 1988 para a organização das ações da Assistência Social. Nesse sentido, a Lei Orgânica da Assistência Social (LOAS)\footnote{Lei nº 8.742, de 7 de dezembro de 1993: Dispõe sobre a organização da Assistência Social e dá outras providências. (\url{http://www.planalto.gov.br/ccivil_03/Leis/L8742compilado.htm})}, que corresponde sobre a sua organização, instituiu em seu artigo 16 os Conselhos de Assistência Social em âmbito nacional, estadual e municipal como instâncias de deliberação colegiada do SUAS, cuja composição deve ser paritária entre governo e sociedade civil.

Os Conselhos integram o Sistema Único de Assistência Social (SUAS), juntamente com o governo e as entidades e organizações de Assistência Social. A Resolução do Conselho Nacional de Assistência Social (CNAS) nº 100/2024\footnote{(\url{A Resolução CNAS nº 100, de 20 de abril de 2023 revoga a Resolução CNAS nº 237, de 14 de dezembro de 2006.})}, estabelece a definição dos Conselhos de Assistência Social, suas competências, criação, estrutura e organização. Esta resolução também trata do desempenho dos conselheiros e conelheiras, bem como sua função de interesse público.

Outra resolução importante para organização do controle social no SUAS é a resolução nº 99/2023\footnote{(\url{Resolução CNAS/MDS nº 99, DE 4 de abrilL de 2023})} na qual caracteriza os usuários, seus direitos e participação na Política de Assistência Social.

Este bloco apresenta os resultados apurados pelo Censo SUAS para os Conselhos Municipais e Estaduais de Assistência Social, considerando as dimensões estrutura administrativa, dinâmica de funcionamento e composição.

No que se refere aos dados do censo suas, o percentual de municípios que respondem ao formulário de Conselho Municipal de Assistência Social é acima de 95% no ano de 2022. É importante pontuar que as variações no período analisado através da \Cref{fig:qtd-cmas} não significa necessariamente redução no número de municípios com conselhos, este número pode representar o número de conselhos municipais que respondem ao Censo SUAS. Abaixo o gráfico tras informações da quantidade de conselhos municipais, por região, que responderam ao Censo SUAS.


```{r qtd-cmas, fig.cap = "Quantidade de Conselhos Municipais de Assistência Social que preencheram Censo SUAS"}

grafico <- f_quantitativo_regiao_ano (cmun_2012, Região, "2012") %>%
#  bind_rows(f_quantitativo_regiao_ano(cmun_2013, IBGE, "2013")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cmun_2014, IBGE, "2014")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cmun_2015, IBGE, "2015")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cmun_2016, IBGE, "2016")) %>%
  bind_rows(f_quantitativo_regiao_ano(cmun_2017, IBGE, "2017")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cmun_2018, IBGE, "2018")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cmun_2019, IBGE, "2019")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cmun_2020, IBGE, "2020")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cmun_2021, IBGE, "2021")) %>%
  bind_rows(f_quantitativo_regiao_ano(cmun_2022, IBGE, "2022")) %>%
  f_grafico_col_group_numero(Região, n, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Em relação aos Conselhos Estaduais de Assistência Social, a \Cref{fig:qtd-ceas} sinaliza que 100% dos conselhos responderam ao formulário do Censo SUAS.

```{r qtd-ceas, fig.cap = "Quantidade de Conselhos Estaduais de Assistência Social"}

grafico <- f_quantitativo_regiao_ano (cest_2012, IBGE, "2012") %>%
#  bind_rows(f_quantitativo_regiao_ano(cest_2022, IBGE, "2013")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cest_2022, IBGE, "2014")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cest_2022, IBGE, "2015")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cest_2022, IBGE, "2016")) %>%
  bind_rows(f_quantitativo_regiao_ano(cest_2022, IBGE, "2017")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cest_2022, IBGE, "2018")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cest_2022, IBGE, "2019")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cest_2022, IBGE, "2020")) %>%
#  bind_rows(f_quantitativo_regiao_ano(cest_2022, IBGE, "2021")) %>%
  bind_rows(f_quantitativo_regiao_ano(cest_2022, IBGE, "2022")) %>%
  f_grafico_col_group_numero(Região, n, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

A existência de sede para o funcionamento dos conselhos é essencial, pois além de garantir identidade na perspetiva de espaço na qual a população pode acessar, também assegura o trabalho da/o secretária/o executiva/o e demais profissionais. Dispor de locais de arquivos e documentos, reuniões entre outros. No que se refere aos Conselhos Municipais de Assistencia Social a \Cref{fig:cmas_sede} destaca que 58,1% dos conselhos muncipais que responderam censo suas informam possuir sede para o funcionamento. Destaca-se que nos últimos 10 anos, teve aumento de 45,1% para 58,1 de municípios que possuem sede para conseLho de assistencia social, dado que representa aumento de 13% percentuais.

```{r cmas_sede, fig.cap = "Percentual de Conselhos Municipais que possuem local/sede específico para funcionamento"}

grafico <- f_sim_nao(cmun_2012, q8, "2012") %>%
   #bind_rows(f_sim_nao(cmun_2013, q8, "2013")) %>%
   bind_rows(f_sim_nao(cmun_2014, q9, "2014")) %>%
   bind_rows(f_sim_nao(cmun_2015, q9, "2015")) %>%
   bind_rows(f_sim_nao(cmun_2016, q6, "2016")) %>%
   bind_rows(f_sim_nao(cmun_2017, q7, "2017")) %>%
   bind_rows(f_sim_nao(cmun_2018, q_6, "2018")) %>%
   bind_rows(f_sim_nao(cmun_2019, q6, "2019")) %>%
   bind_rows(f_sim_nao(cmun_2020, q6, "2020")) %>%
   bind_rows(f_sim_nao(cmun_2021, q6, "2021")) %>%
   bind_rows(f_sim_nao(cmun_2022, q6, "2022")) %>%


  #2013 a base não ler, acho que é porque no banco as informações esão "sim" / "não"
  #2019 ta com problema técnico no carregamento que não consigo ajeitar

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

Em relação aos Conselhos Estaduais, atualmente 100% informam possuir sede específica para funcionamento do controle social no SUAS conforme pode ser observado na \Cref{fig:ceas_sede}.

```{r ceas_sede, fig.cap = "Percentual de Conselhos estaduais que possuem local/sede especcífico para funcionamento"}

grafico <- f_sim_nao(cest_2012, q8, "2012") %>%
    #bind_rows(f_sim_nao(cest_2013, q8, "2013")) %>%
    bind_rows(f_sim_nao(cest_2014, q9, "2014")) %>%
    bind_rows(f_sim_nao(cest_2015, q8, "2015")) %>%
    bind_rows(f_sim_nao(cest_2016, q6, "2016")) %>%
    bind_rows(f_sim_nao(cest_2017, q7, "2017")) %>%
    bind_rows(f_sim_nao(cest_2018, q_6, "2018")) %>%
    bind_rows(f_sim_nao(cest_2019, q6, "2019")) %>%
    bind_rows(f_sim_nao(cest_2020, q6, "2020")) %>%
    bind_rows(f_sim_nao(cest_2021, q6, "2021")) %>%
   bind_rows(f_sim_nao(cest_2022, q6, "2022")) %>%

  #2013 AS QUESTÕES ESTÃO com aspas nas respostas "SIM";

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

As secretarias executivas dos Conselhos de Assistência Social é profissional de apoio direto ao funcionamento dos conselhos com o objetivo de fornecer suporte e assessoria técnica no cumprimento das suas competências. No que se refere a presença exclusiva destes profissionais nos conselhos municipais a \Cref{fig:cmas_se} sinaliza uma redução a partir de 2017. O último censo destaca 19,2% dos conselhos municipais possuem este profissional de forma exclusiva. Destaca-se que de acordo com resolução 100/2023 para os municípios de Pequeno portes I e II este profissional não precisa ser exclusivo.

```{r cmas_se, fig.cap = "Percentual de Conselhos Municipais que possuem secretárias/os executivos exclusivamente no Conselho"}

cmas_se  = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == "Sim"~"Sim",
                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("Sim",
                                            "Não"))) %>%
    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n))
}

#grafico <- cmas_se(cmun_2012, q13, "2012") %>%
  #bind_rows(cmas_se(cmun_2013, q13, "2013")) %>%
  #bind_rows(cmas_se(cmun_2014, q19, "2014")) %>%
  #bind_rows(cmas_se(cmun_2015, q19, "2015")) %>%
  #bind_rows(cmas_se(cmun_2016, q14, "2016")) %>%
  #bind_rows(cmas_sede(cmun_2017, q14, "2017")) %>%
  #bind_rows(cmas_se(cmun_2018, q_13, "2018")) %>%
  #bind_rows(cmas_se(cmun_, q13, "2019")) %>%
  #bind_rows(cmas_se(cmun_2020, q13, "2020")) %>%
  #bind_rows(cmas_se(cmun_2021, q13, "2021")) %>%
  #bind_rows(cmas_se(cmun_2022, q13, "2022")) %>%
# =======
 grafico <- f_sim_nao(cmun_2014, q19, "2014") %>%
    #bind_rows(f_sim_nao(cmun_2012, q13, "2012")) %>%
    #bind_rows(f_sim_nao(cmun_2013, q13, "2013")) %>%
    #bind_rows(f_sim_nao(cmun_2014, q19, "2014")) %>%
    bind_rows(f_sim_nao(cmun_2015, q19, "2015")) %>%
    bind_rows(f_sim_nao(cmun_2016, q14, "2016")) %>%
    bind_rows(f_sim_nao(cmun_2017, q14, "2017")) %>%
    bind_rows(f_sim_nao(cmun_2018, q_13, "2018")) %>%
   #bind_rows(f_sim_nao(cmun_, q13, "2019")) %>%
    bind_rows(f_sim_nao(cmun_2020, q13, "2020")) %>%
    bind_rows(f_sim_nao(cmun_2021, q13, "2021")) %>%
    bind_rows(f_sim_nao(cmun_2022, q13, "2022")) %>%

  #achei que as respostas 2012 desviaram um pouco, não consegui baixar a base ... em contato com Dionara.

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```
Em relação aos conselhos estaduais, a partir de 2017 identifica-se uma redução da presença destes profissionais.


```{r ceas_se, fig.cap = "Percentual de Conselhos Estaduais que possuem secretárias/os executivas/os exclusivamente no Conselho"}

grafico <- f_sim_nao(cest_2012, q13, "2012") %>%
   #bind_rows(f_sim_nao(cest_2013, q19, "2013")) %>%
   bind_rows(f_sim_nao(cest_2014, q19, "2014")) %>%
   bind_rows(f_sim_nao(cest_2015, q19, "2015")) %>%
   bind_rows(f_sim_nao(cest_2016, q13, "2016")) %>%
   bind_rows(f_sim_nao(cest_2017, q13, "2017")) %>%
   #bind_rows(f_sim_nao(cest_2018, q13, "2018")) %>%
   bind_rows(f_sim_nao(cest_2019, q13, "2019")) %>%
   bind_rows(f_sim_nao(cest_2020, q13, "2020")) %>%
   bind_rows(f_sim_nao(cest_2021, q13, "2021")) %>%
   bind_rows(f_sim_nao(cest_2022, q13, "2022")) %>%

  #2013 as variaveis estão "" ver como ajeitar para leitura
  #2012, 2017 é perguntado apenas se existe SE, não pergunta de forma exclusiva então retirei
  #2015 pergunta é igual das demais, SE exclusiva

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r qtdcmas_reuniao, fig.cap = "Proporção de Conselhos Municipais quanto a quantidade de realização de reuniões plenárias do Conselho (ordinárias e extraordinárias)"}

grafico <- cmun_2022 %>%
#-------------------
# Questionários 2022:
  select(x=q25) %>%
#-------------------
# Censo 2022:
  mutate(x = case_when(x <= 5~"Até 5",
                       x <= 8~"Entre 6 e 8",
                       x <= 12~"Entre 9 e 12",
                       x > 12~"Acima de 12",
                       TRUE ~ as.character(x))) %>%
  mutate(x = factor(x, levels = c("Até 5","Entre 6 e 8", "Entre 9 e 12", "Acima de 12"))) %>%
#-------------------
  group_by(x) %>%
  summarise(n=n()) %>%
  mutate(Percentual = n/sum(n)) %>%
  f_grafico_col_percent(x, Percentual)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```





```{r qtdceas_reuniao, fig.cap = "Proporção conselhos estaduais quanto a realização de reuniões plenárias no ano anterior"}


grafico <- cest_2022 %>%
#-------------------
# Questionários 2022:
  select(x=d25) %>%
#-------------------
# Censo 2022:
  mutate(x = case_when(x <= 8~"De 0 a 8 reuniões",
                       x <= 16~"De 9 a 16 reuniões",
                       x <= 20~"De 17 a 20 reuniões",
                       x <= 30~"De 21 a 30 reuniões",
                       x <= 40~"De 31 a 40 reuniões",
                       TRUE ~ as.character(x))) %>%
  mutate(x = factor(x, levels = c("De 0 a 8 reuniões","De 9 a 16 reuniões", "De 17 a 20 reuniões", "De 21 a 30 reuniões", "De 31 a 40 reuniões"))) %>%
#-------------------
  group_by(x) %>%
  summarise(n=n()) %>%
  mutate(Percentual = n/sum(n)) %>%

  f_grafico_col_percent(x, Percentual)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r qtd_reuniao, fig.cap = "xxx"}

cmun_2010_regiao <- cmun_2010 %>%
  select(Região) %>%
  mutate(Região = str_replace(Região, "Região ", "")) %>%
  group_by(Região) %>%
  summarise(n=n()) %>%
  ungroup() %>%
#  mutate(total_regiao=)
  bind_rows(c(Região="Brasil",summarise_all(select(.,-Região), 'sum')))

 cmun_2011_regiao <- cmun_2011 %>%
   select(Região) %>%
   mutate(Região = str_replace(Região, "Região ", "")) %>%
   group_by(Região) %>%
   summarise(n=n()) %>%
   ungroup() %>%
   bind_rows(c(Região="Brasil",summarise_all(select(.,-Região), 'sum')))

 cmun_2012_regiao <- cmun_2012 %>%
   select(Região) %>%
   mutate(Região = str_replace(Região, "Região ", "")) %>%
   group_by(Região) %>%
   summarise(n=n()) %>%
   ungroup() %>%
   bind_rows(c(Região="Brasil",summarise_all(select(.,-Região), 'sum')))

 cmun_2013_regiao <- cmun_2013 %>%
  select(Região) %>%
   mutate(Região = str_replace(Região, "Região ", "")) %>%
   group_by(Região) %>%
   summarise(n=n()) %>%
   ungroup() %>%
   bind_rows(c(Região="Brasil",summarise_all(select(.,-Região), 'sum')))

 cmun_2014_regiao <- cmun_2014 %>%
   select(Região) %>%
   mutate(Região = str_replace(Região, "Região ", "")) %>%
   group_by(Região) %>%
   summarise(n=n()) %>%
   ungroup() %>%
  bind_rows(c(Região="Brasil",summarise_all(select(.,-Região), 'sum')))

 cmun_2015_regiao <- cmun_2015 %>%
  select(Região) %>%
   mutate(Região = str_replace(Região, "Região ", "")) %>%
   group_by(Região) %>%
   summarise(n=n()) %>%
   ungroup() %>%
   bind_rows(c(Região="Brasil",summarise_all(select(.,-Região), 'sum')))

 cmun_2016_regiao <- cmun_2016 %>%
   select(Região) %>%
   mutate(Região = str_replace(Região, "Região ", "")) %>%
   group_by(Região) %>%
   summarise(n=n()) %>%
   ungroup() %>%
   bind_rows(c(Região="Brasil",summarise_all(select(.,-Região), 'sum')))

 cmun_2017_regiao <- cmun_2017 %>%
 select(Região) %>%
   mutate(Região = str_replace(Região, "Região ", "")) %>%
   group_by(Região) %>%
  summarise(n=n()) %>%
   ungroup() %>%
   bind_rows(c(Região="Brasil",summarise_all(select(.,-Região), 'sum')))

 cmun_regiao <- cmun_2010_regiao %>%
   left_join(cmun_2011_regiao, by = "Região") %>%
   left_join(cmun_2012_regiao, by = "Região") %>%
   left_join(cmun_2013_regiao, by = "Região") %>%
   left_join(cmun_2014_regiao, by = "Região") %>%
   left_join(cmun_2015_regiao, by = "Região") %>%
   left_join(cmun_2016_regiao, by = "Região") %>%
   left_join(cmun_2017_regiao, by = "Região")

  names(cmun_regiao) <- c("Região","2010","2011","2012","2013","2014","2015","2016","2017")


#  ggplot(aes(x = Região, y = Percentual, group = Ano)) +
#  geom_col(aes(fill = Ano), position="dodge") +
#  geom_text(aes(label = percent(Percentual), y=Percentual+.07), position = position_dodge(width = 0.9), angle = 90) +
#  scale_y_continuous(expand = expand_scale(mult = c(0, .1))) +
#  theme(legend.position="bottom",
#        legend.title = element_blank(),
#        axis.title = element_blank(),
#        axis.ticks = element_blank(),
#        axis.text.y = element_blank(),
#        axis.line.x = element_line(),
#        panel.background = element_blank(),
#        plot.background = element_rect(colour = "black")) +
#  guides(fill=guide_legend(nrow=1,byrow=TRUE))


```



```{r }

#cest_2010_regiao <- cest_2010 %>%
#  select(Região) %>%
#  mutate(Região = str_replace(Região, "Região ", "")) %>%
#  group_by(Região) %>%
#  summarise(n=n()) %>%
#  ungroup() %>%
#  bind_rows(c(Região="Brasil",summarise_all(select(.,-Região), 'sum')))

 cest_2011_regiao <- cest_2011 %>%
   select(Região) %>%
   mutate(Região = str_replace(Região, "Região ", "")) %>%
   group_by(Região) %>%
   summarise(n=n()) %>%
   ungroup() %>%
   bind_rows(c(Região="Brasil",summarise_all(select(.,-Região), 'sum')))

 cest_2012_regiao <- cest_2012 %>%
   select(Região) %>%
   mutate(Região = str_replace(Região, "Região ", "")) %>%
   group_by(Região) %>%
   summarise(n=n()) %>%
   ungroup() %>%
   bind_rows(c(Região="Brasil",summarise_all(select(.,-Região), 'sum')))

# cest_2013_regiao <- cest_2013 %>%
#  select(Região) %>%
#   mutate(Região = str_replace(Região, "Região ", "")) %>%
#   group_by(Região) %>%
#   summarise(n=n()) %>%
#   ungroup() %>%
#   bind_rows(c(Região="Brasil",summarise_all(select(.,-Região), 'sum')))

# cest_2014_regiao <- cest_2014 %>%
#   select(Região) %>%
#   mutate(Região = str_replace(Região, "Região ", "")) %>%
#   group_by(Região) %>%
#   summarise(n=n()) %>%
#   ungroup() %>%
#  bind_rows(c(Região="Brasil",summarise_all(select(.,-Região), 'sum')))

 cest_2015_regiao <- cest_2015 %>%
  select(Região) %>%
   mutate(Região = str_replace(Região, "Região ", "")) %>%
   group_by(Região) %>%
   summarise(n=n()) %>%
   ungroup() %>%
   bind_rows(c(Região="Brasil",summarise_all(select(.,-Região), 'sum')))

# cest_2016_regiao <- cest_2016 %>%
#   select(Região) %>%
#   mutate(Região = str_replace(Região, "Região ", "")) %>%
#   group_by(Região) %>%
#   summarise(n=n()) %>%
#   ungroup() %>%
#   bind_rows(c(Região="Brasil",summarise_all(select(.,-Região), 'sum')))

 cest_2017_regiao <- cest_2017 %>%
 select(Região) %>%
   mutate(Região = str_replace(Região, "Região ", "")) %>%
   group_by(Região) %>%
  summarise(n=n()) %>%
   ungroup() %>%
   bind_rows(c(Região="Brasil",summarise_all(select(.,-Região), 'sum')))

# cest_regiao <- cest_2010_regiao %>%
 cest_regiao <- cest_2011_regiao %>%
#   left_join(cest_2011_regiao, by = "Região") %>%
   left_join(cest_2012_regiao, by = "Região") %>%
#   left_join(cest_2013_regiao, by = "Região") %>%
#   left_join(cest_2014_regiao, by = "Região") %>%
   left_join(cest_2015_regiao, by = "Região") %>%
#   left_join(cest_2016_regiao, by = "Região") %>%
   left_join(cest_2017_regiao, by = "Região")

#  names(cest_regiao) <- c("Região","2010","2011","2012","2013","2014","2015","2016","2017")

```

```{r }

grafico <- f_sim_nao(cmun_2012, q7, "2012") %>%
   bind_rows(f_sim_nao(cmun_2013, q7, "2013")) %>%
   bind_rows(f_sim_nao(cmun_2014, q8, "2014")) %>%
   bind_rows(f_sim_nao(cmun_2015, q8, "2015")) %>%
   bind_rows(f_sim_nao(cmun_2016, q5, "2016")) %>%
   bind_rows(f_sim_nao(cmun_2017, q18, "2017")) %>%
   bind_rows(f_sim_nao(cmun_2018, q_17, "2018")) %>%
   bind_rows(f_sim_nao(cmun_2019, q17, "2019")) %>%
   bind_rows(f_sim_nao(cmun_2020, q20, "2020")) %>%
   bind_rows(f_sim_nao(cmun_2021, q20, "2021")) %>%
   bind_rows(f_sim_nao(cmun_2022, q20, "2022")) %>%

  #fazer a seleção das variaveis

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)

```


Sobre a proposta




```{r cmas-ppa, fig.cap = "Conselhos municipais que deliberaram sobre a proposta anual de orçamento do executivo"}

grafico <- f_sim_nao(cmun_2012, q38, "2012") %>%
  #bind_rows(f_sim_nao(cmun_2013, q, "2013")) %>%
  bind_rows(f_sim_nao(cmun_2014, q31, "2014")) %>%
  bind_rows(f_sim_nao(cmun_2015, q31, "2015")) %>%
  bind_rows(f_sim_nao(cmun_2016, q24, "2016")) %>%
  bind_rows(f_sim_nao(cmun_2017, q42, "2017")) %>%
  bind_rows(f_sim_nao(cmun_2018, q_37, "2018")) %>%
  #bind_rows(f_sim_nao(cmun_2019, q37, "2019")) %>%
  bind_rows(f_sim_nao(cmun_2020, q34, "2020")) %>%
  bind_rows(f_sim_nao(cmun_2021, q34, "2021")) %>%
  bind_rows(f_sim_nao(cmun_2022, q34, "2022")) %>%

  #2013 as variaveis estão "" ver como ajeitar para leitura

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r ceas_icspbf2, fig.cap = "Conselhos Estaduais de Assistência Social que são instancia de controle Social do PBF"}

grafico <- f_sim_nao(cest_2012, q39, "2012") %>%
   #bind_rows(f_sim_nao(cest_2013, q40, "2013")) %>%
   bind_rows(f_sim_nao(cest_2014, q41, "2014")) %>%
   bind_rows(f_sim_nao(cest_2015, q39, "2015")) %>%
   bind_rows(f_sim_nao(cest_2016, q32, "2016")) %>%
   bind_rows(f_sim_nao(cest_2017, q47, "2017")) %>%
   bind_rows(f_sim_nao(cest_2018, q_43, "2018")) %>%
   bind_rows(f_sim_nao(cest_2019, q39, "2019")) %>%
   bind_rows(f_sim_nao(cest_2020, q40, "2020")) %>%
   bind_rows(f_sim_nao(cest_2021, q40, "2021")) %>%
   bind_rows(f_sim_nao(cest_2022, q40, "2022")) %>%

  #2013 as variaveis estão "" ver como ajeitar para leitura

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```


Os conselhos estaduais sinalizam que 69,2% aprovam PPA

```{r ceas-ppa, fig.cap = "Conselhos estaduais que deliberaram sobre a proposta anual de orçamento do executivo"}

#falta colocar as variaveis dos questionários CEAS

grafico <- f_sim_nao(cest_2012, q29, "2012") %>%
   #bind_rows(f_sim_nao(cest_2013, q30, "2013")) %>%
   bind_rows(f_sim_nao(cest_2014, q31, "2014")) %>%
   bind_rows(f_sim_nao(cest_2015, q31, "2015")) %>%
   bind_rows(f_sim_nao(cest_2016, q24, "2016")) %>%
   bind_rows(f_sim_nao(cest_2017, q42, "2017")) %>%
   bind_rows(f_sim_nao(cest_2018, q_37, "2018")) %>%
   bind_rows(f_sim_nao(cest_2019, q33, "2019")) %>%
   bind_rows(f_sim_nao(cest_2020, q34, "2020")) %>%
   bind_rows(f_sim_nao(cest_2021, q34, "2021")) %>%
   bind_rows(f_sim_nao(cest_2022, q34, "2022")) %>%

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```



```{r cmas-be, fig.cap = "Percentual de CMAS que aprovou em Resolução os critérios e prazos para acesso aos Benefícios Eventuais"}

cmas_be  = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == "Sim"~"Sim",
                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("Sim",
                                            "Não"))) %>%
    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n))
}

grafico <- cmas_be(cmun_2012, q38, "2012") %>%
#   bind_rows(cmas_be(cmun_2013, q39, "2013")) %>%
   bind_rows(cmas_be(cmun_2014, q40, "2014")) %>%
   bind_rows(cmas_be(cmun_2015, q38, "2015")) %>%
   bind_rows(cmas_be(cmun_2016, q31, "2016")) %>%
   bind_rows(cmas_be(cmun_2017, q44, "2017")) %>%
   bind_rows(cmas_be(cmun_2018, q_39, "2018")) %>%
   bind_rows(cmas_be(cmun_2019, q35, "2019")) %>%
   bind_rows(cmas_be(cmun_2020, q36, "2020")) %>%
#   bind_rows(cmas_be(cmun_2021, q37, "2021")) %>%
   bind_rows(cmas_be(cmun_2022, q36, "2022")) %>%
# =======
# grafico <- f_sim_nao(cmun_2012, q38, "2012") %>%
#   #bind_rows(f_sim_nao(cmun_2013, q, "2013")) %>%
#   bind_rows(f_sim_nao(cmun_2014, q40, "2014")) %>%
#   bind_rows(f_sim_nao(cmun_2015, q38, "2015")) %>%
#   bind_rows(f_sim_nao(cmun_2016, q31, "2016")) %>%
#   bind_rows(f_sim_nao(cmun_2017, q44, "2017")) %>%
#   bind_rows(f_sim_nao(cmun_2018, q_39, "2018")) %>%
#   #bind_rows(f_sim_nao(cmun_2019, q37, "2019")) %>%
#   bind_rows(f_sim_nao(cmun_2020, q37, "2020")) %>%
#   bind_rows(f_sim_nao(cmun_2021, q37, "2021")) %>%
#   bind_rows(f_sim_nao(cmun_2022, q36, "2022")) %>%

  # a partir de 2020 a questão muda, mas o conteúdo da pergunta permanece, entretanto tenho dúvidas sobre o entendimento das respostas. Assim to pensando em manter apenas para os anos a partir de 2020.

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```


```{r ceas-be, fig.cap = "Percentual de CEAS que aprovou em Resolução os critérios e prazos para acesso aos Benefícios Eventuais"}

ceas_be  = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == "Sim"~"Sim",
                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("Sim",
                                            "Não"))) %>%
    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n))
}

grafico <- ceas_be(cest_2012, q38, "2012") %>%
   #bind_rows(ceas_be(cest_2013, q39, "2013")) %>%
   bind_rows(ceas_be(cest_2014, q40, "2014")) %>%
   bind_rows(ceas_be(cest_2015, q38, "2015")) %>%
  #bind_rows(ceas_be(cest_2016, q8, "2016")) %>%
   bind_rows(ceas_be(cest_2017, q44, "2017")) %>%
   bind_rows(ceas_be(cest_2018, q_39, "2018")) %>%
   bind_rows(ceas_be(cest_2019, q35, "2019")) %>%
   bind_rows(ceas_be(cest_2020, q36, "2020")) %>%
   bind_rows(ceas_be(cest_2021, q36, "2021")) %>%
   bind_rows(ceas_be(cest_2022, q36, "2022")) %>%


  #2013 estar "sim e "não" com aspas, por isso não ler
  #2016 muda pergunta, se o estado oferta e não aprovação
# =======
# grafico <- f_sim_nao(cest_2012, q38, "2012") %>%
#   #bind_rows(f_sim_nao(cest_2013, q8, "2013")) %>%
#   #bind_rows(f_sim_nao(cest_2014, q8, "2014")) %>%
#   #bind_rows(f_sim_nao(cest_2015, q8, "2015")) %>%
#   #bind_rows(f_sim_nao(cest_2016, q8, "2016")) %>%
#    bind_rows(f_sim_nao(cest_2017, q44, "2017")) %>%
#   #bind_rows(f_sim_nao(cest_2018, q8, "2018")) %>%
#   #bind_rows(f_sim_nao(cest_2019, "2019")) %>%
#   #bind_rows(f_sim_nao(cest_2020, q8, "2018")) %>%
#   #bind_rows(f_sim_nao(cest_2021, q8, "2018")) %>%
#    bind_rows(f_sim_nao(cest_2022, q36, "2022")) %>%

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```


```{r cmas_igd, fig.cap = "Percentual de CMAS quanto a destinação mínimo 3 perc dos IGD Bolsa e IGD SUAS"}

grafico <- f_sim_nao(cmun_2012, q7, "2012") %>%
   bind_rows(f_sim_nao(cmun_2013, q7, "2013")) %>%
   bind_rows(f_sim_nao(cmun_2014, q8, "2014")) %>%
   bind_rows(f_sim_nao(cmun_2015, q8, "2015")) %>%
   bind_rows(f_sim_nao(cmun_2016, q5, "2016")) %>%
   bind_rows(f_sim_nao(cmun_2017, q18, "2017")) %>%
   bind_rows(f_sim_nao(cmun_2018, q_17, "2018")) %>%
   bind_rows(f_sim_nao(cmun_2019, q17, "2019")) %>%
   bind_rows(f_sim_nao(cmun_2020, q20, "2020")) %>%
   bind_rows(f_sim_nao(cmun_2021, q20, "2021")) %>%
   bind_rows(f_sim_nao(cmun_2022, q20, "2022")) %>%

  #fazer a seleção das variaveis

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)


```

O Conselho é a Instância de Controle Social do Programa Bolsa Família (Resolução CNAS 18/2013 e Resolução CNAS 15/2014)


```{r ceas_igd, fig.cap = "Percentual de CEAS quanto a destinação mínimo 3 perc dos IGD Bolsa e IGD SUAS"}

grafico <- f_sim_nao(cest_2012, q7, "2012") %>%
#   bind_rows(f_sim_nao(cest_2013, q7, "2013")) %>%
   bind_rows(f_sim_nao(cest_2014, q8, "2014")) %>%
   bind_rows(f_sim_nao(cest_2015, q8, "2015")) %>%
   bind_rows(f_sim_nao(cest_2016, q5, "2016")) %>%
   bind_rows(f_sim_nao(cest_2017, q18, "2017")) %>%
   bind_rows(f_sim_nao(cest_2018, q_17, "2018")) %>%
   bind_rows(f_sim_nao(cest_2019, q17, "2019")) %>%
   bind_rows(f_sim_nao(cest_2020, q20, "2020")) %>%
   bind_rows(f_sim_nao(cest_2021, q20, "2021")) %>%
   bind_rows(f_sim_nao(cest_2022, q20, "2022")) %>%

  #2013 as variaveis estão "" ver como ajeitar para leitura

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)


```



```{r cmas_icspbf, fig.cap = "Conselhos Municipais de Assistência Social que são instancia de controle social do PBF", eval=FALSE}

grafico <- f_sim_nao(cmun_2012, q35_1, "2012") %>%
  bind_rows(f_sim_nao(cmun_2013, q40, "2013")) %>%
  bind_rows(f_sim_nao(cmun_2014, q41, "2014")) %>%
  bind_rows(f_sim_nao(cmun_2015, q39, "2015")) %>%
  bind_rows(f_sim_nao(cmun_2016, q32, "2016")) %>%
  bind_rows(f_sim_nao(cmun_2017, q47, "2017")) %>%
  bind_rows(f_sim_nao(cmun_2018, q_43, "2018")) %>%
  bind_rows(f_sim_nao(cmun_2019, q39, "2019")) %>%
  bind_rows(f_sim_nao(cmun_2020, q40, "2020")) %>%
  bind_rows(f_sim_nao(cmun_2021, q40, "2021")) %>%
  bind_rows(f_sim_nao(cmun_2022, q40, "2022")) %>%

  #2013 os dados da base estão "" por isso não consegue ler,
  #todos arquivo de 2019 esta bloqueado para leitura, algum erro que não consigo identificar.
  #2016 tem a opção 99, vou verificar o que representa.

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```



```{r ceas_icspbf1, fig.cap = "Percentual de Conselhos Estaduais de Assistência Social que são instancia de controle Social do PBF", eval=FALSE}

grafico <- f_sim_nao(cest_2012, q39, "2012") %>%
   #bind_rows(f_sim_nao(cest_2013, q40, "2013")) %>%
   bind_rows(f_sim_nao(cest_2014, q41, "2014")) %>%
   bind_rows(f_sim_nao(cest_2015, q39, "2015")) %>%
   bind_rows(f_sim_nao(cest_2016, q32, "2016")) %>%
   bind_rows(f_sim_nao(cest_2017, q47, "2017")) %>%
   bind_rows(f_sim_nao(cest_2018, q_43, "2018")) %>%
   bind_rows(f_sim_nao(cest_2019, q39, "2019")) %>%
   bind_rows(f_sim_nao(cest_2020, q40, "2020")) %>%
   bind_rows(f_sim_nao(cest_2021, q40, "2021")) %>%
   bind_rows(f_sim_nao(cest_2022, q40, "2022")) %>%

  #2013 as variaveis estão "" ver como ajeitar para leitura

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)


```














```{r }

```

```{r }

```

```{r }

```

```{r }

```






```{r usu_cmun, fig.cap = "Representantes de usuárias/os nos Conselhos Municipais de Assistência Social", fig.footer = "Fonte: MDS, Censo SUAS."}

 usu_cmun= function(df, q, ano, cod_categoria){
  q <- enquo(q)
  ano <- quo_name(ano)
  cod_categoria <- quo_name(cod_categoria)

#2020
  categoria <- case_when(!! cod_categoria == "1"~"Beneficiárias(os) do Programa Bolsa Família",
                         !! cod_categoria == "2"~"Beneficiária(o) ou família de beneficiárias(os) do BPC",
                         !! cod_categoria == "3"~"Usuária(o) de serviços socioassistenciais de Proteção Social Básica",
                         !! cod_categoria == "4"~"Usuária(o) de serviços socioassistenciais de Proteção Social Especial",
                         !! cod_categoria == "5"~"Representante de associação comunitária ou de moradores",
                         !! cod_categoria == "6"~"Representante de fórum ou coletivo de usuárias(os)",
                         !! cod_categoria == "7"~"Outros")


  df %>%
    select(!! q) %>%
    filter(!is.na(!! q)) %>%
    group_by(!! q) %>%
    summarise(n=n()) %>%
    mutate(Percentual = n/sum(n)) %>%
    filter(!! q == "Sim") %>%
    mutate("Categoria" = categoria, "Ano" = !! ano)
}

 tabela <-usu_cmun(cmun_2020,q78_1,"2020","1") %>%
  bind_rows(usu_cmun(cmun_2020,q78_2,"2020","2")) %>%
  bind_rows(usu_cmun(cmun_2020,q78_3,"2020","3")) %>%
  bind_rows(usu_cmun(cmun_2020,q78_4,"2020","4")) %>%
  bind_rows(usu_cmun(cmun_2020,q78_5,"2020","5")) %>%
  bind_rows(usu_cmun(cmun_2020,q78_6,"2020","6")) %>%
  bind_rows(usu_cmun(cmun_2020,q78_99,"2020","7")) %>%

  bind_rows(usu_cmun(cmun_2021,q78_1,"2021","1")) %>%
  bind_rows(usu_cmun(cmun_2021,q78_2,"2021","2")) %>%
  bind_rows(usu_cmun(cmun_2021,q78_3,"2021","3")) %>%
  bind_rows(usu_cmun(cmun_2021,q78_4,"2021","4")) %>%
  bind_rows(usu_cmun(cmun_2021,q78_5,"2021","5")) %>%
  bind_rows(usu_cmun(cmun_2021,q78_6,"2021","6")) %>%
  bind_rows(usu_cmun(cmun_2021,q78_99,"2021","7")) %>%

  # bind_rows(usu_cmun(cmun_2022,q78_1,"2022","1")) %>%
  # bind_rows(usu_cmun(cmun_2022,q78_2,"2022","2")) %>%
  # bind_rows(usu_cmun(cmun_2022,q78_3,"2022","3")) %>%
  # bind_rows(usu_cmun(cmun_2022,q78_4,"2022","4")) %>%
  # bind_rows(usu_cmun(cmun_2022,q78_99,"2022","5")) %>%
  # bind_rows(usu_cmun(cmun_2022,q78_0,"2022","6")) %>%
  # bind_rows(usu_cmun(cmun_2022,q78_99_1,"2022","7")) %>%

   #base de 2022 não estar completa no R e a da página da vigilancia estar númerica, aguardando trocar



  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=51))

ordenado<-tabela %>%
  filter(Ano == "2021") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  f_grafico_col_percent_flip(Categoria, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)

```


```{r usu_ceas, fig.cap = "Representantes de usuárias/os nos Conselhos Estadual de Assistência Social", fig.footer = "Fonte: MDS, Censo SUAS."}

usu_ceas= function(df, q, ano, cod_categoria){
  q <- enquo(q)
  ano <- quo_name(ano)
  cod_categoria <- quo_name(cod_categoria)

#2020
  categoria <- case_when(!! cod_categoria == "1"~"Beneficiárias(os) do Programa Bolsa Família",
                         !! cod_categoria == "2"~"Beneficiária(o) ou família de beneficiárias(os) do BPC",
                         !! cod_categoria == "3"~"Usuária(o) de serviços socioassistenciais de Proteção Social Básica",
                         !! cod_categoria == "4"~"Usuária(o) de serviços socioassistenciais de Proteção Social Especial",
                         !! cod_categoria == "5"~"Representante de associação comunitária ou de moradores",
                         !! cod_categoria == "6"~"Representante de fórum ou coletivo de usuárias(os)",
                         !! cod_categoria == "7"~"Outros")

  df %>%
    select(!! q) %>%
    filter(!is.na(!! q)) %>%
    group_by(!! q) %>%
    summarise(n=n()) %>%
    mutate(Percentual = n/sum(n)) %>%
    filter(!! q == "Sim") %>%
    mutate("Categoria" = categoria, "Ano" = !! ano)
}

 tabela <- usu_ceas(cest_2020,q78_1,"2020","1") %>%
  bind_rows(usu_ceas(cest_2020,q78_2,"2020","2")) %>%
  bind_rows(usu_ceas(cest_2020,q78_3,"2020","3")) %>%
  bind_rows(usu_ceas(cest_2020,q78_4,"2020","4")) %>%
  bind_rows(usu_ceas(cest_2020,q78_5,"2020","5")) %>%
  bind_rows(usu_ceas(cest_2020,q78_6,"2020","6")) %>%
  bind_rows(usu_ceas(cest_2020,q78_99,"2020","7")) %>%

  bind_rows(usu_ceas(cest_2021,q78_1,"2021","1")) %>%
  bind_rows(usu_ceas(cest_2021,q78_2,"2021","2")) %>%
  bind_rows(usu_ceas(cest_2021,q78_3,"2021","3")) %>%
  bind_rows(usu_ceas(cest_2021,q78_4,"2021","4")) %>%
  bind_rows(usu_ceas(cest_2021,q78_5,"2021","5")) %>%
  bind_rows(usu_ceas(cest_2021,q78_6,"2021","6")) %>%
  bind_rows(usu_ceas(cest_2021,q78_99,"2021","7")) %>%

  bind_rows(usu_ceas(cest_2022,q78_1,"2022","1")) %>%
  bind_rows(usu_ceas(cest_2022,q78_2,"2022","2")) %>%
  bind_rows(usu_ceas(cest_2022,q78_3,"2022","3")) %>%
  bind_rows(usu_ceas(cest_2022,q78_4,"2022","4")) %>%
  bind_rows(usu_ceas(cest_2022,q78_5,"2022","5")) %>%
  bind_rows(usu_ceas(cest_2022,q78_6,"2022","6")) %>%
  bind_rows(usu_ceas(cest_2022,q78_99,"2022","7")) %>%

  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=51))

ordenado<-tabela %>%
  filter(Ano == "2022") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  f_grafico_col_percent_flip(Categoria, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)

```

Representantes de trabalhadoras/es nos conselhos municipais

```{r trab_cmun, fig.cap = "Representantes de trabalhadoras/es nos Conselhos Municipais de Assistência Social", fig.footer = "Fonte: MDS, Censo SUAS."}

trab_cmun= function(df, q, ano, cod_categoria){
  q <- enquo(q)
  ano <- quo_name(ano)
  cod_categoria <- quo_name(cod_categoria)

#2020
  categoria <- case_when(!! cod_categoria == "1"~"Representante de sindicato de trabalhadoras(es)",
                         !! cod_categoria == "2"~"Representante de conselho de classe profissional (Conselho Regional de Serviço Social – CRESS",
                         !! cod_categoria == "3"~"Conselho Regional de Psicologia – CFP, outros conselhos de classe",
                         !! cod_categoria == "4"~"Representante de associação, fórum ou coletivo de trabalhadoras(es)",
                         !! cod_categoria == "5"~"A(O) própria(o) trabalhador(a) do SUAS, sem vinculação a nenhum coletivo",
                         !! cod_categoria == "6"~"Outros",
                         !! cod_categoria == "7"~"Este Conselho não possui representantes de trabalhadoras(es)")


  df %>%
    select(!! q) %>%
    filter(!is.na(!! q)) %>%
    group_by(!! q) %>%
    summarise(n=n()) %>%
    mutate(Percentual = n/sum(n)) %>%
    filter(!! q == "Sim") %>%
    mutate("Categoria" = categoria, "Ano" = !! ano)
}

 tabela <- trab_cmun(cmun_2020,q79_1,"2020","1") %>%
  bind_rows(trab_cmun(cmun_2020,q79_2,"2020","2")) %>%
  bind_rows(trab_cmun(cmun_2020,q79_3,"2020","3")) %>%
  bind_rows(trab_cmun(cmun_2020,q79_4,"2020","4")) %>%
  bind_rows(trab_cmun(cmun_2020,q79_99,"2020","5")) %>%
  bind_rows(trab_cmun(cmun_2020,q79_0,"2020","6")) %>%
  bind_rows(trab_cmun(cmun_2020,q79_99_1,"2020","7")) %>%

  bind_rows(trab_cmun(cmun_2021,q79_1,"2021","1")) %>%
  bind_rows(trab_cmun(cmun_2021,q79_2,"2021","2")) %>%
  bind_rows(trab_cmun(cmun_2021,q79_3,"2021","3")) %>%
  bind_rows(trab_cmun(cmun_2021,q79_4,"2021","4")) %>%
  bind_rows(trab_cmun(cmun_2021,q79_99,"2021","5")) %>%
  bind_rows(trab_cmun(cmun_2021,q79_0,"2021","6")) %>%
  bind_rows(trab_cmun(cmun_2021,q79_99_1,"2021","7")) %>%

  # bind_rows(trab_cmun(cmun_2022,q79_1,"2022","1")) %>%
  # bind_rows(trab_cmun(cmun_2022,q79_2,"2022","2")) %>%
  # bind_rows(trab_cmun(cmun_2022,q79_3,"2022","3")) %>%
  # bind_rows(trab_cmun(cmun_2022,q79_4,"2022","4")) %>%
  # bind_rows(trab_cmun(cmun_2022,q79_99,"2022","5")) %>%
  # bind_rows(trab_cmun(cmun_2022,q79_0,"2022","6")) %>%
  # bind_rows(trab_cmun(cmun_2022,q79_99_1,"2022","7")) %>%

   #base de 2022 não estar completa no R e a da página da vigilancia estar númerica, aguardando trocar



  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=51))

ordenado<-tabela %>%
  filter(Ano == "2021") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  f_grafico_col_percent_flip(Categoria, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)

```

Sobre representação de trabalhadoras/es nos conselhos estaduais ...

```{r trab_rep, fig.cap = "Representantes de trabalhadoras/es nos Conselhos Estadual de Assistência Social", fig.footer = "Fonte: MDS, Censo SUAS."}

trab_rep= function(df, q, ano, cod_categoria){
  q <- enquo(q)
  ano <- quo_name(ano)
  cod_categoria <- quo_name(cod_categoria)

#2020
  categoria <- case_when(!! cod_categoria == "1"~"Representante de sindicato de trabalhadoras(es)",
                         !! cod_categoria == "2"~"Representante de conselho de classe profissional (Conselho Regional de Serviço Social – CRESS",
                         !! cod_categoria == "3"~"Conselho Regional de Psicologia – CFP, outros conselhos de classe",
                         !! cod_categoria == "4"~"Representante de associação, fórum ou coletivo de trabalhadoras(es)",
                         !! cod_categoria == "5"~"A(O) própria(o) trabalhador(a) do SUAS, sem vinculação a nenhum coletivo",
                         !! cod_categoria == "6"~"Outros",
                         !! cod_categoria == "7"~"Este Conselho não possui representantes de trabalhadoras(es)")


  df %>%
    select(!! q) %>%
    filter(!is.na(!! q)) %>%
    group_by(!! q) %>%
    summarise(n=n()) %>%
    mutate(Percentual = n/sum(n)) %>%
    filter(!! q == "Sim") %>%
    mutate("Categoria" = categoria, "Ano" = !! ano)
}

 tabela <- trab_rep(cest_2020,q79_1,"2020","1") %>%
  bind_rows(trab_rep(cest_2020,q79_2,"2020","2")) %>%
  bind_rows(trab_rep(cest_2020,q79_3,"2020","3")) %>%
  bind_rows(trab_rep(cest_2020,q79_4,"2020","4")) %>%
  bind_rows(trab_rep(cest_2020,q79_99,"2020","5")) %>%
  bind_rows(trab_rep(cest_2020,q79_0,"2020","6")) %>%
  bind_rows(trab_rep(cest_2020,q79_99_1,"2020","7")) %>%

  bind_rows(trab_rep(cest_2021,q79_1,"2021","1")) %>%
  bind_rows(trab_rep(cest_2021,q79_2,"2021","2")) %>%
  bind_rows(trab_rep(cest_2021,q79_3,"2021","3")) %>%
  bind_rows(trab_rep(cest_2021,q79_4,"2021","4")) %>%
  bind_rows(trab_rep(cest_2021,q79_99,"2021","5")) %>%
  bind_rows(trab_rep(cest_2021,q79_0,"2021","6")) %>%
  bind_rows(trab_rep(cest_2021,q79_99_1,"2021","7")) %>%

  bind_rows(trab_rep(cest_2022,q79_1,"2022","1")) %>%
  bind_rows(trab_rep(cest_2022,q79_2,"2022","2")) %>%
  bind_rows(trab_rep(cest_2022,q79_3,"2022","3")) %>%
  bind_rows(trab_rep(cest_2022,q79_4,"2022","4")) %>%
  bind_rows(trab_rep(cest_2022,q79_99,"2022","5")) %>%
  bind_rows(trab_rep(cest_2022,q79_0,"2022","6")) %>%
  bind_rows(trab_rep(cest_2022,q79_99_1,"2022","7")) %>%





  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=51))

ordenado<-tabela %>%
  filter(Ano == "2022") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  f_grafico_col_percent_flip(Categoria, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)

```

```{r pub_cmas, fig.cap = "Percentual de conselhos municipais que publicam as resoluções em diário oficial", fig.footer = "Fonte: MDS, Censo SUAS", eval=FALSE}

pub_cmas  = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == " A minoria das deliberações/resoluções é publicada"~" A minoria das deliberações/resoluções é publicada",
                                        TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c("A minoria das deliberações/resoluções é publicada",
                                            "A maioria das deliberações/resoluções é publicada",
                                            "Nenhuma das deliberações/resoluções é publicada",
                                            "A metade das deliberações/resoluções é publicada",
                                            "Todas as deliberações/resoluções são publicadas"))) %>%

    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n))
}

grafico <- pub_cmas(cmun_2017, q36, "2017") %>%
#  bind_rows(pub_cmas(ge_2013, q1, "2013")) %>%
#  bind_rows(pub_cmas(ge_2014, q1, "2014")) %>%
#  bind_rows(pub_cmas(ge_2015, q1, "2015")) %>%
#  bind_rows(pub_cmas(ge_2016, q1, "2016")) %>%
#  bind_rows(pub_cmas(ge_2017, q36, "2017")) %>%
  bind_rows(pub_cmas(cmun_2018, q_29,"2018")) %>%
  bind_rows(pub_cmas(cmun_2019, q29, "2019")) %>%
  bind_rows(pub_cmas(cmun_2020, q27, "2020")) %>%
  bind_rows(pub_cmas(cmun_2021, q27, "2021")) %>%
  bind_rows(pub_cmas(cmun_2022, q27, "2022")) %>%


  # fazer para anos anteriores

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 3)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r }

#falta colocar as variaveis dos questionários CEAS

grafico <- f_sim_nao(cest_2012, q29, "2012") %>%
  #bind_rows(f_sim_nao(cest_2013, q, "2013")) %>%
  #bind_rows(f_sim_nao(cest_2014, q40, "2014")) %>%
  #bind_rows(f_sim_nao(cest_2015, q38, "2015")) %>%
  #bind_rows(f_sim_nao(cest_2016, q31, "2016")) %>%
  #bind_rows(f_sim_nao(cest_2017, q44, "2017")) %>%
  #bind_rows(f_sim_nao(cest_2018, q_39, "2018")) %>%
  #bind_rows(f_sim_nao(cest_2019, q37, "2019")) %>%
  #bind_rows(f_sim_nao(cest_2020, q37, "2020")) %>%
  #bind_rows(f_sim_nao(cest_2021, q37, "2021")) %>%
   bind_rows(f_sim_nao(cest_2022, q34, "2022")) %>%

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```


```{r cmun_usu, fig.cap = "Principais estratégias dos conselhos estaduais de comunicação com usuário", fig.footer = "Fonte: MDS, Censo SUAS.",eval=FALSE}

cmun_usu= function(df, q, ano, cod_categoria){
  q <- enquo(q)
  ano <- quo_name(ano)
  cod_categoria <- quo_name(cod_categoria)

#2020
  categoria <- case_when(!! cod_categoria == "1"~"Não há mecanismos de comunicação",
                         !! cod_categoria == "2"~"O Conselho disponibiliza contatos (e-mail/ telefone/whatsapp) para o público",
                         !! cod_categoria == "3"~"O Conselho tem página nas redes sociais (Facebook, blog etc)",
                         !! cod_categoria == "4"~"O Conselho tem canal de recebimento de denúncias",
                         !! cod_categoria == "5"~"O Conselho convida usuárias(os), além das(os) conselheiras(os), para a participação nas reuniões plenárias",
                         !! cod_categoria == "6"~"O Conselho divulga ações e temas discutidos pelo Conselho nos equipamentos da Assistência Social",
                         !! cod_categoria == "7"~"Outros")


  df %>%
    select(!! q) %>%
    filter(!is.na(!! q)) %>%
    group_by(!! q) %>%
    summarise(n=n()) %>%
    mutate(Percentual = n/sum(n)) %>%
    filter(!! q == "Sim") %>%
    mutate("Categoria" = categoria, "Ano" = !! ano)
}

 tabela <- cmun_usu(cmun_2022,q28_0,"2022","1") %>%
  # bind_rows(trab_rep(cest_2020,q79_2,"2020","2")) %>%
  # bind_rows(trab_rep(cest_2020,q79_3,"2020","3")) %>%
  # bind_rows(trab_rep(cest_2020,q79_4,"2020","4")) %>%
  # bind_rows(trab_rep(cest_2020,q79_99,"2020","5")) %>%
  # bind_rows(trab_rep(cest_2020,q79_0,"2020","6")) %>%
  # bind_rows(trab_rep(cest_2020,q79_99_1,"2020","7")) %>%

  # bind_rows(trab_rep(cest_2021,q79_1,"2021","1")) %>%
  # bind_rows(trab_rep(cest_2021,q79_2,"2021","2")) %>%
  # bind_rows(trab_rep(cest_2021,q79_3,"2021","3")) %>%
  # bind_rows(trab_rep(cest_2021,q79_4,"2021","4")) %>%
  # bind_rows(trab_rep(cest_2021,q79_99,"2021","5")) %>%
  # bind_rows(trab_rep(cest_2021,q79_0,"2021","6")) %>%
  # bind_rows(trab_rep(cest_2021,q79_99_1,"2021","7")) %>%

  #bind_rows(trab_rep(cest_2022,q28_0,"2022","1")) %>%
  bind_rows(cmun_usu(cmun_2022,q28_1,"2022","2")) %>%
  bind_rows(cmun_usu(cmun_2022,q28_2,"2022","3")) %>%
  bind_rows(cmun_usu(cmun_2022,q28_3,"2022","4")) %>%
  bind_rows(cmun_usu(cmun_2022,q28_4,"2022","5")) %>%
  bind_rows(cmun_usu(cmun_2022,q28_5,"2022","6")) %>%
  bind_rows(cmun_usu(cmun_2022,q28_99,"2022","7")) %>%


  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=51))

ordenado<-tabela %>%
  filter(Ano == "2022") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  f_grafico_col_percent_flip(Categoria, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)

```


```{r ceas_usu, fig.cap = "Principais estratégias dos conselhos estaduais de comunicação com usuário", fig.footer = "Fonte: MDS, Censo SUAS.", eval=FALSE}

ceas_usu= function(df, q, ano, cod_categoria){
  q <- enquo(q)
  ano <- quo_name(ano)
  cod_categoria <- quo_name(cod_categoria)

#2020
  categoria <- case_when(!! cod_categoria == "1"~"Não há mecanismos de comunicação",
                         !! cod_categoria == "2"~"O Conselho disponibiliza contatos (e-mail/ telefone/whatsapp) para o público",
                         !! cod_categoria == "3"~"O Conselho tem página nas redes sociais (Facebook, blog etc)",
                         !! cod_categoria == "4"~"O Conselho tem canal de recebimento de denúncias",
                         !! cod_categoria == "5"~"O Conselho convida usuárias(os), além das(os) conselheiras(os), para a participação nas reuniões plenárias",
                         !! cod_categoria == "6"~"O Conselho divulga ações e temas discutidos pelo Conselho nos equipamentos da Assistência Social",
                         !! cod_categoria == "7"~"Outros")


  df %>%
    select(!! q) %>%
    filter(!is.na(!! q)) %>%
    group_by(!! q) %>%
    summarise(n=n()) %>%
    mutate(Percentual = n/sum(n)) %>%
    filter(!! q == "Sim") %>%
    mutate("Categoria" = categoria, "Ano" = !! ano)
}

 tabela <- ceas_usu(cest_2022,q28_0,"2022","1") %>%
  # bind_rows(trab_rep(cest_2020,q79_2,"2020","2")) %>%
  # bind_rows(trab_rep(cest_2020,q79_3,"2020","3")) %>%
  # bind_rows(trab_rep(cest_2020,q79_4,"2020","4")) %>%
  # bind_rows(trab_rep(cest_2020,q79_99,"2020","5")) %>%
  # bind_rows(trab_rep(cest_2020,q79_0,"2020","6")) %>%
  # bind_rows(trab_rep(cest_2020,q79_99_1,"2020","7")) %>%

  # bind_rows(trab_rep(cest_2021,q79_1,"2021","1")) %>%
  # bind_rows(trab_rep(cest_2021,q79_2,"2021","2")) %>%
  # bind_rows(trab_rep(cest_2021,q79_3,"2021","3")) %>%
  # bind_rows(trab_rep(cest_2021,q79_4,"2021","4")) %>%
  # bind_rows(trab_rep(cest_2021,q79_99,"2021","5")) %>%
  # bind_rows(trab_rep(cest_2021,q79_0,"2021","6")) %>%
  # bind_rows(trab_rep(cest_2021,q79_99_1,"2021","7")) %>%

  #bind_rows(trab_rep(cest_2022,q28_0,"2022","1")) %>%
  bind_rows(ceas_usu(cest_2022,q28_1,"2022","2")) %>%
  bind_rows(ceas_usu(cest_2022,q28_2,"2022","3")) %>%
  bind_rows(ceas_usu(cest_2022,q28_3,"2022","4")) %>%
  bind_rows(ceas_usu(cest_2022,q28_4,"2022","5")) %>%
  bind_rows(ceas_usu(cest_2022,q28_5,"2022","6")) %>%
  bind_rows(ceas_usu(cest_2022,q28_99,"2022","7")) %>%

  ungroup() %>%
  mutate(Categoria=str_wrap(Categoria,width=51))

ordenado<-tabela %>%
  filter(Ano == "2022") %>%
  arrange(Percentual) %>%
  pull(Categoria)

grafico<-tabela %>%
  mutate(Categoria = factor(Categoria, levels = ordenado)) %>%
  f_grafico_col_percent_flip(Categoria, Percentual, Ano, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)

```


```{r idcras, fig.cap = "Indicador de Desenvolvimento do CRAS"}

grafico <- f_grupo_media(idcras_2014, `IDCRAS 2014sintético`, "ID CRAS", "2014") %>%
  bind_rows(f_grupo_media(idcras_2014, `Dimensão Estrutura Física`, "Estrutura Física", "2014")) %>%
  bind_rows(f_grupo_media(idcras_2014, `Dimensão Recursos Humanos`, "Recursos Humanos", "2014")) %>%
  bind_rows(f_grupo_media(idcras_2014, `Dimensão Serviços & Benefícios`, "Serviços & Benefícios", "2014")) %>%

  bind_rows(f_grupo_media(idcras_2015, `IDCRAS 2015 sintético`, "ID CRAS", "2015")) %>%
  bind_rows(f_grupo_media(idcras_2015, `Dimensão Estrutura Física`, "Estrutura Física", "2015")) %>%
  bind_rows(f_grupo_media(idcras_2015, `Dimensão Recursos Humanos`, "Recursos Humanos", "2015")) %>%
  bind_rows(f_grupo_media(idcras_2015, `Dimensão Serviços & Benefícios`, "Serviços & Benefícios", "2015")) %>%

  bind_rows(f_grupo_media(idcras_2016, `IDCRAS 2016sintético`, "ID CRAS", "2016")) %>%
  bind_rows(f_grupo_media(idcras_2016, `Dimensão Estrutura Física`, "Estrutura Física", "2016")) %>%
  bind_rows(f_grupo_media(idcras_2016, `Dimensão Recursos Humanos`, "Recursos Humanos", "2016")) %>%
  bind_rows(f_grupo_media(idcras_2016, `Dimensão Serviços & Benefícios`, "Serviços & Benefícios", "2016")) %>%

  bind_rows(f_grupo_media(idcras_2017, IDCRAS, "ID CRAS", "2017")) %>%
  bind_rows(f_grupo_media(idcras_2017, `Estrutura Física`, "Estrutura Física", "2017")) %>%
  bind_rows(f_grupo_media(idcras_2017, `Recursos Humanos`, "Recursos Humanos", "2017")) %>%
  bind_rows(f_grupo_media(idcras_2017, `Serviços `, "Serviços & Benefícios", "2017")) %>%

  bind_rows(f_grupo_media(idcras_2018, IDCRAS, "ID CRAS", "2018")) %>%
  bind_rows(f_grupo_media(idcras_2018, `Estrutura Física`, "Estrutura Física", "2018")) %>%
  bind_rows(f_grupo_media(idcras_2018, `Recursos Humanos`, "Recursos Humanos", "2018")) %>%
  bind_rows(f_grupo_media(idcras_2018, `Serviços `, "Serviços & Benefícios", "2018")) %>%

  bind_rows(f_grupo_media(idcras_2019, IDCRAS, "ID CRAS", "2019")) %>%
  bind_rows(f_grupo_media(idcras_2019, `Estrutura Física`, "Estrutura Física", "2019")) %>%
  bind_rows(f_grupo_media(idcras_2019, `Recursos Humanos`, "Recursos Humanos", "2019")) %>%
  bind_rows(f_grupo_media(idcras_2019, `Serviços `, "Serviços & Benefícios", "2019")) %>%

  bind_rows(f_grupo_media(idcras_2020, IDCRAS, "ID CRAS", "2020")) %>%
  bind_rows(f_grupo_media(idcras_2020, `Estrutura Física`, "Estrutura Física", "2020")) %>%
  bind_rows(f_grupo_media(idcras_2020, `Recursos Humanos`, "Recursos Humanos", "2020")) %>%
  bind_rows(f_grupo_media(idcras_2020, `Serviços `, "Serviços & Benefícios", "2020")) %>%

  bind_rows(f_grupo_media(idcras_2021, IDCRAS, "ID CRAS", "2021")) %>%
  bind_rows(f_grupo_media(idcras_2021, `Estrutura Física`, "Estrutura Física", "2021")) %>%
  bind_rows(f_grupo_media(idcras_2021, `Recursos Humanos`, "Recursos Humanos", "2021")) %>%
  bind_rows(f_grupo_media(idcras_2021, `Serviços `, "Serviços & Benefícios", "2021")) %>%

  bind_rows(f_grupo_media(idcras_2022, IDCRAS, "ID CRAS", "2022")) %>%
  bind_rows(f_grupo_media(idcras_2022, `Estrutura Física`, "Estrutura Física", "2022")) %>%
  bind_rows(f_grupo_media(idcras_2022, `Recursos Humanos`, "Recursos Humanos", "2022")) %>%
  bind_rows(f_grupo_media(idcras_2022, `Serviços `, "Serviços & Benefícios", "2022")) %>%

  mutate(Grupo = factor(Grupo, levels = c("Estrutura Física",
                                          "Recursos Humanos",
                                          "Serviços & Benefícios",
                                          "ID CRAS"))) %>%

  f_grafico_col_group_numero(Eixo_X, m, Grupo, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r idcras_fis, fig.cap = "Indicador de Desenvolvimento do CREAS"}

grafico <- f_quantitativo_niveis(idcras_2022, `Estrutura Física`, "Estrutura Física", niveis_ID) %>%
  bind_rows(f_quantitativo_niveis(idcras_2022, `Recursos Humanos`, "Recursos Humanos", niveis_ID)) %>%
  bind_rows(f_quantitativo_niveis(idcras_2022, `Serviços `, "Serviços & Benefícios", niveis_ID)) %>%

  mutate(Eixo_X = factor(Eixo_X, levels = c("Estrutura Física",
                                            "Recursos Humanos",
                                            "Serviços & Benefícios"))) %>%
  f_grafico_col_group_numero(Eixo_X, n, Grupo, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r idcreas, fig.cap = "Indicador de Desenvolvimento do CREAS"}

grafico <- f_grupo_media(idcreas_2014, `IDCREAS sintético`, "ID CREAS", "2014") %>%
  bind_rows(f_grupo_media(idcreas_2014, `Dimensão Estrutura Física`, "Estrutura Física", "2014")) %>%
  bind_rows(f_grupo_media(idcreas_2014, `Dimensão Recursos Humanos`, "Recursos Humanos", "2014")) %>%
  bind_rows(f_grupo_media(idcreas_2014, `Dimensão Serviços`, "Serviços & Benefícios", "2014")) %>%

  bind_rows(f_grupo_media(idcreas_2015, `IDCREAS sintético`, "ID CREAS", "2015")) %>%
  bind_rows(f_grupo_media(idcreas_2015, `Dimensão Estrutura Física`, "Estrutura Física", "2015")) %>%
  bind_rows(f_grupo_media(idcreas_2015, `Dimensão Recursos Humanos`, "Recursos Humanos", "2015")) %>%
  bind_rows(f_grupo_media(idcreas_2015, `Dimensão Serviços`, "Serviços & Benefícios", "2015")) %>%

  bind_rows(f_grupo_media(idcreas_2016, `IDCREAS 2016`, "ID CREAS", "2016")) %>%
  bind_rows(f_grupo_media(idcreas_2016, `Dimensão Estrutura Física`, "Estrutura Física", "2016")) %>%
  bind_rows(f_grupo_media(idcreas_2016, `Dimensão Recursos Humanos`, "Recursos Humanos", "2016")) %>%
  bind_rows(f_grupo_media(idcreas_2016, `Dimensão Serviços`, "Serviços & Benefícios", "2016")) %>%

  bind_rows(f_grupo_media(idcreas_2017, IDCREAS, "ID CREAS", "2017")) %>%
  bind_rows(f_grupo_media(idcreas_2017, `Estrutura Física`, "Estrutura Física", "2017")) %>%
  bind_rows(f_grupo_media(idcreas_2017, `Recursos Humanos`, "Recursos Humanos", "2017")) %>%
  bind_rows(f_grupo_media(idcreas_2017, `Serviços `, "Serviços & Benefícios", "2017")) %>%

  bind_rows(f_grupo_media(idcreas_2018, ID_CREAS, "ID CREAS", "2018")) %>%
  bind_rows(f_grupo_media(idcreas_2018, EF, "Estrutura Física", "2018")) %>%
  bind_rows(f_grupo_media(idcreas_2018, `RH`, "Recursos Humanos", "2018")) %>%
  bind_rows(f_grupo_media(idcreas_2018, `SERV`, "Serviços & Benefícios", "2018")) %>%

  bind_rows(f_grupo_media(idcreas_2019, ID_CREAS, "ID CREAS", "2019")) %>%
  bind_rows(f_grupo_media(idcreas_2019, `EF`, "Estrutura Física", "2019")) %>%
  bind_rows(f_grupo_media(idcreas_2019, `RH`, "Recursos Humanos", "2019")) %>%
  bind_rows(f_grupo_media(idcreas_2019, `SERV`, "Serviços & Benefícios", "2019")) %>%

  bind_rows(f_grupo_media(idcreas_2020, ID_CREAS, "ID CREAS", "2020")) %>%
  bind_rows(f_grupo_media(idcreas_2020, `EF`, "Estrutura Física", "2020")) %>%
  bind_rows(f_grupo_media(idcreas_2020, `RH`, "Recursos Humanos", "2020")) %>%
  bind_rows(f_grupo_media(idcreas_2020, `SERV`, "Serviços & Benefícios", "2020")) %>%

  bind_rows(f_grupo_media(idcreas_2021, ID_CREAS, "ID CREAS", "2021")) %>%
  bind_rows(f_grupo_media(idcreas_2021, `EF`, "Estrutura Física", "2021")) %>%
  bind_rows(f_grupo_media(idcreas_2021, `RH`, "Recursos Humanos", "2021")) %>%
  bind_rows(f_grupo_media(idcreas_2021, `SERV`, "Serviços & Benefícios", "2021")) %>%

  bind_rows(f_grupo_media(idcreas_2022, idcreas, "ID CREAS", "2022")) %>%
  bind_rows(f_grupo_media(idcreas_2022, `Estrutura Física`, "Estrutura Física", "2022")) %>%
  bind_rows(f_grupo_media(idcreas_2022, `Recursos Humanos`, "Recursos Humanos", "2022")) %>%
  bind_rows(f_grupo_media(idcreas_2022, `Serviços `, "Serviços & Benefícios", "2022")) %>%

  mutate(Grupo = factor(Grupo, levels = c("Estrutura Física",
                                          "Recursos Humanos",
                                          "Serviços & Benefícios",
                                          "ID CREAS"))) %>%

  f_grafico_col_group_numero(Eixo_X, m, Grupo, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r idcreas_est, fig.cap = "Indicador de Desenvolvimento do CREAS"}


grafico <- f_quantitativo_niveis(idcreas_2022, `Estrutura Física`, "Estrutura Física", niveis_ID) %>%
  bind_rows(f_quantitativo_niveis(idcreas_2022, `Recursos Humanos`, "Recursos Humanos", niveis_ID)) %>%
  bind_rows(f_quantitativo_niveis(idcreas_2022, `Serviços `, "Serviços & Benefícios", niveis_ID)) %>%

  mutate(Eixo_X = factor(Eixo_X, levels = c("Estrutura Física",
                                            "Recursos Humanos",
                                            "Serviços & Benefícios"))) %>%

  f_grafico_col_group_numero(Eixo_X, n, Grupo, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r idconselho, fig.cap = "Indicador de Desenvolvimento dos Conselhos"}

grafico <- f_grupo_media(idconselho_2014, IDConselho, "ID Conselho", "2014") %>%
  bind_rows(f_grupo_media(idconselho_2014, `Estrutura Administrativa`, "Estrutura Administrativa", "2014")) %>%
  bind_rows(f_grupo_media(idconselho_2014, `Dinâmica de Funcionamento`, "Dinâmica de Funcionamento", "2014")) %>%
  bind_rows(f_grupo_media(idconselho_2014, `Composição do Conselho`, "Composição do Conselho", "2014")) %>%

  bind_rows(f_grupo_media(idconselho_2015, `IDConselho - 2015`, "ID Conselho", "2015")) %>%
  bind_rows(f_grupo_media(idconselho_2015, `Estrutura Administrativa`, "Estrutura Administrativa", "2015")) %>%
  bind_rows(f_grupo_media(idconselho_2015, `Dinâmica de Funcionamento`, "Dinâmica de Funcionamento", "2015")) %>%
  bind_rows(f_grupo_media(idconselho_2015, `Composição do Conselho`, "Composição do Conselho", "2015")) %>%

  bind_rows(f_grupo_media(idconselho_2016, IDConselho, "ID Conselho", "2016")) %>%
  bind_rows(f_grupo_media(idconselho_2016, `Estrutura Administrativa`, "Estrutura Administrativa", "2016")) %>%
  bind_rows(f_grupo_media(idconselho_2016, `Dinâmica de Funcionamento`, "Dinâmica de Funcionamento", "2016")) %>%
  bind_rows(f_grupo_media(idconselho_2016, `Composição do Conselho`, "Composição do Conselho", "2016")) %>%

  bind_rows(f_grupo_media(idconselho_2017, IDConselho, "ID Conselho", "2017")) %>%
  bind_rows(f_grupo_media(idconselho_2017, `Estrutura Administrativa`, "Estrutura Administrativa", "2017")) %>%
  bind_rows(f_grupo_media(idconselho_2017, `Dinâmica de Funcionamento`, "Dinâmica de Funcionamento", "2017")) %>%
  bind_rows(f_grupo_media(idconselho_2017, `Composição do Conselho`, "Composição do Conselho", "2017")) %>%

  bind_rows(f_grupo_media(idconselho_2018, IDConselho, "ID Conselho", "2018")) %>%
  bind_rows(f_grupo_media(idconselho_2018, `Estrutura Administrativa`, "Estrutura Administrativa", "2018")) %>%
  bind_rows(f_grupo_media(idconselho_2018, `Dinâmica de Funcionamento`, "Dinâmica de Funcionamento", "2018")) %>%
  bind_rows(f_grupo_media(idconselho_2018, `Composição do Conselho`, "Composição do Conselho", "2018")) %>%

  bind_rows(f_grupo_media(idconselho_2019, IDConselho, "ID Conselho", "2019")) %>%
  bind_rows(f_grupo_media(idconselho_2019, `Estrutura Administrativa`, "Estrutura Administrativa", "2019")) %>%
  bind_rows(f_grupo_media(idconselho_2019, `Dinâmica de Funcionamento`, "Dinâmica de Funcionamento", "2019")) %>%
  bind_rows(f_grupo_media(idconselho_2019, `Composição do Conselho`, "Composição do Conselho", "2019")) %>%

  bind_rows(f_grupo_media(idconselho_2020, IDConselho, "ID Conselho", "2020")) %>%
  bind_rows(f_grupo_media(idconselho_2020, `Estrutura Administrativa`, "Estrutura Administrativa", "2020")) %>%
  bind_rows(f_grupo_media(idconselho_2020, `Dinâmica de Funcionamento`, "Dinâmica de Funcionamento", "2020")) %>%
  bind_rows(f_grupo_media(idconselho_2020, `Composição do Conselho`, "Composição do Conselho", "2020")) %>%

  bind_rows(f_grupo_media(idconselho_2021, IDConselho, "ID Conselho", "2021")) %>%
  bind_rows(f_grupo_media(idconselho_2021, `Estrutura Administrativa`, "Estrutura Administrativa", "2021")) %>%
  bind_rows(f_grupo_media(idconselho_2021, `Dinâmica de Funcionamento`, "Dinâmica de Funcionamento", "2021")) %>%
  bind_rows(f_grupo_media(idconselho_2021, `Composição do Conselho`, "Composição do Conselho", "2021")) %>%

  bind_rows(f_grupo_media(idconselho_2022, IDConselho, "ID Conselho", "2022")) %>%
  bind_rows(f_grupo_media(idconselho_2022, `Estrutura Administrativa`, "Estrutura Administrativa", "2022")) %>%
  bind_rows(f_grupo_media(idconselho_2022, `Dinâmica de Funcionamento`, "Dinâmica de Funcionamento", "2022")) %>%
  bind_rows(f_grupo_media(idconselho_2022, `Composição do Conselho`, "Composição do Conselho", "2022")) %>%

  mutate(Grupo = factor(Grupo, levels = c("Estrutura Administrativa",
                                          "Dinâmica de Funcionamento",
                                          "Composição do Conselho",
                                          "ID Conselho"))) %>%

  f_grafico_col_group_numero(Eixo_X, m, Grupo, 2)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r idcon, fig.cap = "Indicador de Desenvolvimento do conselhos municpais por compsição"}

grafico <- f_quantitativo_niveis(idconselho_2022, `Estrutura Administrativa`, "Estrutura Administrativa", niveis_ID) %>%
  bind_rows(f_quantitativo_niveis(idconselho_2022, `Dinâmica de Funcionamento`, "Dinâmica de Funcionamento", niveis_ID)) %>%
  bind_rows(f_quantitativo_niveis(idconselho_2022, `Composição do Conselho`, "Composição do Conselho", niveis_ID)) %>%

  mutate(Eixo_X = factor(Eixo_X, levels = c("Estrutura Administrativa",
                                            "Dinâmica de Funcionamento",
                                            "Composição do Conselho"))) %>%
  f_grafico_col_group_numero(Eixo_X, n, Grupo, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```



```{r Id_per, fig.cap = "Indicador de Desenvolvimento do conselhos municpais por compsição, 2014 a 2022"}

idconselho  = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == 1~1,
                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c(1,
                                            2,
                                            3,
                                            4,
                                            5)))%>%
    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n))
}

grafico <- idconselho(idconselho_2014, `Estrutura Administrativa`, "2014") %>%
   bind_rows(idconselho(idconselho_2015, `Estrutura Administrativa`, "2015")) %>%
   bind_rows(idconselho(idconselho_2016, `Estrutura Administrativa`, "2016")) %>%
   bind_rows(idconselho(idconselho_2017, `Estrutura Administrativa`, "2017")) %>%
   bind_rows(idconselho(idconselho_2018, `Estrutura Administrativa`, "2018")) %>%
   #bind_rows(idconselho(idconselho_2019, `Estrutura Administrativa`, "2019")) %>%
   #bind_rows(idconselho(idconselho_2020, `Estrutura Administrativa`, "2020")) %>%
   #bind_rows(idconselho(idconselho_2021, `Estrutura Administrativa`, "2021")) %>%
    bind_rows(idconselho(idconselho_2022, `Estrutura Administrativa`, "2022")) %>%

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r id_fun, fig.cap = "Indicador de Desenvolvimento do conselhos municpais - Dinamiza da funcionamento"}

idconselho  = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == 1~1,
                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c(1,
                                            2,
                                            3,
                                            4,
                                            5)))%>%
    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n))
}

grafico <- idconselho(idconselho_2014, `Dinâmica de Funcionamento`, "2014") %>%
    bind_rows(idconselho(idconselho_2015, `Dinâmica de Funcionamento`, "2015")) %>%
    bind_rows(idconselho(idconselho_2016, `Dinâmica de Funcionamento`, "2016")) %>%
    bind_rows(idconselho(idconselho_2017, `Dinâmica de Funcionamento`, "2017")) %>%
    bind_rows(idconselho(idconselho_2018, `Dinâmica de Funcionamento`, "2018")) %>%
   #bind_rows(idconselho(idconselho_2019, `Dinâmica de Funcionamento`, "2019")) %>%
   #bind_rows(idconselho(idconselho_2020, `Dinâmica de Funcionamento`, "2020")) %>%
   #bind_rows(idconselho(idconselho_2021, `Dinâmica de Funcionamento`, "2021")) %>%
    bind_rows(idconselho(idconselho_2022, `Dinâmica de Funcionamento`, "2022")) %>%

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```

```{r idcom, fig.cap = "Indicador de Desenvolvimento do conselhos municpais composição"}

idconselho  = function(df, q, ano){
  q <- enquo(q)
  ano <- quo_name(ano)

  df %>%
    select(!! ano := !! q) %>%
    gather("Categoria","Nível") %>%
    mutate(Nível = case_when(Nível == 1~1,
                             TRUE ~ Nível)) %>%
    filter(!is.na(Nível)) %>%
    mutate(Nível = factor(Nível, levels = c(1,
                                            2,
                                            3,
                                            4,
                                            5)))%>%
    group_by(Categoria, Nível) %>%
    summarise(n=n()) %>%
    group_by(Categoria) %>%
    mutate(Percentual = n/sum(n))
}

grafico <- idconselho(idconselho_2014, `Composição do Conselho`, "2014") %>%
    bind_rows(idconselho(idconselho_2015, `Composição do Conselho`, "2015")) %>%
    bind_rows(idconselho(idconselho_2016, `Composição do Conselho`, "2016")) %>%
    bind_rows(idconselho(idconselho_2017, `Composição do Conselho`, "2017")) %>%
    bind_rows(idconselho(idconselho_2018, `Composição do Conselho`, "2018")) %>%
   #bind_rows(idconselho(idconselho_2019, `Composição do Conselho`, "2019")) %>%
   #bind_rows(idconselho(idconselho_2020, `Composição do Conselho`, "2020")) %>%
   #bind_rows(idconselho(idconselho_2021, `Composição do Conselho`, "2021")) %>%
    bind_rows(idconselho(idconselho_2022, `Composição do Conselho`, "2022")) %>%

  f_grafico_col_stack_percent(Categoria, Percentual, Nível, 1)

grafico

if(gera.graficos.office) grafico %>% graph2office(file="graficos", append = TRUE)
```
